<div class="overall-wrapper">

	<div class="theme">
		<input type="radio" class="theme" name="attr_theme" value="1" checked /> <!-- Red -->
		<input type="radio" class="theme" name="attr_theme" value="2" /> <!-- Orange -->
		<input type="radio" class="theme" name="attr_theme" value="3" /> <!-- Yellow -->
		<input type="radio" class="theme" name="attr_theme" value="4" /> <!-- Green -->
		<input type="radio" class="theme" name="attr_theme" value="5" /> <!-- Blue -->
		<input type="radio" class="theme" name="attr_theme" value="6" /> <!-- Purple -->
		<input type="radio" class="theme" name="attr_theme" value="7" /> <!-- Grey -->
		<input type="radio" class="theme" name="attr_theme" value="8" /> <!-- Dark -->
		<input type="radio" class="theme" name="attr_theme" value="9" /> <!-- Light -->

		<div class="header"><h3 class="center" style="color: white;">Character Sheet</h3>
			<div class="padt padb">
				<div class="row padb">
					<div class="col-9-12"></div>
					
					<h5 style="float: right;" class="col-1-24">
						<div>
							<input type="checkbox" name="attr_sheetoptions" class="ro-checkbox" /><span class="ro-label">y</span>
							<div class="ro-modal">
								<div class="border">
									<div class="ro-close-wrapper">
										<input type="checkbox" name="attr_sheetoptions" class="ro-close-checkbox" value="1" />
										<span class="ro-close-label"></span>
									</div>
									<div class="row ro-header padb">
										<div class="col-9-10">
											<div class="row padt padb"><h3 class="col-1 center border"><span>Sheet Options</span></h3></div>
											<div class="row center padb">
												<div class="col-1-5 padr"><h4 class="center border"><span>Sheet Version
													<input type="text" class="center" name="attr_version" value="1.8.10" readonly />
													<input type="hidden" name="attr_global_version" value="0.0.0" readonly />
												</span></h4></div>
												<div class="col-1-5 padr"><h4 class="center border"><span>Sheet Type
													<select class="border"><option value="Sheet">Character</option><!--<option value="NPC Sheet">NPC</option><option value="Thing Sheet">Thing</option><option value="GM Sheet">GM</option>--></select>
												</span></h4></div>
												<div class="col-1-5 padr"><h4 class="center border"><span name="attr_label_class">Pronoun
													<input type="text" class="center" name="attr_pronoun" value="their" />
												</span></h4></div>
												<div class="col-1-5 padr"><h4 class="center border"><span name="attr_label_class">Theme
													<select name="attr_theme"><option value="1">Red</option><option value="2">Orange</option><option value="3">Yellow</option><option value="4">Green</option><option value="5">Blue</option><option value="6">Purple</option><option value="7">Grey</option><option value="8">Dark</option><option value="9">Light</option></select>
												</span></h4></div>
												<div class="col-1-5"><h4 class="center border"><span name="attr_label_class">Debug
													<select name="attr_show_debug_messages"><option value="0">Off</option><option value="1">Information</option><option value="2">Events</option><option value="3">Performance</option></select>
												</span></h4></div>
											</div>
											<div>
												<div class="col-1-5"><h4 class="center border"><span>Game Genre
													<select name="attr_static_options_selection_gamegenre">
														<option value="0">Multi-Genre</option>
														<option value="1">Action Adventure</option>
														<option value="2">Animal Adventures</option>
														<option value="3">Classic Horror</option>
														<option value="4">Detective</option>
														<option value="5">Loony Cartoons</option>
														<option value="6">Romantic Comedy</option>
														<option value="7">Slice of Life</option>
														<option value="8">Spy Thriller</option>
														<option value="9">Supernatural Occult</option>
														<option value="10">Eco Fantasy</option>
														<option value="11">High Fantasy</option>
														<option value="12">Low Fantasy</option>
														<option value="13">Urban Fantasy</option>
														<option value="14">Cyberpunk/Realitypunk</option>
														<option value="15">Hard SF</option>
														<option value="16">Mecha Drama</option>
														<option value="17">Post- Apocalyptic</option>
														<option value="18">Soft SF</option>
														<option value="19">Space Opera</option>
														<option value="20">20th Century War</option>
														<option value="21">Age of Discovery</option>
														<option value="22">Age of Pirates</option>
														<option value="23">Age of Samurai</option>
														<option value="24">Ancient Mediterranean</option>
														<option value="25">Industrial Age</option>
														<option value="26">Middle Ages</option>
														<option value="27">Steampunk</option>
														<option value="28">Stone Age</option>
														<option value="29">Wild West</option>
													</select>
												</span></h4></div>
												<div class="col-1-5"><h4 class="center border"><span>Alt Deplete
													<select name="attr_static_rules_deplete_alt">
														<option value="0">False</option>
														<option value="1">True</option>
													</select>
												</span></h4></div>
											</div>
											<div class="row center padb padt">
												<button type="roll" name="roll_documentation" class="hyperlink" value="[Sheet Documentation](https://wiki.roll20.net/Big_Eyes_Small_Mouth)">
													Sheet Documentation
												</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</h5>
					
					<h5 style="float: right;" class="col-1-24">
						<div>
							<input type="checkbox" name="attr_templatemanagement" class="ro-checkbox" /><span class="template-label">o</span>
							<div class="ro-modal padl padr">
								<div class="border">
									<div class="ro-close-wrapper">
										<input type="checkbox" name="attr_templatemanagement" class="ro-close-checkbox" value="1" />
										<span class="ro-close-label"></span>
									</div>
									<div class="row padb">
										<h3 class="col-13-20 templates-title center border"><span>Size Template</span></h3>
									</div>
									<div class="row padb">
										<div class="col-1-3">
											<div class="flex-container-spacearound padb">
												<h4 class="flex-11-12 center border"><span>Size</span>
													<select name="attr_static_template_size_selection">
														<option value="point">Point</option>
														<option value="mote">Mote</option>
														<option value="speck">Speck</option>
														<option value="minute">Minute</option>
														<option value="wee">Wee</option>
														<option value="teeny">Teeny</option>
														<option value="fine">Fine</option>
														<option value="diminutive">Diminutive</option>
														<option value="tiny">Tiny</option>
														<option value="small">Small</option>
														<option value="medium">Medium</option>
														<option value="large">Large</option>
														<option value="huge">Huge</option>
														<option value="mammoth">Mammoth</option>
														<option value="gigantic">Gigantic</option>
														<option value="gargantuan">Gargantuan</option>
														<option value="colossal">Colossal</option>
														<option value="enormous">Enormous</option>
														<option value="monstrous">Monstrous</option>
														<option value="titanic">Titanic</option>
														<option value="monumental">Monumental</option>
													</select>
												</h4>
											</div>
											<div class="flex-container-spacearound padb">
												<h4 class="flex-1-4 center border">
													<span style="font-size: 99px;">&nbsp;</span>
												</h4>
												<h4 class="flex-1-4 center border"><span>Rank</span>
													<input type="number" class="center" name="attr_static_template_size_rank" value=0 readonly />
												</h4>
												<h4 class="flex-1-4 center border"><span>Cost</span>
													<input type="number" class="center" name="attr_static_template_size_cost" value=0 readonly />
												</h4>
											</div>
											<div class="flex-container-spacearound">
												<h4 class="flex-11-12 center border">
													<span style="font-size: 99px;">&nbsp;</span>
												</h4>
											</div>
										</div>
										<div class="col-1-3">
											<div class="flex-container-spacearound">
												<h4 class="flex-9-10 center border"><span>Description</span>
													<textarea name="attr_static_template_size_description"></textarea>
												</h4>
											</div>
<!--
											<div class="template-size">
												<div class="col-4-5 center">
													<h4 class="border center">
														<fieldset class="repeating_sizetemplate">
															<div class="row">
																<input type="radio" class="templateradio" name="attr_selection" value="0" checked />
																<div class="col-1-12"><input type="radio" name="attr_selection" value="1" /></div>
																<div class="col-11-12 padr tooltip"><input type="text" name="attr_label" value="" readonly /><span class="tooltip"><textarea class="tooltip" name="attr_description" value="" readonly ></textarea></span></div>
															</div>
														</fieldset>
														<input type="hidden" name="attr_static_template_size_selection" value="" />
														<input type="hidden" name="attr_static_template_size_name" value="Select" />
													</h4>
												</div>
											</div>
-->
										</div>
									</div>
								</div>
							</div>
						</div>
					</h5>
					
					<h5 style="float: right;" class="col-1-24">
						<div>
							<input type="checkbox" name="attr_cpmanagement" class="ro-checkbox" /><span class="ro-label">x</span>
							<div class="ro-modal">
								<div class="border">
									<div class="ro-close-wrapper">
										<input type="checkbox" name="attr_cpmanagement" class="ro-close-checkbox" value="1" />
										<span class="ro-close-label"></span>
									</div>
									<div class="ro-header padb">
										<div class="col-6-11">
											<div class="row padt padb"><h3 class="col-1 center border"><span>Character Point Management</span></h3></div>
											<div class="row center">
												<div class="col-1-4 padr"><h4 class="center border"><span name="attr_label_class">Base
													<input type="number" name="attr_basecp" value=0 />
												</span></h4></div>
												<div class="col-1-4 padr"><h4 class="center border"><span name="attr_label_class">Gained
													<input type="number" name="attr_gainedcp" value=0 />
												</span></h4></div>
												<div class="col-1-4 padr"><h4 class="center border"><span name="attr_label_class">Spent
													<input type="number" name="attr_cpspent" value="(@{static_template_size_cost}+@{stat_cost_body}+@{stat_cost_mind}+@{stat_cost_soul}+@{static_attrgroup_1_totalcost}+@{static_attrgroup_2_totalcost}+@{static_attrgroup_3_totalcost}+@{static_attrgroup_4_totalcost}+@{static_attrgroup_5_totalcost}+@{static_attrgroup_6_totalcost}+@{static_attrgroup_7_totalcost}+@{static_attrgroup_8_totalcost}+@{static_attrgroup_9_totalcost}+@{static_attrgroup_10_totalcost})" disabled />
												</span></h4></div>
												<div class="col-1-4"><h4 class="center border"><span name="attr_label_class">Remaining
													<input type="number" name="attr_cpremaining" value="@{basecp}+@{gainedcp}-@{cpspent}" disabled />
												</span></h4></div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</h5>

				</div>
				<div class="row padb">
					<div class="col-1-3 padl padr"><h4 class="center border"><span>Character Name
						<input type="text" class="center border" name="attr_charactername" placeholder="Character Name" value="" />
					</span></h4></div>
					<div class="col-1-6 padl"><h4 class="center border"><span name="attr_label_totalcp">Total CP
						<input type="text" class="center border" name="attr_totalcp" value="@{basecp}+@{gainedcp}" disabled />
					</span></h4></div>
					<div class="col-1-6 padl"><h4 class="center border"><span name="attr_label_race">Race
						<input type="text" class="center border" name="attr_race" placeholder="Human" value="" />
					</span></h4></div>
					<div class="col-1-6 padl"><h4 class="center border"><span name="attr_label_class">Class
						<input type="text" class="center border" name="attr_class" placeholder="None" value="" />
					</span></h4></div>
				</div>
				<div class="row padb">
					<div class="col-1-3 padl padr"><h4 class="center border"><span>Player Name
						<input type="text" class="center border" name="attr_playername" placeholder="Player Name" value="" />
					</span></h4></div>
					<div class="col-1-6 padl"><h4 class="center border"><span name="attr_label_size">Size
						<input type="text" class="center border" name="attr_static_template_size_name" value="Medium" readonly />
					</span></h4></div>
					<div class="col-1-6 padl"><h4 class="center border"><span name="attr_label_height">Height
						<input type="text" class="center border" name="attr_static_template_size_height" value="" />
					</span></h4></div>
					<div class="col-1-6 padl"><h4 class="center border"><span name="attr_label_mass">Mass
						<input type="text" class="center border" name="attr_static_template_size_mass" value="" />
					</span></h4></div>
				</div>
			</div>
		</div>
	
		<span class="spacer"></span>
		<div class="col-1-10"></div>
		<input type="radio" name="attr_tab" class="tab tab1" value="1" title="Stats" />
		<span class="tab tab1">Screen</span>
		<input type="radio" name="attr_tab" class="tab tab2" value="2" />
		<span class="tab tab2">Stats</span>
		<input type="radio" name="attr_tab" class="tab tab3" value="3" />
		<span class="tab tab3">Attributes</span>
		<input type="radio" name="attr_tab" class="tab tab4" value="4" />
		<span class="tab tab4">Skills</span>
		<input type="radio" name="attr_tab" class="tab tab5" value="5" />
		<span class="tab tab5">Trappings</span>
		<input type="radio" name="attr_tab" class="tab tab99" value="99" checked="checked" />
		<span class="tab tab99">Show All</span>
		<span class="spacer"></span>

		<div class="section-screen header"><h3 class="center" style="color: white;">Player Screen</h3>
			<div class="row padt">	
				<div class="col-1-3">
					<div class="row">
						<div class="col-5-6 padb"><span class="col-1 header border">Status</span></div>

						<div class="row padb">
							<div class="col-5-6">
								<h4 class="center border">
									<span>
										<div style="padding-top: 5px;" class="row">
											<input type="hidden" name="attr_wounds" value=0 />
											<div class="col-1 container">
												<input type="hidden" value=10 name="attr_health" class="hidden health" readonly />
												<div class="health"></div>
											</div>
										</div>
									</span>
									<div class="padb"></div>
									<span style="font-weight: normal;">
										<div class="flex-container-evenlyspace">
											<div class="flex-3-10">Strain<input type="number" class="border" name="attr_static_stat_total_wounds" value=0 /></div>
											<div class="flex-3-10">Max Potency<input type="number" class="border" name="attr_stat_total_health" value=0 readonly /></div>
											<div class="flex-3-10">Extra<input type="number" class="border" name="attr_static_stat_temp_health" value=0 /></div>
											<input type="hidden" name="attr_stat_adj_health" value=0 />
										</div>
									</span>
								</h4>
							</div>
						</div>

						<div class="row padb">
							<div class="col-5-6">
								<h4 class="center border">
									<span>
										<div class="row">
											<input type="hidden" name="attr_fatigue" value=0 />
											<div class="col-1 container">
												<input type="hidden" value=10 name="attr_energy" class="hidden energyspent" readonly />
												<div class="energyspent"></div>
											</div>
										</div>
									</span>
									<div class="padb"></div>
									<span style="font-weight: normal;">
										<div class="flex-container-evenlyspace">
											<div class="flex-3-10">Excitement<input type="number" class="border" name="attr_static_stat_total_fatigue" value=0 /></div>
											<div class="flex-3-10">Max Climax<input type="number" class="border" name="attr_stat_total_energy" value=0 readonly /></div>
											<div class="flex-3-10">Extra<input type="number" class="border" name="attr_static_stat_temp_energy" value=0 /></div>
											<input type="hidden" name="attr_stat_adj_energy" value=0 />
										</div>
									</span>
								</h4>
							</div>
						</div>

						<div class="row padb">
							<div class="col-5-6">
								<h4 class="center border">
									<span>
										<div class="row">
											<input type="hidden" name="attr_maddness" value=0 />
											<div class="col-1 container">
												<input type="hidden" value=10 name="attr_sanity" class="hidden sanity" readonly />
												<div class="sanity"></div>
											</div>
										</div>
									</span>
									<div class="padb"></div>
									<span style="font-weight: normal;">
										<div class="flex-container-spacearound">
											<div class="flex-9-20">Stress<input type="number" class="border" name="attr_static_stat_total_maddness" value=0 /></div>
											<div class="flex-9-20">Sanity<input type="number" class="border" name="attr_stat_total_sanity" value=0 readonly /></div>
											<input type="hidden" name="attr_stat_adj_sanity" value=0 />
										</div>
									</span>
								</h4>
							</div>
						</div>

						<div class="row padb">
							<div class="col-5-6">
								<h4 class="center border">
									<span>
										<div class="row">
											<input type="hidden" name="attr_shame" value=0 />
											<div class="col-1 container">
												<input type="hidden" value=10 name="attr_social" class="hidden social" readonly />
												<div class="social"></div>
											</div>
										</div>
									</span>
									<div class="padb"></div>
									<span style="font-weight: normal;">
										<div class="flex-container-spacearound">
											<div class="flex-9-20 padr">Shame<input type="number" class="border" name="attr_static_stat_total_shame" value=0 /></div>
											<div class="flex-9-20 padl">Society<input type="number" class="border" name="attr_stat_total_social" value=0 readonly /></div>
											<input type="hidden" name="attr_stat_adj_social" value=0 />
										</div>
									</span>
								</h4>
							</div>
						</div>						
					</div>
				</div>

				<div class="col-1-3 padr">
					<div class="row padb">
						<div class="col-1 padb"><span class="col-1 header border">Conditions</span></div>
						<div class="row padb">
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_bleedingstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_bleeding">
								<span name="attr_bleeding_label"></span>
								<input type="hidden" name="attr_bleeding_label" value="Bleeding" />
							</div>
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_fracturedstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_fractured">
								<span name="attr_fractured_label"></span>
								<input type="hidden" name="attr_fractured_label" value="Wounded" />
							</div>
						</div>
						<div class="row padb">
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_blindedstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_blinded">
								<span name="attr_blinded_label"></span>
								<input type="hidden" name="attr_blinded_label" value="Blinded" />
							</div>
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_incurablestate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_incurable">
								<span name="attr_incurable_label"></span>
								<input type="hidden" name="attr_incurable_label" value="Tangled" />
							</div>
						</div>
						<div class="row padb">
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_contagiousstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_contagious">
								<span name="attr_contagious_label"></span>
								<input type="hidden" name="attr_contagious_label" value="Exposed" />
							</div>
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_pronestate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_prone">
								<span name="attr_prone_label"></span>
								<input type="hidden" name="attr_prone_label" value="Prone" />
							</div>
						</div>
						<div class="row padb">
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_continuingstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_continuing">
								<span name="attr_continuing_label"></span>
								<input type="hidden" name="attr_continuing_label" value="Swooned" />
							</div>
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_stunnedstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_stunned">
								<span name="attr_stunned_label"></span>
								<input type="hidden" name="attr_stunned_label" value="Stunned" />
							</div>
						</div>
						<div class="row padb">
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_deadstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_dead">
								<span name="attr_dead_label"></span>
								<input type="hidden" name="attr_dead_label" value="Tipsy" />
							</div>
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_tangledstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_tangled">
								<span name="attr_tangled_label"></span>
								<input type="hidden" name="attr_tangled_label" value="Drunk" />
							</div>
						</div>
						<div class="row padb">
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_drainedstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_drained">
								<span name="attr_drained_label"></span>
								<input type="hidden" name="attr_drained_label" value="Aroused" />
							</div>
							<div class="col-1-2">
								<input type="checkbox" class="push-button" name="attr_unconsciousstate" value="1" />
								<button type="action" class="condition push-button" name="act_static_button_stat_unconscious">
								<span name="attr_unconscious_label"></span>
								<input type="hidden" name="attr_unconscious_label" value="Unconscious" />
							</div>
						</div>
					</div>
				</div>

				<div class="col-1-3 padr">
					<div class="row center padb">
						<div class="col-5-6"><span class="col-1 header border">Protection Layers</span></div>
					</div>
					<div class="row padb">
						<input type="hidden" class="protectionstate" name="attr_protection_forcefield_state" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_forcefield_source" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_forcefield_limiteddefense" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_forcefield_limitedcoverage" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_forcefield_limiteddamtype" value="" />
						<div class="col-5-6">
							<input type="checkbox" class="protectionstate" name="attr_protection_forcefield_state" value="1" />
							<h4 class="center border protection">
								<div class="col-12-17">
									<span class="protection" name="attr_protection_forcefield_name"></span>
									<input type="hidden" name="attr_protection_forcefield_name" value="Forcefield" />
								</div>
								<div class="col-1-4">
									<input type="text" class="protection" name="attr_protection_forcefield_ar" value="0" readonly />
								</div>
							</h4>
						</div>
					</div>
					
					<div class="row padb">
						<input type="hidden" class="protectionstate" name="attr_protection_shield_state" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_shield_source" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_shield_dcv" value="" />
						<div class="col-5-6">
							<input type="checkbox" class="protectionstate" name="attr_protection_shield_state" value="1" />
							<h4 class="center border protection">
								<div class="col-12-17">
									<span class="protection" name="attr_protection_shield_name"></span>
									<input type="hidden" name="attr_protection_shield_name" value="Shield" />
								</div>
								<div class="col-1-4">
									<input type="text" class="protection" name="attr_protection_shield_ar" value="0" readonly />
								</div>
							</h4>
						</div>
						
					</div>
					
					<div class="row padb">
						<input type="hidden" class="protectionstate" name="attr_protection_armor1_source" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_armor1_specialized" value="0" />
						<input type="hidden" class="protectionstate" name="attr_protection_armor1_gap" value="0" />
						<input type="hidden" class="protectionstate" name="attr_protection_armor1_damagetype" value="" />
						<div class="col-5-6">
							<input type="checkbox" class="protectionstate" name="attr_protection_armor1_state" value="1" />
							<h4 class="center border protection">
								<div class="col-12-17">
									<span class="protection" name="attr_protection_armor1_name"></span>
									<input type="hidden" name="attr_protection_armor1_name" value="Armor, Primary" />
								</div>
								<div class="col-1-4">
									<input type="text" class="protection" name="attr_protection_armor1_ar" value="0" readonly />
								</div>
							</h4>
						</div>
						
					</div>
					
					<div class="row padb">
						<input type="hidden" class="protectionstate" name="attr_protection_armor2_source" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_armor2_specialized" value="0" />
						<input type="hidden" class="protectionstate" name="attr_protection_armor2_gap" value="0" />
						<input type="hidden" class="protectionstate" name="attr_protection_armor2_damagetype" value="" />
						<div class="col-5-6">
							<input type="checkbox" class="protectionstate" name="attr_protection_armor2_state" value="1" />
							<h4 class="center border protection">
								<div class="col-12-17">
									<span class="protection" name="attr_protection_armor2_name"></span>
									<input type="hidden" name="attr_protection_armor2_name" value="Armor, Secondary" />
								</div>
								<div class="col-1-4">
									<input type="text" class="protection" name="attr_protection_armor2_ar" value="0" readonly />
								</div>
							</h4>
						</div>
						
					</div>
					
					<div class="row padb">
						<input type="hidden" class="protectionstate" name="attr_protection_armor3_source" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_armor3_specialized" value="0" />
						<input type="hidden" class="protectionstate" name="attr_protection_armor3_gap" value="0" />
						<input type="hidden" class="protectionstate" name="attr_protection_armor3_damagetype" value="" />
						<div class="col-5-6">
							<input type="checkbox" class="protectionstate" name="attr_protection_armor3_state" value="1" />
							<h4 class="center border protection">
								<div class="col-12-17">
									<span class="protection" name="attr_protection_armor3_name"></span>
									<input type="hidden" name="attr_protection_armor3_name" value="Armor, Tracheary" />
								</div>
								<div class="col-1-4">
									<input type="text" class="protection" name="attr_protection_armor3_ar" value="0" readonly />
								</div>
							</h4>
						</div>
						
					</div>
					
					<div class="row padb">
						<input type="hidden" class="protectionstate" name="attr_protection_mindshield_state" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_mindshield_source" value="" />
						<div class="col-5-6">
							<input type="checkbox" class="protectionstate" name="attr_protection_mindshield_state" value="1" />
							<h4 class="center border protection">
								<div class="col-12-17">
									<span class="protection" name="attr_protection_mindshield_name"></span>
									<input type="hidden" name="attr_protection_mindshield_name" value="Mind Shield" />
								</div>
								<div class="col-1-4">
									<input type="text" class="protection" name="attr_protection_mindshield_ar" value="0" readonly />
								</div>
							</h4>
						</div>
						
					</div>
					
					<div class="row padb">
						<input type="hidden" class="protectionstate" name="attr_protection_absorption1_state" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_absorption1_source" value="" />
						<div class="col-5-6">
							<input type="checkbox" class="protectionstate" name="attr_protection_absorption1_state" value="1" />
							<h4 class="center border protection">
								<div class="col-12-17">
									<span class="protection" name="attr_protection_absorption1_name"></span>
									<input type="hidden" name="attr_protection_absorption1_name" value="Absorption, Health" />
								</div>
								<div class="col-1-4">
									<input type="text" class="protection" name="attr_protection_absorption1_ar" value="0" readonly />
								</div>
							</h4>
						</div>
					</div>

					<div class="row padb">
						<input type="hidden" class="protectionstate" name="attr_protection_absorption2_state" value="" />
						<input type="hidden" class="protectionstate" name="attr_protection_absorption2_source" value="" />
						<div class="col-5-6">
							<input type="checkbox" class="protectionstate" name="attr_protection_absorption2_state" value="1" />
							<h4 class="center border protection">
								<div class="col-12-17">
									<span class="protection" name="attr_protection_absorption2_name"></span>
									<input type="hidden" name="attr_protection_absorption2_name" value="Absorption, Energy" />
								</div>
								<div class="col-1-4">
									<input type="text" class="protection" name="attr_protection_absorption2_ar" value="0" readonly />
								</div>
							</h4>
						</div>
					</div>
					<input type="hidden" class="protectionstate" name="attr_protection_conversion_ar" value=0 />
					<input type="hidden" class="protectionstate" name="attr_protection_conversion_escalate" value=0 />
				</div>
			</div>
			
			<div class="row padt padb"></div>
			
			<div class="row padt padb">
				<div class="col-1-2 padr">

					<div class="flex-container-evenlyspace padb">
						<div class="flex-9-10"><span class="col-1 border">Armed Weapon</span></div>
					</div>
					<div class="flex-container-evenlyspace padb">
						<div class="flex-9-10">
							<h4 class="center border">
								<span style="font-weight: normal;" name="attr_label_maneuver">Maneuver
									<div class="flex-container-evenlyspace">
										<div class='flex-1-8'></div>
										<div class="flex-7-10">
											<select class="border" name="attr_static_weapon_maneuver_name">
												<option value=""></option>
												<option disabled style="background:gray;font-weight:bold;color:white;">Offense</option>
													<option value="attack">Attack</option>
													<option value="bite">Bite</option>
													<option value="bypass armor">Bypass Armor</option>
													<option value="disarm">Disarm</option>
													<option value="grab">Grab</option>
													<option value="lock">Lock</option>
													<option value="pin">Pin</option>
													<option value="reduce armor">Reduce Armor</option>
													<option value="throw">Throw</option>
													<option value="vital spot">Vital Spot</option>
													<option value="weak point">Weak Point</option>
												<option disabled style="background:gray;font-weight:bold;color:white;">Defense</option>
													<option value="defend">Defend</option>
													<option value="defend other">Defend Other</option>
													<option value="does nothing">Do Nothing</option>
													<option value="escape">Escape</option>
											</select>
										</div>
										<div class="flex-1-24">
											<button type="roll" class="border d6button" name="roll_maneuver" value='@{maneuverroll}'>
												<input type='hidden' name='attr_maneuverroll' value='' />
											</button>
										</div>
									</div>
								</span>
							</h4>
						</div>
					</div>

					<div class='flex-container padb'>
						<div class='flex-grow'></div>
						<div class='flex-9-10'>
							<h4 class='border'>
								<div class='flex-container-evenlyspace'>
									<div class='flex-3-10 center'>
										<div>
											<input type="checkbox" class="block-switch" name="attr_enable_enemyattack" value="1" />
											<div class="block-a">
												<div class="padr padl">
													<span class='targeted-inactive pictos-custom'>[</span>
												</div>
											</div>
											<div class="block-b">
												<div>
													<input type="checkbox" class="block-switch" name="attr_static_button_targeted_attack" value="1" />
													<div class="block-a">
														<div class="padr padl">
															<button type="action" class="targeted" name="act_static_button_targeted_attack">
																<span class="targeted-attack-deactivated pictos-custom">[</span>
															</button>
														</div>
													</div>
													<div class="block-b">
														<div class="padr padl">
															<input type="hidden" class="targeted" name="attr_static_button_targeted_activatetheme" value="1" />
															<button type="action" class="targeted" name="act_static_button_targeted_attack">
																<span class="theme-red targeted-attack-active pictos-custom">[</span>
																<span class="theme-orange targeted-attack-active pictos-custom">[</span>
																<span class="theme-yellow targeted-attack-active pictos-custom">[</span>
																<span class="theme-green targeted-attack-active pictos-custom">[</span>
																<span class="theme-blue targeted-attack-active pictos-custom">[</span>
																<span class="theme-purple targeted-attack-active pictos-custom">[</span>
																<span class="theme-grey targeted-attack-active pictos-custom">[</span>
																<span class="theme-dark targeted-attack-active pictos-custom">[</span>
																<span class="theme-light targeted-attack-active pictos-custom">[</span>
															</button>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class='flex-3-10 center'>
										<div>
											<input type="checkbox" class="block-switch" name="attr_enable_enemydefense" value="1" />
											<div class="block-a">
												<div class="padr padl">
													<span class='targeted-inactive pictos-custom'>e</span>
												</div>
											</div>
											<div class="block-b">
												<div>
													<input type="checkbox" class="block-switch" name="attr_static_button_targeted_defense" value="1" />
													<div class="block-a">
														<div class="padr padl">
															<button type="action" class="targeted" name="act_static_button_targeted_defense">
																<span class="targeted-defense-deactivated pictos-custom">e</span>
															</button>
														</div>
													</div>
													<div class="block-b">
														<div class="padr padl">
															<input type="hidden" class="targeted" name="attr_static_button_targeted_activatetheme" value="1" />
															<button type="action" class="targeted" name="act_static_button_targeted_defense">
																<span class="theme-red targeted-defense-active pictos-custom">e</span>
																<span class="theme-orange targeted-defense-active pictos-custom">e</span>
																<span class="theme-yellow targeted-defense-active pictos-custom">e</span>
																<span class="theme-green targeted-defense-active pictos-custom">e</span>
																<span class="theme-blue targeted-defense-active pictos-custom">e</span>
																<span class="theme-purple targeted-defense-active pictos-custom">e</span>
																<span class="theme-grey targeted-defense-active pictos-custom">e</span>
																<span class="theme-dark targeted-defense-active pictos-custom">e</span>
																<span class="theme-light targeted-defense-active pictos-custom">e</span>
															</button>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class='flex-3-10 center'>
										<div>
											<input type="checkbox" class="block-switch" name="attr_enable_massivedamage" value="1" />
											<div class="block-a">
												<div class="padr padl">
													<span class='targeted-inactive pictos-custom'>t</span>
												</div>
											</div>
											<div class="block-b">
												<div>
													<input type="checkbox" class="block-switch" name="attr_static_button_targeted_damage" value="1" />
													<div class="block-a">
														<div class="padr padl">
															<button type="action" class="targeted" name="act_static_button_targeted_damage">
																<span class="targeted-damage-deactivated pictos-custom">t</span>
															</button>
														</div>
													</div>
													<div class="block-b">
														<div class="padr padl">
															<input type="hidden" class="targeted" name="attr_static_button_targeted_activatetheme" value="1" />
															<button type="action" class="targeted" name="act_static_button_targeted_damage">
																<span class="theme-red targeted-damage-active pictos-custom">t</span>
																<span class="theme-orange targeted-damage-active pictos-custom">t</span>
																<span class="theme-yellow targeted-damage-active pictos-custom">t</span>
																<span class="theme-green targeted-damage-active pictos-custom">t</span>
																<span class="theme-blue targeted-damage-active pictos-custom">t</span>
																<span class="theme-purple targeted-damage-active pictos-custom">t</span>
																<span class="theme-grey targeted-damage-active pictos-custom">t</span>
																<span class="theme-dark targeted-damage-active pictos-custom">t</span>
																<span class="theme-light targeted-damage-active pictos-custom">t</span>
															</button>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
									<div class='flex-3-10 center'>
										<div>
											<input type="checkbox" class="block-switch" name="attr_enable_rushattack" value="1" />
											<div class="block-a">
												<div class="padr padl">
													<span class='targeted-inactive pictos'>e</span>
												</div>
											</div>
											<div class="block-b">
												<div>
													<input type="checkbox" class="block-switch" name="attr_static_button_targeted_rushdamage" value="1" />
													<div class="block-a">
														<div class="padr padl">
															<button type="action" class="targeted" name="act_static_button_targeted_rushdamage">
																<span class="targeted-damage-deactivated pictos">e</span>
															</button>
														</div>
													</div>
													<div class="block-b">
														<div class="padr padl">
															<input type="hidden" class="targeted" name="attr_static_button_targeted_activatetheme" value="1" />
															<button type="action" class="targeted" name="act_static_button_targeted_rushdamage">
																<span class="theme-red targeted-damage-active pictos">e</span>
																<span class="theme-orange targeted-damage-active pictos">e</span>
																<span class="theme-yellow targeted-damage-active pictos">e</span>
																<span class="theme-green targeted-damage-active pictos">e</span>
																<span class="theme-blue targeted-damage-active pictos">e</span>
																<span class="theme-purple targeted-damage-active pictos">e</span>
																<span class="theme-grey targeted-damage-active pictos">e</span>
																<span class="theme-dark targeted-damage-active pictos">e</span>
																<span class="theme-light targeted-damage-active pictos">e</span>
															</button>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</h4>
						</div>
						<div class='flex-grow'></div>
					</div>
					<div class="flex-container-evenlyspace padb">
						<div class="flex-1-5 padl"><h4 class="center border"><span name="attr_label_actions">Actions
						<input type="text" class="center border" name="attr_actions" value="1" readonly /></span></h4></div>
						<div class="flex-1-5"><h4 class="center border"><span name="attr_label_defenses">Defenses
						<input type="text" class="center border" name="attr_defenses" value="0" readonly /></span></h4></div>
						<div class="flex-1-2 padr"><h4 class="center border"><span name="attr_label_actionturns">Actions by Initiative
						<input type="text" class="center border" name="attr_actionsbyinitiative" value="" readonly /></span></h4></div>
					</div>
					<div>
						<input type="checkbox" class="block-switch" name="attr_weapon_range" value="1" />
						<div class="block-a"></div>
						<div class="block-b">
							<div class="row">
								<div style="padding-left: 20px;" class="col-1 padr">
									<div class="flex-container-evenlyspace padb">
										<div class="flex-1 padr padb">
											<h4 class="center border">
												<span style="font-weight: normal;">
													<div class="flex-container-evenlyspace">
														<div class="flex-1">Range
															<div class="flex-container-evenlyspace">
																<div class="flex-9-20">
																	<select class="border center" name="attr_static_weapon_range_selection">
																		<option value=1>Effective</option>
																		<option value=2>Intermediate</option>
																		<option value=3>Remote</option>
																	</select>
																</div>
																<div class="flex-9-20">
																	<input type="text" class="border center" name="attr_weapon_range_distance" value="" readonly />
																</div>
															</div>
														</div>
													</div>
												</span>
											</h4>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div style="padding-left: 20px;" class="padr">
						<input type="checkbox" class="block-switch" name="attr_weapon_ammo_autofire" value="1" />
						<div class="block-a"></div>
						<div class="block-b">
							<div class="flex-container">
								<div class="flex-1-2">
									<input type="checkbox" class="block-switch" name="attr_weapon_ammo" value="1" />
									<div class="block-a">
										<div class="col-1 padb padr">
											<h4 class="center border">
												<span style="font-size: 99px;">&nbsp;</span>
											</h4>
										</div>
									</div>
									<div class="block-b">
										<div class="col-1 padb padr">
											<h4 class="center border">
												<span style="font-weight: normal;">
													<div class="flex-container-evenlyspace">
														<div class="flex-3-10 padr">Reloads<input type="number" class="border" name="attr_weapon_ammo_reloads" value=0 /></div>
														<div class="flex-3-10 padr">Capacity<input type="number" class="border" name="attr_weapon_ammo_capacity" value=0 /></div>
														<div class="flex-3-10"><button style='width: 20px; height: 25px;' type='action' name='act_static_button_ammo_reload'><span style="font-family: Pictos; font-size: large;">1</span></button></div>
													</div>
												</span>
											</h4>
										</div>
									</div>
								</div>
								<div class="flex-1-2">
									<input type="checkbox" class="block-switch" name="attr_weapon_autofire" value="1" />
									<div class="block-a">
										<div class="col-1 padb padr">
											<h4 class="center border">
												<span style="font-size: 99px;">&nbsp;</span>
											</h4>
										</div>
									</div>
									<div class="block-b">
										<div class="col-1 padb padr">
											<h4 class="center border">
												<span style="font-weight: normal;">&nbsp;&nbsp;&nbsp;Autofire&nbsp;Mode&nbsp;&nbsp;&nbsp;
													<select class="border" name="attr_static_weapon_autofire_selection">
														<option value=1>Single</option>
														<option value=3>Burst</option>
														<option value=6>Full Auto</option>
													</select>
												</span>
											</h4>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="flex-container-evenlyspace padb padt">
						<div class="flex-8-9"><span class="col-1 header border">Weapon Selection</span></div>
					</div>
					<div class="flex-container-evenlyspace padb">
						<div class="flex-8-9">
							<input type="checkbox" class="weapon" name="attr_mainhand_state" value="1" />
							<button type="action" class="border weapon" name="act_static_button_mainhand_armedstate">
								<span style="font-weight: normal;" name="attr_mainhand_label">Main Hand
									<div class="flex-container-spacearound padb">
										<div class="flex-1 border" style="background: white;"><span style="width: 90%;" name="attr_mainhand_name"></span></div>
										<input type="hidden" name="attr_mainhand_name" value="Unarmed" readonly />
										<input type="hidden" name="attr_mainhand_source" value="" readonly />
									</div>
								</span>
							</button>
						</div>
					</div>
					<div class="flex-container-evenlyspace padb">
						<div class="flex-8-9">
							<input type="checkbox" class="weapon" name="attr_offhand_state" value="1" />
							<button type="action" class="border weapon" name="act_static_button_offhand_armedstate">
								<span style="font-weight: normal;" name="attr_offhand_label">Off-Hand
									<div class="flex-container-spacearound padb">
										<div class="flex-1 border" style="background: white;"><span style="width: 90%;" name="attr_offhand_name"></span></div>
										<input type="hidden" name="attr_offhand_name" value="Unarmed" readonly />
										<input type="hidden" name="attr_offhand_source" value="" readonly />
									</div>
								</span>
							</button>
						</div>	
					</div>
					<fieldset class="repeating_extraarm">						
						<div class="row">
							<div class="col-8-9 theme">
								<input type="checkbox" class="weapon" name="attr_state" value="1" />
								<button type="action" class="border weapon" name="act_armedstate">
									<span>
										<span style="font-weight: normal; color: black;" name="attr_label"></span>
										<div class="row padb">
											<div class="col-1 border" style="background: white;">
												<span style="width: 90%; color: black;" name="attr_name"></span>
											</div>
											<input type="hidden" class="center" name="attr_name" value="Unarmed" readonly />
											<input type="hidden" name="attr_label" value="Extra Arm" />
											<input type="hidden" name="attr_type" value=1 />
											<input type="hidden" name="attr_source" value="" />
										</div>
									</span>
								</button>
							</div>	
						</div>
					</fieldset>	
				</div>

				<div class="col-1-2 padl">
					<div class="flex-container-evenlyspace padb">
						<div class="flex-9-10"><span class="col-1 border">Rolls</span></div>
					</div>

					<div class="flex-container-evenlyspace padb">
						<div class="flex-9-10">
							<h4 class='center border'><span name="attr_label_rolls">Roll
								<div class="flex-container-evenlyspace">
									<div class="flex-1-8"><input class="center border" type="text" name="attr_dynamic_roll_base" value="0" readonly /></div>
									<div class="flex-7-10"><select class="border" name="attr_static_roll_type_selection"><option value="1d10">1d10</option><option value="initiative">Initiative</option><option value="perception">Perception</option><option value="stat">Stat</option></select></div>
									<div class="flex-1-24"><button class="button d6button" type="roll" name="roll_dynamicrolls" value="@{dynamic_roll_value}"></button><input type="hidden" name="attr_dynamic_roll_value" value="&{template:besmDefault} {{rolls=1}} {{character_name=@{charactername}}} {{pronoun=@{pronoun}}}  {{onedten=1}} {{title=Roll 1d10}}  {{total=[[[[?{Roll is 1d10}]]+[[0]] ]]}} {{roll=$[[0]]}}" readonly /></div>
								</div>
							</span></h4>
						</div>
					</div>

					<input type="radio" name="attr_rolltab" class="rolltab rolltab1" value="1" readonly /><span></span>
					<input type="radio" name="attr_rolltab" class="rolltab rolltab2" value="2" readonly /><span></span>
					<input type="radio" name="attr_rolltab" class="rolltab rolltab3" value="3" readonly /><span></span>
					<input type="radio" name="attr_rolltab" class="rolltab rolltab4" value="4" readonly /><span></span>
					<input type="radio" name="attr_rolltab" class="rolltab rolltab5" value="5" readonly /><span></span>
					<input type="radio" name="attr_rolltab" class="rolltab rolltab6" value="6" readonly /><span></span>

					<div class="tab-content rolltab1"></div>
					
					<div class="tab-content rolltab2">
						<div class='flex-container padb'>
							<div class='flex-grow'></div>
							<div class='flex-9-10'>
								<h4 class='border'>
									<div class='flex-container-evenlyspace'>
										<div class='flex-3-10 center'>
											<div>
												<input type="checkbox" class="block-switch" name="attr_enable_enemyattack" value="1" />
												<div class="block-a">
													<div class="padr padl">
														<span class='targeted-inactive pictos-custom'>[</span>
													</div>
												</div>
												<div class="block-b">
													<div>
														<input type="checkbox" class="block-switch" name="attr_static_button_targeted_attack" value="1" />
														<div class="block-a">
															<div class="padr padl">
																<button type="action" class="targeted" name="act_static_button_targeted_attack">
																	<span class="targeted-attack-deactivated pictos-custom">[</span>
																</button>
															</div>
														</div>
														<div class="block-b">
															<div class="padr padl">
																<input type="hidden" class="targeted" name="attr_static_button_targeted_activatetheme" value="1" />
																<button type="action" class="targeted" name="act_static_button_targeted_attack">
																	<span class="theme-red targeted-attack-active pictos-custom">[</span>
																	<span class="theme-orange targeted-attack-active pictos-custom">[</span>
																	<span class="theme-yellow targeted-attack-active pictos-custom">[</span>
																	<span class="theme-green targeted-attack-active pictos-custom">[</span>
																	<span class="theme-blue targeted-attack-active pictos-custom">[</span>
																	<span class="theme-purple targeted-attack-active pictos-custom">[</span>
																	<span class="theme-grey targeted-attack-active pictos-custom">[</span>
																	<span class="theme-dark targeted-attack-active pictos-custom">[</span>
																	<span class="theme-light targeted-attack-active pictos-custom">[</span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</h4>
							</div>
							<div class='flex-grow'></div>
						</div>
					</div>

					<div class="tab-content rolltab3">
						<div class='flex-container padb'>
							<div class='flex-grow'></div>
							<div class='flex-9-10'>
								<h4 class='border'>
									<div class='flex-container-evenlyspace'>
										<div class='flex-3-10 center'>
											<div>
												<input type="checkbox" class="block-switch" name="attr_static_button_personal_defense" value="1" checked />
												<div class="block-a">
													<div class="padr padl">
														<button type="action" class="targeted" name="act_static_button_personal_defense">
															<span class="targeted-attack-deactivated pictos-three">b</span>
														</button>
													</div>
												</div>
												<div class="block-b">
													<div class="padr padl">
														<input type="hidden" class="targeted" name="attr_static_button_personal_activatetheme" value="1" />
														<button type="action" class="targeted" name="act_static_button_personal_defense">
															<span class="theme-red targeted-attack-active pictos-three">b</span>
															<span class="theme-orange targeted-attack-active pictos-three">b</span>
															<span class="theme-yellow targeted-attack-active pictos-three">b</span>
															<span class="theme-green targeted-attack-active pictos-three">b</span>
															<span class="theme-blue targeted-attack-active pictos-three">b</span>
															<span class="theme-purple targeted-attack-active pictos-three">b</span>
															<span class="theme-grey targeted-attack-active pictos-three">b</span>
															<span class="theme-dark targeted-attack-active pictos-three">b</span>
															<span class="theme-light targeted-attack-active pictos-three">b</span>
														</button>
													</div>
												</div>
											</div>
										</div>
										<div class='flex-3-10 center'>
											<div>
												<input type="checkbox" class="block-switch" name="attr_enable_enemydefense" value="1" />
												<div class="block-a">
													<div class="padr padl">
														<span class='targeted-inactive pictos-custom'>e</span>
													</div>
												</div>
												<div class="block-b">
													<div>
														<input type="checkbox" class="block-switch" name="attr_static_button_targeted_defense" value="1" />
														<div class="block-a">
															<div class="padr padl">
																<button type="action" class="targeted" name="act_static_button_targeted_defense">
																	<span class="targeted-defense-deactivated pictos-custom">e</span>
																</button>
															</div>
														</div>
														<div class="block-b">
															<div class="padr padl">
																<input type="hidden" class="targeted" name="attr_static_button_targeted_activatetheme" value="1" />
																<button type="action" class="targeted" name="act_static_button_targeted_defense">
																	<span class="theme-red targeted-defense-active pictos-custom">e</span>
																	<span class="theme-orange targeted-defense-active pictos-custom">e</span>
																	<span class="theme-yellow targeted-defense-active pictos-custom">e</span>
																	<span class="theme-green targeted-defense-active pictos-custom">e</span>
																	<span class="theme-blue targeted-defense-active pictos-custom">e</span>
																	<span class="theme-purple targeted-defense-active pictos-custom">e</span>
																	<span class="theme-grey targeted-defense-active pictos-custom">e</span>
																	<span class="theme-dark targeted-defense-active pictos-custom">e</span>
																	<span class="theme-light targeted-defense-active pictos-custom">e</span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
										<div class='flex-3-10 center'>
											<div>
												<input type="checkbox" class="block-switch" name="attr_static_button_movement_defense" value="1" />
												<div class="block-a">
													<div class="padr padl">
														<button type="action" class="targeted" name="act_static_button_movement_defense">
															<span class="targeted-damage-deactivated pictos">;</span>
														</button>
													</div>
												</div>
												<div class="block-b">
													<div class="padr padl">
														<input type="hidden" class="targeted" name="attr_static_button_movement_activatetheme" value="1" />
														<button type="action" class="targeted" name="act_static_button_movement_defense">
															<span class="theme-red targeted-damage-active pictos">;</span>
															<span class="theme-orange targeted-damage-active pictos">;</span>
															<span class="theme-yellow targeted-damage-active pictos">;</span>
															<span class="theme-green targeted-damage-active pictos">;</span>
															<span class="theme-blue targeted-damage-active pictos">;</span>
															<span class="theme-purple targeted-damage-active pictos">;</span>
															<span class="theme-grey targeted-damage-active pictos">;</span>
															<span class="theme-dark targeted-damage-active pictos">;</span>
															<span class="theme-light targeted-damage-active pictos">;</span>
														</button>
													</div>
												</div>
											</div>
										</div>
									</div>
								</h4>
							</div>
							<div class='flex-grow'></div>
						</div>
					</div>

					<div class="tab-content rolltab4"></div>

					<div class="tab-content rolltab5">
						<div class='flex-container padb'>
							<div class='flex-grow'></div>
							<div class='flex-9-10'>
								<h4 class='border'>
									<div class='flex-container-evenlyspace'>
										
										<div class='flex-1-12'>
											<div class='flex-1-24'>
												<div class='flex-container-spacearound'>
													
													<input type="radio" name="attr_enhancedsighttab" class="enhancedsighttab enhancedsighttab1"  value="0" readonly checked /><span></span>
													<input type="radio" name="attr_enhancedsighttab" class="enhancedsighttab enhancedsighttab2"  value="1" readonly /><span></span>
													<input type="radio" name="attr_enhancedsighttab" class="enhancedsighttab enhancedsighttab3"  value="2" readonly /><span></span>
													<input type="radio" name="attr_enhancedsighttab" class="enhancedsighttab enhancedsighttab4"  value="-1" readonly /><span></span>
													<input type="radio" name="attr_enhancedsighttab" class="enhancedsighttab enhancedsighttab5"  value="-2" readonly /><span></span>
													<input type="radio" name="attr_enhancedsighttab" class="enhancedsighttab enhancedsighttab6"  value="-3" readonly /><span></span>
													
													<div class='flex-1-24'>
														<div><span class='pictos'>E</span></div>
													</div>
													<div class='tab-content enhancedsighttab1 flex-1-24'>
														<div></div>
													</div>
													<div class='tab-content enhancedsighttab2 flex-1-24'>
														<div><span class='pictos'>&</span></div>
													</div>
													<div class='tab-content enhancedsighttab3 flex-1-24'>
														<div><span class='pictos'>+</span></div>
													</div>
													<div class='tab-content enhancedsighttab4 flex-1-24'>
														<div><span class='pictos'>_</span></div>
													</div>
													<div class='tab-content enhancedsighttab5 flex-1-24'>
														<div><span class='pictos'>-</span></div>
													</div>
													<div class='tab-content enhancedsighttab6 flex-1-24'>
														<div><span class='pictos'>*</span></div>
													</div>
												</div>
											</div>
										</div>

										<div class='flex-1-12'>
											<div class='flex-1-24'>
												<div class='flex-container-spacearound'>
													
													<input type="radio" name="attr_enhancedhearingtab" class="enhancedhearingtab enhancedhearingtab1"  value="0" readonly checked /><span></span>
													<input type="radio" name="attr_enhancedhearingtab" class="enhancedhearingtab enhancedhearingtab2"  value="1" readonly /><span></span>
													<input type="radio" name="attr_enhancedhearingtab" class="enhancedhearingtab enhancedhearingtab3"  value="2" readonly /><span></span>
													<input type="radio" name="attr_enhancedhearingtab" class="enhancedhearingtab enhancedhearingtab4"  value="-1" readonly /><span></span>
													<input type="radio" name="attr_enhancedhearingtab" class="enhancedhearingtab enhancedhearingtab5"  value="-2" readonly /><span></span>
													<input type="radio" name="attr_enhancedhearingtab" class="enhancedhearingtab enhancedhearingtab6"  value="-3" readonly /><span></span>
													
													<div class='flex-1-24'>
														<div><span class='pictos'>m</span></div>
													</div>
													<div class='tab-content enhancedhearingtab1 flex-1-24'>
														<div></div>
													</div>
													<div class='tab-content enhancedhearingtab2 flex-1-24'>
														<div><span class='pictos'>&</span></div>
													</div>
													<div class='tab-content enhancedhearingtab3 flex-1-24'>
														<div><span class='pictos'>+</span></div>
													</div>
													<div class='tab-content enhancedhearingtab4 flex-1-24'>
														<div><span class='pictos'>_</span></div>
													</div>
													<div class='tab-content enhancedhearingtab5 flex-1-24'>
														<div><span class='pictos'>-</span></div>
													</div>
													<div class='tab-content enhancedhearingtab6 flex-1-24'>
														<div><span class='pictos'>*</span></div>
													</div>
												</div>
											</div>
										</div>

										<div class='flex-1-12'>
											<div class='flex-1-24'>
												<div class='flex-container-spacearound'>
													
													<input type="radio" name="attr_enhancedtouchtab" class="enhancedtouchtab enhancedtouchtab1"  value="0" readonly checked /><span></span>
													<input type="radio" name="attr_enhancedtouchtab" class="enhancedtouchtab enhancedtouchtab2"  value="1" readonly /><span></span>
													<input type="radio" name="attr_enhancedtouchtab" class="enhancedtouchtab enhancedtouchtab3"  value="2" readonly /><span></span>
													<input type="radio" name="attr_enhancedtouchtab" class="enhancedtouchtab enhancedtouchtab4"  value="-1" readonly /><span></span>
													<input type="radio" name="attr_enhancedtouchtab" class="enhancedtouchtab enhancedtouchtab5"  value="-2" readonly /><span></span>
													<input type="radio" name="attr_enhancedtouchtab" class="enhancedtouchtab enhancedtouchtab6"  value="-3" readonly /><span></span>
													
													<div class='flex-1-24'>
														<div><span class='pictos'>Y</span></div>
													</div>
													<div class='tab-content enhancedtouchtab1 flex-1-24'>
														<div></div>
													</div>
													<div class='tab-content enhancedtouchtab2 flex-1-24'>
														<div><span class='pictos'>&</span></div>
													</div>
													<div class='tab-content enhancedtouchtab3 flex-1-24'>
														<div><span class='pictos'>+</span></div>
													</div>
													<div class='tab-content enhancedtouchtab4 flex-1-24'>
														<div><span class='pictos'>_</span></div>
													</div>
													<div class='tab-content enhancedtouchtab5 flex-1-24'>
														<div><span class='pictos'>-</span></div>
													</div>
													<div class='tab-content enhancedtouchtab6 flex-1-24'>
														<div><span class='pictos'>*</span></div>
													</div>
												</div>
											</div>
										</div>

										<div class='flex-1-12'>
											<div class='flex-1-24'>
												<div class='flex-container-spacearound'>
													
													<input type="radio" name="attr_enhancedsmelltab" class="enhancedsmelltab enhancedsmelltab1"  value="0" readonly checked /><span></span>
													<input type="radio" name="attr_enhancedsmelltab" class="enhancedsmelltab enhancedsmelltab2"  value="1" readonly /><span></span>
													<input type="radio" name="attr_enhancedsmelltab" class="enhancedsmelltab enhancedsmelltab3"  value="2" readonly /><span></span>
													<input type="radio" name="attr_enhancedsmelltab" class="enhancedsmelltab enhancedsmelltab4"  value="-1" readonly /><span></span>
													<input type="radio" name="attr_enhancedsmelltab" class="enhancedsmelltab enhancedsmelltab5"  value="-2" readonly /><span></span>
													<input type="radio" name="attr_enhancedsmelltab" class="enhancedsmelltab enhancedsmelltab6"  value="-3" readonly /><span></span>
													
													<div class='flex-1-24'>
														<div><span class='pictos-custom'>r</span></div>
													</div>
													<div class='tab-content enhancedsmelltab1 flex-1-24'>
														<div></div>
													</div>
													<div class='tab-content enhancedsmelltab2 flex-1-24'>
														<div><span class='pictos'>&</span></div>
													</div>
													<div class='tab-content enhancedsmelltab3 flex-1-24'>
														<div><span class='pictos'>+</span></div>
													</div>
													<div class='tab-content enhancedsmelltab4 flex-1-24'>
														<div><span class='pictos'>_</span></div>
													</div>
													<div class='tab-content enhancedsmelltab5 flex-1-24'>
														<div><span class='pictos'>-</span></div>
													</div>
													<div class='tab-content enhancedsmelltab6 flex-1-24'>
														<div><span class='pictos'>*</span></div>
													</div>
												</div>
											</div>
										</div>

										<div class='flex-1-12'>
											<div class='flex-1-24'>
												<div class='flex-container-spacearound'>
													
													<input type="radio" name="attr_enhancedtastetab" class="enhancedtastetab enhancedtastetab1"  value="0" readonly checked /><span></span>
													<input type="radio" name="attr_enhancedtastetab" class="enhancedtastetab enhancedtastetab2"  value="1" readonly /><span></span>
													<input type="radio" name="attr_enhancedtastetab" class="enhancedtastetab enhancedtastetab3"  value="2" readonly /><span></span>
													<input type="radio" name="attr_enhancedtastetab" class="enhancedtastetab enhancedtastetab4"  value="-1" readonly /><span></span>
													<input type="radio" name="attr_enhancedtastetab" class="enhancedtastetab enhancedtastetab5"  value="-2" readonly /><span></span>
													<input type="radio" name="attr_enhancedtastetab" class="enhancedtastetab enhancedtastetab6"  value="-3" readonly /><span></span>
													
													<div class='flex-1-24'>
														<div><span class='pictos-three'>c</span></div>
													</div>
													<div class='tab-content enhancedtastetab1 flex-1-24'>
														<div></div>
													</div>
													<div class='tab-content enhancedtastetab2 flex-1-24'>
														<div><span class='pictos'>&</span></div>
													</div>
													<div class='tab-content enhancedtastetab3 flex-1-24'>
														<div><span class='pictos'>+</span></div>
													</div>
													<div class='tab-content enhancedtastetab4 flex-1-24'>
														<div><span class='pictos'>_</span></div>
													</div>
													<div class='tab-content enhancedtastetab5 flex-1-24'>
														<div><span class='pictos'>-</span></div>
													</div>
													<div class='tab-content enhancedtastetab6 flex-1-24'>
														<div><span class='pictos'>*</span></div>
													</div>
												</div>
											</div>
										</div>
										
									</div>
								</h4>
							</div>
							<div class='flex-grow'></div>
						</div>

						<div class='flex-container-evenlyspace padb'>
							<div class='flex-9-10'>
								<fieldset class="repeating_senses">
									<h4 class="center border">
										<div class="flex-container-evenlyspace">
											<div class="flex-6-7">
												<span name="attr_name"></span>
												<input type="hidden" name="attr_name" value="Additional Sense" />
												<input type="text" class="center" name="attr_characteristic" value="Super Sense" readonly />
											</div>
										</div>
									</h4>
								</fieldset>
							</div>
						</div>
					</div>

					<div class="tab-content rolltab6">
						<div class="flex-container padb">
							<div class='flex-grow'></div>
							<div class='flex-9-10'>
								<h4 class='border'>
									<div class='flex-container-evenlyspace'>
										<div class='flex-4-10 center'>
											<select name="attr_static_stat_type_set" class="border"><option value="major">Major Aspects</option><option value="minor">Minor Aspects</option></select>
										</div>
									</div>
								</h4>
							</div>
							<div class='flex-grow'></div>
						</div>

						<div class="flex-container-evenlyspace padb">
							<div class="flex-9-10">
								<div>
									<input type="checkbox" class="block-switch" name="attr_majorstats" value="1" />
									<div class="block-a">
										<div class="flex-container-evenlyspace center padb">
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_bodystate" value="1" />
												<button type="action" class="allaspects-stat" name="act_static_button_stat_body" value="">Body
													<div class="flex-skillcontainer">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_body" value="0"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_mindstate" value="1" />
												<button type='action' class="allaspects-stat" name='act_static_button_stat_mind' value="">Looks
													<div class="flex-skillcontainer">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_mind" value="0"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_soulstate" value="1" />
												<button type='action' class="allaspects-stat" name='act_static_button_stat_soul' value="">Talk
													<div class="flex-skillcontainer">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_soul" value="0"></span>
														</div>
													</div>
												</button>
											</div>
										</div>										
									</div>
									<div class="block-b">
										<div class="flex-container-evenlyspace center padb">
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_bodystate" value="1" />
												<button type="action" class="allaspects-stat-inactive">Body
													<div class="flex-skillcontainer">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_body"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_mindstate" value="1" />
												<button type='action' class="allaspects-stat-inactive">Looks
													<div class="flex-skillcontainer">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_mind"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_soulstate" value="1" />
												<button type='action' class="allaspects-stat-inactive">Mind
													<div class="flex-skillcontainer">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_soul"></span>
														</div>
													</div>
												</button>
											</div>
										</div>										
									</div>
								</div>
									
								<div>
									<input type="checkbox" class="block-switch" name="attr_minorstats" value="1" />
									<div class="block-a"></div>
									<div class="block-b">
										<div class="flex-container-evenlyspace center padb">
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_agistate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_agi' value="">Agility
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_agi"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_crestate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_cre' value="">Creativity
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_cre"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_awastate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_awa' value="">Awareness
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_awa"></span>
														</div>
													</div>
												</button>
											</div>
										</div>
										<div class="flex-container-evenlyspace center padb">
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_constate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_con' value="">Constitution
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_con"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_intstate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_int' value="">Intellect
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_int"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_chastate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_cha' value="">Charisma
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_cha"></span>
														</div>
													</div>
												</button>
											</div>
										</div>
										<div class="flex-container-evenlyspace center padb">
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_dexstate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_dex' value="">Dexterity
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_dex"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_perstate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_per' value="">Perception
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_per"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_comstate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_com' value="">Composure
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_com"></span>
														</div>
													</div>
												</button>
											</div>
										</div>
										<div class="flex-container-evenlyspace center padb">
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_strstate" value="1" />
												<button type="action" class="major-stat" name="act_static_button_stat_str" value="">Strength
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_str"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_reastate" value="1" />
												<button type="action" class="major-stat" name="act_static_button_stat_rea" value="">Reasoning
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_rea"></span>
														</div>
													</div>
												</button>
											</div>
											<div class="flex-1-3">
												<input type="checkbox" class="stats" name="attr_wilstate" value="1" />
												<button type='action' class="major-stat" name='act_static_button_stat_wil' value="">Willpower
													<div class="flex-container">
														<div class="flex-1">
															<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_wil"></span>
														</div>
													</div>
												</button>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="flex-container-evenlyspace padt">
						<div class="flex-9-10">
							<div class="col-1"><span class="col-1 header border">Active Attributes</span></div>
						</div>
					</div>
					
			</div>
		</div>
		
		<div class="section-stats header"><h3 class="center" style="color: white;">Stats</h3>
			<div class="row padt">
				<div class='col-9-20'>
					<div class="flex-container-evenlyspace padb">
						<div class="flex-9-10">
							<div>
								<input type="checkbox" class="block-switch" name="attr_showallaspectsstats" value="1" />
								<div class="block-a">
									<div class="flex-container-evenlyspace center padb">
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_bodystate" value="1" />
											<button type="action" class="allaspects-stat">Body
												<div class="flex-skillcontainer">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_body"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_mindstate" value="1" />
											<button type='action' class="allaspects-stat">Looks
												<div class="flex-skillcontainer">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_mind"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_soulstate" value="1" />
											<button type='action' class="allaspects-stat">Talk
												<div class="flex-skillcontainer">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_soul"></span>
													</div>
												</div>
											</button>
										</div>
									</div>										
								</div>
								<div class="block-b">
									<div class="flex-container-evenlyspace center padb">
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_bodystate" value="1" />
											<button type="action" class="allaspects-stat-inactive">Body
												<div class="flex-skillcontainer">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_body"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_mindstate" value="1" />
											<button type='action' class="allaspects-stat-inactive">Looks
												<div class="flex-skillcontainer">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_mind"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_soulstate" value="1" />
											<button type='action' class="allaspects-stat-inactive">Talk
												<div class="flex-skillcontainer">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_soul"></span>
													</div>
												</div>
											</button>
										</div>
									</div>										
								</div>
							</div>
								
							<div>
								<input type="checkbox" class="block-switch" name="attr_showmajoraspectstats" value="1" />
								<div class="block-a"></div>
								<div class="block-b">
									<div class="flex-container-evenlyspace center padb">
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_agistate" value="1" />
											<button type='action' class="major-stat">Agility
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_agi"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_crestate" value="1" />
											<button type='action' class="major-stat">Creativity
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_cre"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_awastate" value="1" />
											<button type='action' class="major-stat">Awareness
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_awa"></span>
													</div>
												</div>
											</button>
										</div>
									</div>
									<div class="flex-container-evenlyspace center padb">
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_constate" value="1" />
											<button type='action' class="major-stat">Constitution
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_con"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_intstate" value="1" />
											<button type='action' class="major-stat">Intellect
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_int"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_chastate" value="1" />
											<button type='action' class="major-stat">Charisma
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_cha"></span>
													</div>
												</div>
											</button>
										</div>
									</div>
									<div class="flex-container-evenlyspace center padb">
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_dexstate" value="1" />
											<button type='action' class="major-stat">Dexterity
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_dex"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_perstate" value="1" />
											<button type='action' class="major-stat">Perception
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_per"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_comstate" value="1" />
											<button type='action' class="major-stat">Composure
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_com"></span>
													</div>
												</div>
											</button>
										</div>
									</div>
									<div class="flex-container-evenlyspace center padb">
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_strstate" value="1" />
											<button type="action" class="major-stat">Strength
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_str"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_reastate" value="1" />
											<button type="action" class="major-stat">Reasoning
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_rea"></span>
													</div>
												</div>
											</button>
										</div>
										<div class="flex-1-3">
											<input type="checkbox" class="stats" name="attr_wilstate" value="1" />
											<button type='action' class="major-stat">Willpower
												<div class="flex-container">
													<div class="flex-1">
														<div class="border" style="background: white;"><span style="color: black;" class="center" name="attr_stat_total_wil"></span>
													</div>
												</div>
											</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-1-2">
					<div class="flex-container-evenlyspace padb">
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_walk">Walk
									<input type="text" class="center border" name="attr_stat_total_walk" value="0" readonly />
								</span>
							</h4>
						</div>
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_jumpup">Jump Up
									<input type="text" class="center border" name="attr_stat_total_jumpup" value="0" readonly />
								</span>
							</h4>
						</div>
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_swim">Swim
									<input type="text" class="center border" name="attr_stat_total_swim" value="0" readonly />
								</span>
							</h4>
						</div>
					</div>
					<div class="flex-container-evenlyspace padb">
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_jog">Jog
									<input type="text" class="center border" name="attr_stat_total_jog" value="0" readonly />
								</span>
							</h4>
						</div>
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_Jump">Jump
									<input type="text" class="center border" name="attr_stat_total_jump" value="0" readonly />
								</span>
							</h4>
						</div>
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_sswim">Sprint Swim
									<input type="text" class="center border" name="attr_stat_total_sswim" value="0" readonly />
								</span>
							</h4>
						</div>
					</div>
					<div class="flex-container-evenlyspace padb">
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_run">Run
									<input type="text" class="center border" name="attr_stat_total_run" value="0" readonly />
								</span>
							</h4>
						</div>
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_leap">Leap
									<input type="text" class="center border" name="attr_stat_total_leap" value="0" readonly />
								</span>
							</h4>
						</div>
						<div class="flex-1-5">
							<h4 class="center border">
								<span style="font-size: 99px;">&nbsp;</span>
							</h4>
						</div>
					</div>
					<div class="flex-container-evenlyspace padb">
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_sprint">Sprint
									<input type="text" class="center border" name="attr_stat_total_sprint" value="0" readonly />
								</span>
							</h4>
						</div>
						<div class="flex-1-5">
							<h4 class="center border">
								<span style="font-size: 99px;">&nbsp;</span>
							</h4>
						</div>
						<div class="flex-1-5">
							<h4 class="center border">
								<span name="attr_label_lift">Lift
									<input type="text" class="center border" name="attr_stat_total_lift" value="0" readonly />
								</span>
							</h4>
						</div>
					</div>
				</div>
				<div class="col-1-24">
					<h5 class="row">
						<div style="float:right" class="padr">
							<input type="checkbox" name="attr_statmanagement" class="ro-checkbox" /><span class="ro-label">y</span>
							<div class="ro-modal padl padr">
								<div class="border">
									<div class="ro-close-wrapper">
										<input type="checkbox" name="attr_statmanagement" class="ro-close-checkbox" value="1" />
										<span class="ro-close-label"></span>
									</div>
									<div class="ro-header padb">
										<div class="col-1-3">
											<div class="row padt padb"><h3 class="col-1 center border"><span>Stat Management</span></h3></div>
											<div class="row center">
												<div class="col-1-3 padr"><h4 class="center border"><span>Body
													<select name="attr_static_stat_base_body"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option></select>
												</span></h4></div>
												<div class="col-1-3 padr"><h4 class="center border"><span>Mind
													<select name="attr_static_stat_base_mind"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option></select>
												</span></h4></div>
												<div class="col-1-3"><h4 class="center border"><span>Soul
													<select name="attr_static_stat_base_soul"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option></select>
												</span></h4></div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</h5>
				</div>
			</div>
		</div>

		<div class="section-attributes header"><h3 class="center" style="color: white">Alterators</h3>	
			<div style="padding-bottom: 25px;">
				<div class="row center padt">
					<button type="action" name="act_attrgroup1" ><span name="attr_static_attrgroup_1_name"></span></button>
					<button type="action" name="act_attrgroup2" ><span name="attr_static_attrgroup_2_name"></span></button>
					<button type="action" name="act_attrgroup3" ><span name="attr_static_attrgroup_3_name"></span></button>
				</div>
				<input type='hidden' class='tabstoggle' name='attr_static_attrgroup_selected_tab'  value='attrgroup1' />

				<div class='attrgroup1'>
					<div class="flex-container-evenlyspace center padt padb">
						<div class="flex-1-3">
							<h4 class="center border">
								<span>Group Name
									<input type="text" class="center border" name="attr_static_attrgroup_1_name" value="Physical Traits" readonly />
								</span>
							</h4>
						</div>
					</div>
					<div>
						<input type="checkbox" class="block-switch" name="attr_static_attrgroup_1_changegroup" value="1" />
						<div class="block-a"></div>
						<div class="block-b">
							<div class="flex-container padl padr padb">
								<input type="hidden" name="attr_static_attrgroup_1_spent" value=0 readonly />
								<div class="flex-8-15 padr">
									<h4 class="center border">
										<div style="height: 47px;">
											<span style="font-size: 16px; position: relative; top: 30%;" name="attr_static_attrgroup_1_pointype"></span>
										</div>
										<input type="hidden" name="attr_static_attrgroup_1_pointype" value="Flux Points" />
									</h4>
								</div>
								<div>
									<input type="checkbox" class="block-switch" name="attr_static_attrgroup_1_changemax" value="1" />
									<div class="block-a">
										<div class="flex-1-4 padr">
											<h4 class="center border">
												<span>Max
													<input type="text" class="center" name="attr_static_attrgroup_1_groupmax" value=0 readonly />
												</span>
											</h4>
										</div>
									</div>
									<div class="block-b">
										<div class="flex-1-4 padr">
											<h4 class="center border">
												<span>Max
													<input type="number" class="center" name="attr_static_attrgroup_1_groupmax" value=0 />
												</span>
											</h4>
										</div>
									</div>
								</div>
								<div class="flex-1-4 padr">
									<h4 class="center border">
										<span>Remaining
											<input type="number" class="center" name="attr_static_attrgroup_1_spent" value=0 readonly />
											<!--<input type="number" class="center" name="attr_static_attrgroup_1_remaining" value="@{static_attrgroup_1_groupmax}-@{static_attrgroup_1_spent}" disabled />-->
										</span>
									</h4>
								</div>
								<div class="flex-1">
									<h4 class="center border">
										<div style="height: 47px;"></div>
									</h4>
								</div>
							</div>
						</div>
					</div>
				</div>
								
				<div class='attrgroup2'>
					<div class="flex-container-evenlyspace center padt padb">
						<div class="flex-1-3">
							<h4 class="center border">
								<span>Group Name
									<input type="text" class="center border" name="attr_static_attrgroup_2_name" value="Advantages" />
								</span>
							</h4>
						</div>
					</div>
					<div>
						<input type="checkbox" class="block-switch" name="attr_static_attrgroup_2_changegroup" value="1" />
						<div class="block-a"></div>
						<div class="block-b">
							<div class="flex-container padl padr">
								<input type="hidden" name="attr_static_attrgroup_2_spent" value=0 readonly />
								<div class="flex-1-2 padr">
									<h4 class="center border">
										<div style="height: 47px;">
											<span style="font-size: 16px; position: relative; top: 30%;" name="attr_static_attrgroup_2_pointype"></span>
										</div>
										<input type="hidden" name="attr_static_attrgroup_2_pointype" value="Flux Points" />
									</h4>
								</div>
								<div>
									<input type="checkbox" class="block-switch" name="attr_static_attrgroup_2_changemax" value="1" />
									<div class="block-a">
										<div class="flex-1-4 padr">
											<h4 class="center border">
												<span>Max
													<input type="text" class="center" name="attr_static_attrgroup_2_groupmax" value=0 readonly />
												</span>
											</h4>
										</div>
									</div>
									<div class="block-b">
										<div class="flex-1-4 padr">
											<h4 class="center border">
												<span>Max
													<input type="number" class="center" name="attr_static_attrgroup_2_groupmax" value=0 />
												</span>
											</h4>
										</div>
									</div>
								</div>
								<div class="flex-1-4 padr">
									<h4 class="center border">
										<span>Remaining
											<input type="number" class="center" name="attr_static_attrgroup_2_spent" value=0 readonly />
											<!--<input type="number" class="center" name="attr_static_attrgroup_2_remaining" value="@{static_attrgroup_2_groupmax}-@{static_attrgroup_2_spent}" disabled />-->
										</span>
									</h4>
								</div>
								<div class="flex-1">
									<h4 class="center border">
										<div style="height: 47px;"></div>
									</h4>
								</div>
							</div>
						</div>
					</div>
				</div>
					
				<div class='attrgroup3'>
					<div class="flex-container-evenlyspace center padt padb">
						<div class="flex-1-3">
							<h4 class="center border">
								<span>Group Name
									<input type="text" class="center border" name="attr_static_attrgroup_3_name" value="Disadvantages" />
								</span>
							</h4>
						</div>
					</div>
					<div>
						<input type="checkbox" class="block-switch" name="attr_static_attrgroup_3_changegroup" value="1" />
						<div class="block-a"></div>
						<div class="block-b">
							<div class="flex-container padl padr">
								<input type="hidden" name="attr_static_attrgroup_3_spent" value=0 readonly />
								<div class="flex-1-2 padr">
									<h4 class="center border">
										<div style="height: 47px;">
											<span style="font-size: 16px; position: relative; top: 30%;" name="attr_static_attrgroup_3_pointype"></span>
										</div>
										<input type="hidden" name="attr_static_attrgroup_3_pointype" value="Flux Points" />
									</h4>
								</div>
								<div>
									<input type="checkbox" class="block-switch" name="attr_static_attrgroup_3_changemax" value="1" />
									<div class="block-a">
										<div class="flex-1-4 padr">
											<h4 class="center border">
												<span>Max
													<input type="text" class="center" name="attr_static_attrgroup_3_groupmax" value=0 readonly />
												</span>
											</h4>
										</div>
									</div>
									<div class="block-b">
										<div class="flex-1-4 padr">
											<h4 class="center border">
												<span>Max
													<input type="number" class="center" name="attr_static_attrgroup_3_groupmax" value=0 />
												</span>
											</h4>
										</div>
									</div>
								</div>
								<div class="flex-1-4 padr">
									<h4 class="center border">
										<span>Remaining
											<input type="number" class="center" name="attr_static_attrgroup_3_spent" value=0 readonly />
											<!--<input type="number" class="center" name="attr_static_attrgroup_3_remaining" value="@{static_attrgroup_3_groupmax}-@{static_attrgroup_3_spent}" disabled />-->
										</span>
									</h4>
								</div>
								<div class="flex-1">
									<h4 class="center border">
										<div style="height: 47px;"></div>
									</h4>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				<fieldset class="repeating_attr">
					<div class="flex-container padr padl">
						<input type="checkbox" class="block-switch" name="attr_visible" value="1" />
						<div class="block-a">
							<div class="center border padframe">
								<div class="flex-container">
									<div>
										<input type="checkbox" class="block-switch" name="attr_activate" value="1" />
										<div class="block-a">
											<div style="padding-top: .6em;" class="flex-1-20 flex-center padr padl">
												<button style="padding: 8px;" type="action" class="border activate" name="act_activate">
													<span class="deactivated pictos">Q</span>
												</button>
											</div>
										</div>
										<div class="block-b">
											<div style="padding-top: .6em;" class="flex-1-20 flex-center padr padl">
												<input type="hidden" class="activate" name="attr_activatetheme" value="1" />
												<button style="padding: 8px;" type="action" class="border activated activate" name="act_activate">
													<span class="theme-red activate-button pictos">Q</span>
													<span class="theme-orange activate-button pictos">Q</span>
													<span class="theme-yellow activate-button pictos">Q</span>
													<span class="theme-green activate-button pictos">Q</span>
													<span class="theme-blue activate-button pictos">Q</span>
													<span class="theme-purple activate-button pictos">Q</span>
													<span class="theme-grey activate-button pictos">Q</span>
													<span class="theme-dark activate-button pictos">Q</span>
													<span class="theme-light activate-button pictos">Q</span>
												</button>
											</div>
										</div>
									</div>

									<div class="flex-2-7 padl flex-center padr">
										<h4 class="center border">
											<span>Name
												<input type="text" class='center' name="attr_name" placeholder="Name" value="" />
											</span>
										</h4>
									</div>
									<div class="flex-1-4 flex-center padr">
										<h4 class="center border">
											<span>Attribute
												<input type="text" class='center' name="attr_type" placeholder="Body/Looks/Talk" value="" />											</span>
										</h4>
									</div>
									<div class="flex-5-14 padr flex-center padr">
										<h4 class="center border">
											<span>Effects
												<input type="text" class='center' name="attr_effect" value="Effects" />
											</span>
										</h4>
									</div>

									<input type="hidden" name="attr_costperlevel" value=0 readonly />
									<input type="hidden" name="attr_enhancementassignments" value=0 readonly />
									<input type="hidden" name="attr_limiterassignments" value=0 readonly />
									<input type="hidden" name="attr_customizations" readonly />
									<input type="hidden" name="attr_group" value=0 readonly />
									<input type="hidden" name="attr_source" value="" readonly />
									<!--<input type="hidden" name="attr_new" value=1 readonly />-->

									<div class="flex-1-13 flex-center">
										<input type="checkbox" class="border lock" name="attr_lock" value="1" /><span></span>
									</div>
<!--
									<div class="flex-skillchild-button">
										<button style="padding: 8px;" type='action' name='act_options'><span class="pictos">y</span></button>
									</div>
-->
								</div>
								<div class="flex-container-evenlyspace padb">
									<div class="flex-1">
										<div>
											<input type="checkbox" class="block-switch" name="attr_options" value="1" checked />
											<div class="block-a"></div>
											<div class="block-b">
												<div class="row">
													<div class="row padt">
														<div class="col-5-6">
															<div class="row">
																<div class="col-3-5 padr">
																	<textarea class="description border" name="attr_description" placeholder="Description"></textarea>
																</div>
																<div class="col-2-5">

																	<div class="col-7-22">
																		<h4 class="center border">
																			<div>
																				<input type="checkbox" class="block-switch" name="attr_attrdefecttoggle" value="1" />
																				<div class="block-b">
																					<span style="font-size: 99px;">&nbsp;</span>
																				</div>
																			</div>
																		</h4>
																	</div>

																	<div class="col-7-22">
																		<h4 class="center border">
																			<div>
																				<input type="checkbox" class="block-switch" name="attr_attrdefecttoggle" value="1" />
																				<div class="block-a">
																					<span>Level</span>
																					<input type="text" style="text-align: center;" name="attr_effectivelevel" value="0"/>
																				</div>
																				<div class="block-b">
																					<span style="font-size: 99px;">&nbsp;</span>
																				</div>
																			</div>
																		</h4>
																	</div>

																	<div class="col-7-22">
																		<h4 class="center border">
																			<span>Cost</span>
																			<input style="text-align: center;" type="text" name="attr_totalcost" value="0"/>
																		</h4>
																	</div>
																</div>
															</div>
														</div>
													</div>

													<div class="row padb">
														<input type="checkbox" class="block-switch" name="attr_showunaffected" value="1" />
														<div class="block-a"></div>
														<div class="block-b">
															<div class="col-5-6">
																<h4 class="center border">
																	<span>Unaffected Attributes</span>
																	<div class="flex-container-wrap">
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_alternateformstate" value="1" />
																			<button type="action" class="multi-select push-button" value="alternate form" name="act_unaffected">Alternate&nbsp;Form</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_alternateidentitystate" value="1" />
																			<button type="action" class="multi-select push-button" value="alternate identity" name="act_unaffected">Alternate&nbsp;Identity</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_changestatestate" value="1" />
																			<button type="action" class="multi-select push-button" value="change state" name="act_unaffected">Change&nbsp;State</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_dataaccessstate" value="1" />
																			<button type="action" class="multi-select push-button" value="data access" name="act_unaffected">Data&nbsp;Access</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_dimensionwalkstate" value="1" />
																			<button type="action" class="multi-select push-button" value="dimension walk" name="act_unaffected">Dimension&nbsp;Walk</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_dynamicpowersstate" value="1" />
																			<button type="action" class="multi-select push-button" value="dynamic powers" name="act_unaffected">Dynamic&nbsp;Powers</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_exorcismstate" value="1" />
																			<button type="action" class="multi-select push-button" value="exorcism" name="act_unaffected">Exorcism</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_featuresstate" value="1" />
																			<button type="action" class="multi-select push-button" value="features" name="act_unaffected">Features</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_forcefieldstate" value="1" />
																			<button type="action" class="multi-select push-button" value="forcefield" name="act_unaffected">Force&nbsp;Field</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_illusionstate" value="1" />
																			<button type="action" class="multi-select push-button" value="illusion" name="act_unaffected">Illusion</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_metamorphosisstate" value="1" />
																			<button type="action" class="multi-select push-button" value="metamorphosis" name="act_unaffected">Metamorphosis</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_mindcontrolstate" value="1" />
																			<button type="action" class="multi-select push-button" value="mind control" name="act_unaffected">Mind&nbsp;Control</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_nullifystate" value="1" />
																			<button type="action" class="multi-select push-button" value="nullify" name="act_unaffected">Nullify</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_plantcontrolstate" value="1" />
																			<button type="action" class="multi-select push-button" value="plant control" name="act_unaffected">Plant&nbsp;Control</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_portalstate" value="1" />
																			<button type="action" class="multi-select push-button" value="portal" name="act_unaffected">Portal</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_projectionstate" value="1" />
																			<button type="action" class="multi-select push-button" value="projection" name="act_unaffected">Projection</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_sensoryblockstate" value="1" />
																			<button type="action" class="multi-select push-button" value="sensory block" name="act_unaffected">Sensory&nbsp;Block</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_sizechangestate" value="1" />
																			<button type="action" class="multi-select push-button" value="size change" name="act_unaffected">Size&nbsp;Change</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_telekinesisstate" value="1" />
																			<button type="action" class="multi-select push-button" value="telekinesis" name="act_unaffected">Telekinesis</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_telepathystate" value="1" />
																			<button type="action" class="multi-select push-button" value="telepathy" name="act_unaffected">Telepathy</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_teleportstate" value="1" />
																			<button type="action" class="multi-select push-button" value="teleport" name="act_unaffected">Teleport</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_transmutestate" value="1" />
																			<button type="action" class="multi-select push-button" value="transmute" name="act_unaffected">Transmute</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_undetectablestate" value="1" />
																			<button type="action" class="multi-select push-button" value="undetectable" name="act_unaffected">Undetectable</button>
																		</div>
																		<div class="flex-1-6">
																			<input type="checkbox" class="push-button" name="attr_weaponstate" value="1" />
																			<button type="action" class="multi-select push-button" value="weapon" name="act_unaffected">Weapon</button>
																		</div>
																	</div>
																</h4>
															</div>
														</div>
													</div>
													
													<div class="row padb">
														<div style="padding-left: 68px;" class="flex-container col-5-6">
															<div>
																<input type="checkbox" class="block-switch" name="attr_showarmorlayer" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Armor Layer</span>
																			<select name="attr_armorlayer"><option value=1>Primary</option><option value=2>Secondary</option><option value=3>Tracheary</option></select>
																		</h4>
																	</div>
																</div>
															</div>

															<div>
																<input type="checkbox" class="block-switch" name="attr_showaugmentedstat" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Augmented Stat</span>
																			<select name="attr_augmentedstat"><option value='body'>Body</option><option value='mind'>Mind</option><option value='soul'>Soul</option></select>
																		</h4>
																	</div>
																</div>
															</div>

															<div>
																<input type="checkbox" class="block-switch" name="attr_showweaponclass" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Weapon Class</span>
																			<select name="attr_weaponclass">
																				<option value=""></option>
																				<option disabled style="background:gray;font-weight:bold;color:white;">Melee</option>
																					<option value="exotic">Exotic</option>
																					<option value="hafted">Hafted</option>
																					<option value="hilted">Hilted</option>
																					<option value="polearm">Polearm</option>
																					<option value="shield">Shield</option>
																					<option value="unarmed">Unarmed</option>
																				<option disabled style="background:gray;font-weight:bold;color:white;">Ranged</option>
																					<option value="archery">Archery</option>
																					<option value="artillery">Artillery</option>
																					<option value="handgun">Hand Gun</option>
																					<option value="heavyweapon">Heavy Weapon</option>
																					<option value="longgun">Long Gun</option>
																					<option value="special">Special</option>
																					<option value="thrownweapon">Thrown Weapon</option>
																					<option value="weaponry">Weaponry</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															
															<div>
																<input type="checkbox" class="block-switch" name="attr_showmeleeclass" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Weapon Class</span>
																			<select name="attr_weaponclass">
																				<option value=""></option>
																				<option disabled style="background:gray;font-weight:bold;color:white;">Melee</option>
																					<option value="exotic">Exotic</option>
																					<option value="hafted">Hafted</option>
																					<option value="hilted">Hilted</option>
																					<option value="polearm">Polearm</option>
																					<option value="shield">Shield</option>
																					<option value="unarmed">Unarmed</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>

															<div>
																<input type="checkbox" class="block-switch" name="attr_showrangedclass" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Weapon Class</span>
																			<select name="attr_weaponclass">
																				<option value=""></option>
																				<option disabled style="background:gray;font-weight:bold;color:white;">Ranged</option>
																					<option value="archery">Archery</option>
																					<option value="artillery">Artillery</option>
																					<option value="handgun">Hand Gun</option>
																					<option value="heavyweapon">Heavy Weapon</option>
																					<option value="longgun">Long Gun</option>
																					<option value="special">Special</option>
																					<option value="thrownweapon">Thrown Weapon</option>
																					<option value="weaponry">Weaponry</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>

															<div>
																<input type="checkbox" class="block-switch" name="attr_showdefenseclass" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Defense Class</span>
																			<select name="attr_defenseclass"><option value="personal">Personal</option><option value="movement">Movement</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															
															<div>
																<input type="checkbox" class="block-switch" name="attr_showdamagetype" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div>
																		<input type="checkbox" class="block-switch" name="attr_normaldamage" value="1" checked />
																		<div class="block-a"></div>
																		<div class="block-b">
																			<div class="col-1 padr">
																				<h4 class="center border">
																					<span>Damage Type</span>
																					<select class="border" name="attr_damagetype">
																						<option value=""></option>
																						<option disabled style="background:gray;font-weight:bold;color:white;">Chemical</option>
																							<option value="acid">Acid</option>
																							<option value="toxin">Toxin</option>
																						<option disabled style="background:gray;font-weight:bold;color:white;">Energy</option>
																							<option value="cold">Cold</option>
																							<option value="electric">Electric</option>
																							<option value="heat">Heat</option>
																							<option value="radiation">Radiation</option>
																						<option disabled style="background:gray;font-weight:bold;color:white;">Physical</option>
																							<option value="blunt">Blunt</option>
																							<option value="penetrating">Penetrating</option>
																					</select>
																				</h4>
																			</div>
																		</div>
																	</div>
																	<div>
																		<input type="checkbox" class="block-switch" name="attr_insidiousdamage" value="1" />
																		<div class="block-a"></div>
																		<div class="block-b">
																			<div class="col-1 padr">
																				<h4 class="center border">
																					<span>Damage Type</span>
																					<select class="border" name="attr_damagetype">
																						<option value=""></option>
																						<option disabled style="background:gray;font-weight:bold;color:white;">Chemical</option>
																							<option value="acid">Acid</option>
																							<option value="toxin">Toxin</option>
																						<option disabled style="background:gray;font-weight:bold;color:white;">Condition</option>
																							<option value="disease">Disease</option>
																						<option disabled style="background:gray;font-weight:bold;color:white;">Energy</option>
																							<option value="cold">Cold</option>
																							<option value="electric">Electric</option>
																							<option value="heat">Heat</option>
																							<option value="radiation">Radiation</option>
																					</select>
																				</h4>
																			</div>
																		</div>
																	</div>
																	<div>
																		<input type="checkbox" class="block-switch" name="attr_psychicdamage" value="1" />
																		<div class="block-a"></div>
																		<div class="block-b">
																			<div class="col-1 padr">
																				<h4 class="center border">
																					<span>Damage Type</span>
																					<!--<input type="text" class="border" name="attr_damagetype" value="Psychosomatic" readonly />-->
																					<select class="border" name="attr_damagetype" readonly >
																						<option value=""></option>
																						<option disabled style="background:gray;font-weight:bold;color:white;">Condition</option>
																							<option value="psychosomatic">Psychosomatic</option>
																					</select>
																				</h4>
																			</div>
																		</div>
																	</div>
																</div>
															</div>

															<div>
																<input type="checkbox" class="block-switch" name="attr_showdamagecategory" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Damage Category</span>
																			<select class="border" name="attr_damagecategory"><option value=""></option><option value="chemical">Chemical</option><option value="energy">Energy</option><option value="physical">Physical</option></select>
																		</h4>
																	</div>
																</div>
															</div>

															<div>
																<input type="checkbox" class="block-switch" name="attr_showcontinuing" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Continuing Type</span>
																			<select class="border" name="attr_continuingtype"><option value=1>nRounds</option><option value=2>Per Hour</option><option value=3>Per Day</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															
															<div>
																<input type="checkbox" class="block-switch" name="attr_showdrain" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Drain Type</span>
																			<select name="attr_draintype"><option value="body">Body</option><option value="mind">Mind</option><option value="soul">Soul</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															
															<div>
																<input type="checkbox" class="block-switch" name="attr_showcollectiontype" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Collection Type</span>
																			<select class="border" name="attr_collectiontype"><option value=1>Health</option><option value=2>Energy</option></select>
																		</h4>
																	</div>
																</div>
															</div>

															<div>
																<input type="checkbox" class="block-switch" name="attr_showconversiontype" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Collection Type</span>
																			<select class="border" name="attr_conversiontype"><option value=0>Damage</option><option value=1>Energy</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															
															<div>
																<input type="checkbox" class="block-switch" name="attr_showseeinto" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>See Into</span>
																			<select class="border" name="attr_seeinto"><option value=0>Future</option><option value=1>Past</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															
															<div>
																<input type="checkbox" class="block-switch" name="attr_showextraarms" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Extra Arms</span>
																			<input type="number" class="border center" name="attr_extraarms" value=0 />
																		</h4>
																	</div>
																</div>
															</div>
															
															<div>
																<input type="checkbox" class="block-switch" name="attr_showimmunityrole" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Immunity Role</span>
																			<input type="text" class="border center" name="attr_immunityrole" placeholder="e.g. metal weapons or on holy days" />
																		</h4>
																	</div>
																</div>
															</div>
															
															<div>
																<input type="checkbox" class="block-switch" name="attr_showattrsrc" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Attribute Source</span>
																			<select class="border" name="attr_attrsrc"><option value="Divine">Divine</option><option value="Magical">Magical</option><option value="Mutation">Mutation</option><option value="Natural">Natural</option><option value="Psionics">Psionics</option><option value="Social">Social</option><option value="Skilled">Skilled</option><option value="Supernatural">Supernatural</option><option value="Technological">Technological</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															<!--
															<div>
																<input type="checkbox" class="block-switch" name="attr_showconditions" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Source</span>
																			<select class="border" name="attr_conditions"><option value=1>Divine</option><option value=2>Magical</option><option value=3>Mutation</option><option value=4>Natural</option><option value=5>Psionics</option><option value=6>Social</option><option value=7>Skilled</option><option value=8>Supernatural</option><option value=9>Technological</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															-->
															<div>
																<input type="checkbox" class="block-switch" name="attr_showcapacitytype" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Capacity Type</span>
																			<select class="border" name="attr_capacitytype"><option value=0>Cargo</option><option value=1>People</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showenemy" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Enemy</span>
																			<input type='text' class='center' name="attr_enemy" placeholder='Enter Enemy' value='' />
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showskillgroup" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Skill Group</span>
																			<select class="border" name="attr_skillgroup"><option value=1>Skill Group 1</option><option value=2>Skill Group 2</option><option value=3>Skill Group 3</option><option value=4>Skill Group 4</option><option value=5>Skill Group 5</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showsupersense" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Super Sense</span>
																			<select class="border" name="attr_supersense">
																				<option disabled style="background:gray;font-weight:bold;color:white;">Sight</option>
																					<option value="infrared">Infrared</option>
																					<option value="microscopic">Microscopic</option>
																					<option value="telescopic">Telescopic</option>
																					<option value="ultraviolet">Ultraviolet</option>
																					<option value="x-ray">X-ray</option>
																				<option disabled style="background:gray;font-weight:bold;color:white;">Hearing</option>
																					<option value="echolocation">Echolocation</option>
																					<option value="infrasound">Infrasound</option>
																					<option value="radio">Radio</option>
																					<option value="ultrasound">Ultrasound</option>
																				<option disabled style="background:gray;font-weight:bold;color:white;">Touch</option>
																					<option value="magneticfield">Magnetic Field</option>
																					<option value="radiation">Radiation</option>
																					<option value="seismic">Seismic</option>
																					<option value="thermal">Thermal</option>
																				<option disabled style="background:gray;font-weight:bold;color:white;">Smell</option>
																					<option value="odorant">Chemical Detection (Odorant)</option>
																				<option disabled style="background:gray;font-weight:bold;color:white;">Taste</option>
																					<option value="tastant">Chemical Detection (Tastant)</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showobject" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Object</span>
																			<input type='text' name="attr_object" placeholder='Enter Object' value='' />
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showuniqueattributecost" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Unique Attribute Cost per Level</span>
																			<select class="boarder" name="attr_uniqueattributecost">
																				<option value=0></option>
																				<option value=1>1</option>
																				<option value=2>2</option>
																				<option value=3>3</option>
																				<option value=4>4</option>
																				<option value=5>5</option>
																				<option value=6>6</option>
																				<option value=7>7</option>
																				<option value=8>8</option>
																				<option value=9>9</option>
																				<option value=10>10</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<!--
															<div>
																<input type="checkbox" class="block-switch" name="attr_showunaffected" value="1" checked />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Unaffected By</span>
																			<select class="boarder" name="attr_unaffected">
																				<option value=1>Attributes</option>
																				<option value=2>Weapons</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															-->
															<div>
																<input type="checkbox" class="block-switch" name="attr_showunaffectedweapon" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Unaffected Weapon</span>
																			<select class="boarder" name="attr_unaffectedweapon">
																				<option value=""></option>
																				<option value="blight">Blight</option>
																				<option value="contagious">Contagious</option>
																				<option value="continuing">Continuing</option>
																				<option value="Drain">Drain</option>
																				<option value="enervation">Enervation</option>
																				<option value="flare">Flare</option>
																				<option value="homing">Homing</option>
																				<option value="incapacitating">Incapacitating</option>
																				<option value="incurable">Incurable</option>
																				<option value="insidious">Insidious</option>
																				<option value="irritant">Irritant</option>
																				<option value="multidimensional">Multidimensional</option>
																				<option value="penetrating">Penetrating</option>
																				<option value="piercing">Piercing</option>
																				<option value="psychic">Psychic</option>
																				<option value="stun">Stun</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showuniquephenomena" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Unique Phenomena</span>
																			<input type='text' name="attr_uniquephenomena" placeholder='Enter Phenomena' value='' />
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showvariablestat" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="padr">
																		<h4 class="center border">
																			<!--
																			<div class="flex-container-spacearound">
																				<div class="flex-container-column padr">
																					<div class="col-1">
																						<span>Stat</span>
																						<input class="border center" type="text" name="attr_stat" value="Body" />
																					</div>
																				</div>
																				<button style="padding: 0px 8px 0px 8px; margin: 2px 0 2px 0;" type='action' name='act_statselection'><span style="font-size: 18px;" class="pictos">U</span></button>
																			</div>-->
																			<div>
																				<span>Stat</span>
																				<select class="border" name="attr_stat"><option value="body">Body</option><option value="mind">Mind</option><option value="soul">Soul</option></select>
																			</div>
																		</h4>
																	</div>
																</div>
															</div>

															<div>
																<input type="checkbox" class="block-switch" name="attr_showammo" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Capacity</span>
																			<input type="text" class="border center" name="attr_capacity" value="0" />
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showcharges" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Charges</span>
																			<input type="text" class="border center" name="attr_charges" value="0" />
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showendurance" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Endurance</span>
																			<input type="text" class="border center" name="attr_endurance" value="0" readonly />
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showbroadcategory" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Broad Category</span>
																			<input type="text" class="border center" name="attr_broadcategory" value="" placeholder="metal, weapons, clothing, food, etc." />
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showintensity" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Conditional</span>
																			<input type="text" class="border center" name="attr_intensity" value="" placeholder="sunlight, positive emotions, etc." />
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showdefect" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Defect</span>
																			<select class="border" name="attr_defect"><option value=""></option><option value="achilles heel">Achilles Heel</option><option value="awkward size">Awkward Size</option><option value="bane">Bane</option><option value="blind fury">Blind Fury</option><option value="conditional ownership">Conditional Ownership</option><option value="confined">Confined</option><option value="cursed">Cursed</option><option value="demure">Demure</option></option><option value="easily distracted">Easily Distracted</option><option value="fragile">Fragile</option><option value="hounded">Hounded</option><option value="impaired manipulation">Impaired Manipulation</option><option value="impaired speech">Impaired Speech</option><option value="inept attack">Inept Attack</option><option value="inept defense">Inept Defence</option><option value="involuntary change">Involuntary Change</option><option value="ism">Ism</option><option value="magnet">Magnet</option><option value="marked">Marked</option><option value="nemesis">Nemesis</option><option value="nightmares">Nightmares</option><option value="no healing">No Healing</option><option value="obligated">Obligated</option><option value="phobia">Phobia</option><option value="physical impairment">Physical Impairment</option><option value="red tape">Red Tape</option><option value="reduced damage">Reduced Damage</option><option value="sensory impairment">Sensory Impairment</option><option value="shortcoming">Shortcoming</option><option value="significant other">Significant Other</option><option value="skeleton in the closet">Skeleton in the Closet</option><option value="social fault">Social Fault</option><option value="special requirement">Special Requirement</option><option value="unappealing">Unappealing</option><option value="unique defect">Unique Defect</option><option value="unsettled">Unsettled</option><option value="vulnerability">Vulnerability</option><option value="wanted">Wanted</option><option value="weak point">Weak Point</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showachillesheel" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Attack Form</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Rare</option>
																				<option value=2>Uncommon</option>
																				<option value=3>Common</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showawkwardsize" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Awkward Size</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0>Medium</option><option value=1>Large</option><option value=2>Huge</option><option value=3>Mammoth</option><option value=4>Gigantic</option><option value=5>Gargantuan</option><option value=6>Colossal</option><option value=7>Enormous</option><option value=8>Monstous</option><option value=9>Titanic</option><option value=10>Monumental</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showbane" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Damage</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>10 per round of exosure</option>
																				<option value=2>20 per round of exosure</option>
																				<option value=3>30 per round of exosure</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showblindfury" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Initiate/Revert</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Difficult/Easy</option>
																				<option value=2>Moderately Difficult</option>
																				<option value=3>Easy/Difficult</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showconditionalownership" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Ownership Conditions</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Mild</option>
																				<option value=2>Strict</option>
																				<option value=3>Severe</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showconfined" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Restricted Area</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Large (100 km radius)</option>
																				<option value=2>Moderate (1 km radius)</option>
																				<option value=3>Small (100 m radius)</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showcursed" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Curse Disadvantage</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight</option>
																				<option value=2>Moderate</option>
																				<option value=3>Severe</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showdemure" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Embarrassment/Shame</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Mild (SCV -2)</option>
																				<option value=2>Moderate (SCV -4)</option>
																				<option value=3>Severe (SCV -6)</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showeasilydistracted" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Triggered</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Infrequently</option>
																				<option value=2>Frequently</option>
																				<option value=3>Constantly</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showfragile" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Health Points</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Decreased by 10</option>
																				<option value=2>Decreased by 20</option>
																				<option value=3>Decreased by 30</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showhounded" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Inconvenience</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight</option>
																				<option value=2>Moderate</option>
																				<option value=3>Severe</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showimpairedmanipulation" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Impairment</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>One usable arm</option>
																				<option value=2>Rudimentary manipulation</option>
																				<option value=3>No usable arms</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showimpairedspeech" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Impediment</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Severe</option>
																				<option value=2>No language</option>
																				<option value=3>Mute</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showineptattack" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Penalty</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Minor (ACV -1)</option>
																				<option value=2>Moderate (ACV -2)</option>
																				<option value=3>Severe (ACV -3)</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showineptdefence" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Penalty</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Minor (DCV -1)</option>
																				<option value=2>Moderate (DCV -2)</option>
																				<option value=3>Severe (DCV -3)</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showinvoluntarychange" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Change Trigger</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Difficult</option>
																				<option value=2>Moderately Easy</option>
																				<option value=3>Easy</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showism" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Discrimination</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight</option>
																				<option value=2>Moderate</option>
																				<option value=3>Severe</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showmagnet" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Fan Volume</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Few</option>
																				<option value=2>Handful</option>
																				<option value=3>Swarm</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showmarked" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Concealability</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Easily</option>
																				<option value=2>Moderately Difficult</option>
																				<option value=3>Unconcealable</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_shownemesis" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Frequency</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Infrequent</option>
																				<option value=2>Frequent</option>
																				<option value=3>Constant</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_shownightmares" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Frequency</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Infrequent</option>
																				<option value=2>Frequent</option>
																				<option value=3>Constant</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_shownohealing" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Disadvantage</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight</option>
																				<option value=2>Moderate</option>
																				<option value=3>Severe</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showobligated" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Obligation</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight</option>
																				<option value=2>Moderate</option>
																				<option value=3>Large</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showphobia" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Encountered</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Infrequently</option>
																				<option value=2>Frequently</option>
																				<option value=3>Constantly</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showphysicalimpairment" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Inconvenience</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight</option>
																				<option value=2>Moderate</option>
																				<option value=3>Severe</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showredtape" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Managability</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Generally Easy</option>
																				<option value=2>Moderately Difficult</option>
																				<option value=3>Difficult</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showreduceddamage" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Damage Multiplier</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Minor (DM -1)</option>
																				<option value=2>Moderate (DM -2)</option>
																				<option value=3>Severe (DM -3)</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showsensoryimpairment" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border">
																			<span>Sense</span>
																			<select class="border" name="attr_sense">
																				<option value=""></option>
																				<option value="sight">Sight</option>
																				<option value="hearing">Hearing</option>
																				<option value="touch">Touch</option>
																				<option value="smell">Smell</option>
																				<option value="taste">Taste</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showsensoryimpairment" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Disadvantage</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Minor Obstacle</option>
																				<option value=2>Major Obstacle</option>
																				<option value=3>Loss of Sense</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showshortcoming" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Stat</span>
																			<select class="boarder" name="attr_defectaspect">
																				<option value=""></option>
																				<option class="font-bold" value="body">Body</option>
																					<option value="agi">&nbsp;Agility</option>
																					<option value="con">&nbsp;Constitution</option>
																					<option value="dex">&nbsp;Dexterity</option>
																					<option value="str">&nbsp;Strength</option>
																				<option class="font-bold" value="mind">Mind</option>
																					<option value="cre">&nbsp;Creativity</option>
																					<option value="int">&nbsp;Intellect</option>
																					<option value="per">&nbsp;Perception</option>
																					<option value="rea">&nbsp;Reasoning</option>
																				<option class="font-bold" value="soul">Soul</option>
																					<option value="awa">&nbsp;Awareness</option>
																					<option value="cha">&nbsp;Charisma</option>
																					<option value="com">&nbsp;Composure</option>
																					<option value="wil">&nbsp;Willpower</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showshortcoming" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Penalty</span>
																			<select name="attr_rank"><option value="0">0</option><option value="1">-1</option><option value="2">-2</option><option value="3">-3</option><option value="4">-4</option><option value="5">-5</option><option value="6">-6</option><option value="7">-7</option><option value="8">-8</option><option value="9">-9</option><option value="10">-10</option><option value="11">-11</option><option value="12">-12</option><option value="13">-13</option><option value="14">-14</option><option value="15">-15</option><option value="16">-16</option><option value="17">-17</option><option value="18">-18</option></select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showsignificantother" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Appearance</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Infrequently</option>
																				<option value=2>Frequently</option>
																				<option value=3>Constantly</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showskeletoninthecloset" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Discovery</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Difficult</option>
																				<option value=2>Moderate</option>
																				<option value=3>Easy</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showsocialfault" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Disadvantage</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight</option>
																				<option value=2>Moderate</option>
																				<option value=3>Severe</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showspecialrequirement" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Requirement</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Easy/Infrequent</option>
																				<option value=2>Moderately Difficult/Frequent</option>
																				<option value=3>Difficult/Constant</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showunappealing" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Offensiveness</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight</option>
																				<option value=2>Moderate</option>
																				<option value=3>Severe</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showunique" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Defect</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Infrequent/Slight</option>
																				<option value=2>Frequent/Moderate</option>
																				<option value=3>Constant/Severe</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showunsettled" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Sanity Points</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight (-2)</option>
																				<option value=2>Moderate (-4)</option>
																				<option value=3>Severe (-6)</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showvulnerability" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Impact</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Drop by one quarter</option>
																				<option value=2>Drop by one half</option>
																				<option value=3>Cannot be used</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showwanted" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Incentive</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Slight</option>
																				<option value=2>Moderate</option>
																				<option value=3>Extreme</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>
															<div>
																<input type="checkbox" class="block-switch" name="attr_showweakpoint" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div class="col-1 padr">
																		<h4 class="center border container">
																			<span>Target</span>
																			<select class="boarder" name="attr_rank">
																				<option value=0></option>
																				<option value=1>Difficult</option>
																				<option value=2>Moderate</option>
																				<option value=3>Easy</option>
																			</select>
																		</h4>
																	</div>
																</div>
															</div>

															<div style="padding-right: 2px;" class="flex-grow">
																<h4 class="center border">
																		<span style="font-size: 99px;">&nbsp;</span>
																</h4>
															</div>
														</div>
													</div>

													<!--
													<div class="row padb">
														<input type="checkbox" class="block-switch" name="attr_showunaffectedweapon" value="1" checked />
														<div class="block-a"></div>
														<div class="block-b">
															<div class="col-5-6">
																<h4 class="center border">
																	<span>Unaffected Weapons</span>
																	<div class="flex-container-wrap">
																		<button class="flex-1-6">Blight</button>
																		<button class="flex-1-6">Contagious</button>
																		<button class="flex-1-6">Continuing</button>
																		<button class="flex-1-6">Drain</button>
																		<button class="flex-1-6">Enervation</button>
																		<button class="flex-1-6">Flare</button>
																		<button class="flex-1-6">Homing</button>
																		<button class="flex-1-6">Incapacitating</button>
																		<button class="flex-1-6">Incurable</button>
																		<button class="flex-1-6">Insidious</button>
																		<button class="flex-1-6">Irritant</button>
																		<button class="flex-1-6">Multidimensional</button>
																		<button class="flex-1-6">Penetrating</button>
																		<button class="flex-1-6">Piercing</button>
																		<button class="flex-1-6">Psychic</button>
																		<button class="flex-1-6">Stun</button>
																	</div>
																</h4>
															</div>
														</div>
													</div>
													-->
													<div class="flex-container-evenlyspace">
														<div class="flex-1">
															<div>
																<input type="checkbox" class="block-switch" name="attr_statselection" value="1" />
																<div class="block-a"></div>
																<div class="block-b">
																	<div>
																		<input type="checkbox" class="block-switch" name="attr_majorstats" value="1" />
																		<div class="block-a">
																			<div class="flex-container center padb">
																				<div class='flex-1-3'></div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_bodystate" value="1" />
																					<button type="action" class="allaspects-stat" name="act_body" value="">Body</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_mindstate" value="1" />
																					<button type='action' class="allaspects-stat" name='act_mind' value="">Looks</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_soulstate" value="1" />
																					<button type='action' class="allaspects-stat" name='act_soul' value="">Talk</button>
																				</div>
																				<div class='flex-1-6'></div>
																			</div>										
																		</div>
																		<div class="block-b">
																			<div class="flex-container center padb">
																				<div class='flex-1-3'></div>
																				<div class="flex-1-5">
																					<button type="action" class="allaspects-stat-inactive">Body</button>
																				</div>
																				<div class="flex-1-5">
																					<button type='action' class="allaspects-stat-inactive">Looks</button>
																				</div>
																				<div class="flex-1-5">
																					<button type='action' class="allaspects-stat-inactive">Talk</button>
																				</div>
																				<div class='flex-1-6'></div>
																			</div>										
																		</div>
																	</div>	
																	<div>
																		<input type="checkbox" class="block-switch" name="attr_minorstats" value="1" />
																		<div class="block-a"></div>
																		<div class="block-b">
									
																			<div class="flex-container center padb">
																				<div class='flex-1-3'></div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_agistate" value="1" />
																					<button type='action' class="major-stat" name='act_agi' value="">Agility</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_crestate" value="1" />
																					<button type='action' class="major-stat" name='act_cre' value="">Creativity</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_awastate" value="1" />
																					<button type='action' class="major-stat" name='act_awa' value="">Awareness</button>
																				</div>
																				<div class='flex-1-6'></div>
																			</div>
																			<div class="flex-container center padb">
																				<div class='flex-1-3'></div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_constate" value="1" />
																					<button type='action' class="major-stat" name='act_con' value="">Constitution</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_intstate" value="1" />
																					<button type='action' class="major-stat" name='act_int' value="">Intellect</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_chastate" value="1" />
																					<button type='action' class="major-stat" name='act_cha' value="">Charisma</button>
																				</div>
																				<div class='flex-1-6'></div>
																			</div>
																			<div class="flex-container center padb">
																				<div class='flex-1-3'></div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_dexstate" value="1" />
																					<button type='action' class="major-stat" name='act_dex' value="">Dexterity</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_perstate" value="1" />
																					<button type='action' class="major-stat" name='act_per' value="">Perception</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_comtate" value="1" />
																					<button type='action' class="major-stat" name='act_com' value="">Composure</button>
																				</div>
																				<div class='flex-1-6'></div>
																			</div>
																			<div class="flex-container center padb">
																				<div class='flex-1-3'></div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_strstate" value="1" />
																					<button type="action" class="major-stat" name="act_str" value="">Strength</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_reastate" value="1" />
																					<button type="action" class="major-stat" name="act_rea" value="">Reasoning</button>
																				</div>
																				<div class="flex-1-5">
																					<input type="checkbox" class="stats" name="attr_wilstate" value="1" />
																					<button type='action' class="major-stat" name='act_wil' value="">Willpower</button>
																				</div>
																				<div class='flex-1-6'></div>
																			</div>
																		</div>
																	</div>
																</div>
															</div>	
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="block-b"></div>
					</div>
				</fieldset>
			</div>
		</div>
		
		<div class="section-skills header"><h3 class="center" style="color: white">Skills</h3>	
			<div style="padding-bottom: 25px;">
				<input type='hidden' class='skilltabstoggle' name='attr_static_skillgroup_selected_tab'  value='skillgroup1' />

				<div class='skillgroup1'>
					<div class="flex-container-evenlyspace center padt padb">
						
						<input type="hidden" name="attr_static_skillgroup_1_spent" value=0 readonly />
						<input type="hidden" name="attr_static_skillgroup_1_source" value="" readonly />
					</div>
				</div>

				<fieldset class="repeating_skill">
					<div class="padr padl">
						<input type="checkbox" class="block-switch" name="attr_visible" value="1" />
						<div class="block-a border padt padb">
							<div class="flex-container-evenlyspace padb">
								<div class="flex-skillchild-button">
									<button type="roll" style="padding: 8px;" class="d6button" name="roll_skillroll" value="@{skillrollvalue}"></button>
									<input type="hidden" name="attr_skillrollvalue" value="/roll 1d10" />
								</div>
								<div class="flex-1-4 padr">
									<h4 class="center border">
										<span>Skill
											<input type="text" class="center" name="attr_name" placeholder="Skill Name" value="Skill Name" />
											
										</span>
									</h4>
								</div>
								<div class="flex-2-5 padr">
									<h4 class="center border">
										<span>Skill Situation
											<input type="text" class="center" name="attr_specializations" placeholder="Skill Situation" value="Skill Situation" />
										</span>
									</h4>
								</div>
								<div class="flex-1-4 padr">
									<h4 class="center border">
										<span>Stat
											<input type="text" class="center" name="attr_stat" value="" readonly />
										</span>
									</h4>
								</div>
								<div class="flex-skillchild-button">
									<button style="padding: 8px;" type='action' name='act_statselection'><span class="pictos">U</span></button>
								</div>
								<div class="flex-skillchild-button">
									<button style="padding: 8px;" type='action' name='act_option'><span class="pictos">y</span></button>
								</div>
								<input type="hidden" name="attr_group" value=0 readonly />
								<input type="hidden" name="attr_new" value=1 readonly />
								<input type="hidden" name="attr_costperlevel" value=0 readonly />
							</div>
							<div class="flex-container-evenlyspace padb">
								<div class="flex-1">
									<div>
										<input type="checkbox" class="block-switch" name="attr_option" value="1" />
										<div class="block-a"></div>
										<div class="block-b">
											<div class="flex-container-evenlyspace padr padl">
												<div class='flex-1-16'></div>
												<div class="flex-1-7 padr">
													<h4 class="center border">
														<span>Bonus
															<div>
																<input type="checkbox" class="block-switch" name="attr_levelelevation" value="1" />
																<div class="block-a">
																	<div class="col-1">
																		<select style="width: 100%;" name="attr_level"><option value=0>0</option><option value=1>1</option><option value=2>2</option><option value=3>3</option><option value=4>4</option><option value=5>5</option><option value=6>6</option><option value=7>+</option></select>
																	</div>
																</div>
																<div class="block-b">
																	<div class="col-1">
																		<div><input type="number" name="attr_level" value="0" /></div>
																	</div>
																</div>
															</div>
														</span>
													</h4>
												</div>
												<div class="flex-1-7 padr">
													<h4 class="center border">
														<span>Cost
															<input type="text" class='center' name="attr_totalcost" value=0/>
														</span>
													</h4>
												</div>
												<div class="flex-3-4 padr">
													<h4 class="center border">
														<span>Description
															<input type="text" class="center" name="attr_specializations" placeholder='' value="" />
														</span>
													</h4>
												</div>
												<div class='flex-1-7'></div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="flex-container-evenlyspace">
								<div class="flex-1">
									<div>
										<input type="checkbox" class="block-switch" name="attr_statselection" value="1" />
										<div class="block-a"></div>
										<div class="block-b">
											<div>
												<input type="checkbox" class="block-switch" name="attr_majorstats" value="1" />
												<div class="block-a">
													<div class="flex-container center padb">
														<div class='flex-1-3'></div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_bodystate" value="1" />
															<button type="action" class="allaspects-stat" name="act_body" value="">Body</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_looksstate" value="1" />
															<button type='action' class="allaspects-stat" name='act_looks' value="">Looks</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_talkstate" value="1" />
															<button type='action' class="allaspects-stat" name='act_talk' value="">Talk</button>
														</div>
														<div class='flex-1-6'></div>
													</div>										
												</div>
												<div class="block-b">
													<div class="flex-container center padb">
														<div class='flex-1-3'></div>
														<div class="flex-1-5">
															<button type="action" class="allaspects-stat-inactive">Body</button>
														</div>
														<div class="flex-1-5">
															<button type='action' class="allaspects-stat-inactive">Looks</button>
														</div>
														<div class="flex-1-5">
															<button type='action' class="allaspects-stat-inactive">Talk</button>
														</div>
														<div class='flex-1-6'></div>
													</div>										
												</div>
											</div>	
											<div>
												<input type="checkbox" class="block-switch" name="attr_minorstats" value="1" />
												<div class="block-a"></div>
												<div class="block-b">
			
													<div class="flex-container center padb">
														<div class='flex-1-3'></div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_agistate" value="1" />
															<button type='action' class="major-stat" name='act_agi' value="">Agility</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_crestate" value="1" />
															<button type='action' class="major-stat" name='act_cre' value="">Creativity</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_awastate" value="1" />
															<button type='action' class="major-stat" name='act_awa' value="">Awareness</button>
														</div>
														<div class='flex-1-6'></div>
													</div>
													<div class="flex-container center padb">
														<div class='flex-1-3'></div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_constate" value="1" />
															<button type='action' class="major-stat" name='act_con' value="">Constitution</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_intstate" value="1" />
															<button type='action' class="major-stat" name='act_int' value="">Intellect</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_chastate" value="1" />
															<button type='action' class="major-stat" name='act_cha' value="">Charisma</button>
														</div>
														<div class='flex-1-6'></div>
													</div>
													<div class="flex-container center padb">
														<div class='flex-1-3'></div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_dexstate" value="1" />
															<button type='action' class="major-stat" name='act_dex' value="">Dexterity</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_perstate" value="1" />
															<button type='action' class="major-stat" name='act_per' value="">Perception</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_comtate" value="1" />
															<button type='action' class="major-stat" name='act_com' value="">Composure</button>
														</div>
														<div class='flex-1-6'></div>
													</div>
													<div class="flex-container center padb">
														<div class='flex-1-3'></div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_strstate" value="1" />
															<button type="action" class="major-stat" name="act_str" value="">Strength</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_reastate" value="1" />
															<button type="action" class="major-stat" name="act_rea" value="">Reasoning</button>
														</div>
														<div class="flex-1-5">
															<input type="checkbox" class="stats" name="attr_wilstate" value="1" />
															<button type='action' class="major-stat" name='act_wil' value="">Willpower</button>
														</div>
														<div class='flex-1-6'></div>
													</div>
												</div>
											</div>
										</div>
									</div>	
								</div>
							</div>
						</div>
						<div class="block-b">
						</div>
					</div>
				</fieldset>
				<!--
				<div>
					<h5 style="float: left;" class="col-1-20">
						<div>
							<input type="checkbox" name="attr_skillmanagement" class="ro-checkbox" /><span style="position: relative; font-size: 16px; color: black; background: white; border: 1px solid black; border-radius: 1px; padding-left: 3px; padding-right: 3px; left: -15px; bottom: 4px;"><b>+</b></span>
							<div class="ro-modal padl padr">
								<div class="border">
									<div class="ro-close-wrapper">
										<input type="checkbox" name="attr_skillmanagement" class="ro-close-checkbox" value="1" />
										<span class="ro-close-label"></span>
									</div>
									<div class="row ro-header padb">
										<div class="padt">
											<h3 class="col-1-2 border">
												<div class="row">
													<div class="col-1-12"><span></span></div>
													<div class="col-3-4 padr"><span>Skill</span></div>
													<div class="col-1-6 padr"><span>Cost</span></div>
												</div>
												<fieldset class="repeating_skilltemplate">
													<div class="row">
														<div class="col-1-12"><button style="background: white; border: 1px solid black; border-radius: 1px; padding-left: 5px; padding-right: 5px;" type="action" name="act_addskill"><span style="position: relative; font-size: 14px; color: black;"><b>+</b></span></button></div>
														<div class="col-3-4 padr tooltip">
															<input type="text" name="attr_label" value="" readonly />
															<h3><span class="tooltip"><textarea class="tooltip" name="attr_description" value="" readonly ></textarea></span></h3>
														</div>
														<div class="col-1-6 padr">
															<input style="text-align: center;" type="text" name="attr_cost" value="" placeholder="Cost" readonly />
															<input type="hidden" name="attr_costperlevel" value="" />
															<input type="hidden" name="attr_description" value="" />
															<input type="hidden" name="attr_specializations" value="" />
															<input type="hidden" name="attr_statmajor" value="" />
															<input type="hidden" name="attr_statminor" value="" />
														</div>
													</div>
												</fieldset>
											</h3>
										</div>
									</div>
								</div>
							</div>
						</div>
					</h5>
				</div>
				-->
			</div>
		</div>

		<div class="section-trappings header"><h3 class="center" style="color: white">Trappings</h3>
			<div class="padt padb">
				<div class="row">
					<div class="col-1-2 padr padl">
						<h4 class="border center">
							<span>Inventory
								<fieldset class="repeating_inventory">
									<div class="row">
										<div class="col-3-4 center"><input type="text" name="attr_name" placeholder="Item Name" value="" /></div>
										<div class="col-1-4 center"><input type="number" name="attr_quantity" value=1 /></div>
									</div>
								</fieldset>
							</span>
						</h4>
					</div>
					<div class="col-1-2 padr padl">
						<h4 class="border center">
							<span>Journal
								<div class="center"><textarea name="attr_journal" style="height:400px; width:98%;"></textarea></div>
							</span>
						</h4>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!--************************* Hidden Values *************************-->

	<div>
		<input type="hidden" name="attr_stat_cost_body" value=5 />
		<input type="hidden" name="attr_stat_cost_mind" value=5 />
		<input type="hidden" name="attr_stat_cost_soul" value=5 />
	</div>

	<!-- ************************ Roll Templates ************************ -->

	<rolltemplate class="sheet-rolltemplate-besmDefault">
		<div class="rt-card">
			<div class="rt-header{{#attack}} attack{{/attack}}{{#defense}}  defense{{/defense}}{{#rolls}} rolls{{/rolls}}{{#save}} save{{/save}}{{#deathsave}} deathsave{{/deathsave}}">
				<div class="sheet-rt-title"><b>{{title}}</b></div>
			</div>
			<div class="sheet-main-content">
				{{#attack}}
				<div class="rt-emote"><i>{{character_name}} attacks {{target_name}} with {{pronoun}} {{weapon_name}}!</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Maneuver</div>
					<div class="col-7-12 padr rt-value center">{{maneuver}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">ACV</div>
					<div class="col-7-12 padr rt-value center"><b>{{acv}}</b></div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Roll</div>
					<div class="col-7-12 padr rt-value center">{{roll}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Damage{{#stunonly}} (Stun){{/stunonly}}</div>
					{{#rollTotal() roll 2}}
					<div class="col-7-12 padr rt-value center">{{damage2}}</div>
					{{/rollTotal() roll 2}} {{#rollTotal() roll 3}}
					<div class="col-7-12 padr rt-value center">{{damage3}}</div>
					{{/rollTotal() roll 3}} {{#rollTotal() roll 4}}
					<div class="col-7-12 padr rt-value center">{{damage4}}</div>
					{{/rollTotal() roll 4}} {{#rollTotal() roll 5}}
					<div class="col-7-12 padr rt-value center">{{damage5}}</div>
					{{/rollTotal() roll 5}} {{#rollTotal() roll 6}}
					<div class="col-7-12 padr rt-value center">{{damage6}}</div>
					{{/rollTotal() roll 6}} {{#rollTotal() roll 7}}
					<div class="col-7-12 padr rt-value center">{{damage7}}</div>
					{{/rollTotal() roll 7}} {{#rollTotal() roll 8}}
					<div class="col-7-12 padr rt-value center">{{damage8}}</div>
					{{/rollTotal() roll 8}} {{#rollTotal() roll 9}}
					<div class="col-7-12 padr rt-value center">{{damage9}}</div>
					{{/rollTotal() roll 9}} {{#rollTotal() roll 10}}
					<div class="col-7-12 padr rt-value center">{{damage10}}</div>
					{{/rollTotal() roll 10}} {{#rollTotal() roll 11}}
					<div class="col-7-12 padr rt-value center">{{damage11}}</div>
					{{/rollTotal() roll 11}} {{#rollTotal() roll 12}}
					<div class="col-7-12 padr rt-value center">{{damage12}}</div>
					{{/rollTotal() roll 12}}
				</div>
				{{/attack}} {{#area}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Area</div>
					<div class="col-7-12 padr rt-value center">{{radius}} m radius</div>
				</div>
				{{/area}} {{#duration}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Duration</div>
					<div class="col-7-12 padr rt-value center">{{time}}</div>
				</div>
				{{/duration}} {{#range}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Range</div>
					<div class="col-7-12 padr rt-value center">{{range}}</div>
				</div>
				{{/range}} {{#autofire}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Autofire</div>
					{{#rollTotal() roll 2}}
					<div class="col-7-12 padr rt-value center">hits: {{hits2}}/{{rof}}</div>
					{{/rollTotal() roll 2}} {{#rollTotal() roll 3}}
					<div class="col-7-12 padr rt-value center">hits: {{hits3}}/{{rof}}</div>
					{{/rollTotal() roll 3}} {{#rollTotal() roll 4}}
					<div class="col-7-12 padr rt-value center">hits: {{hits4}}/{{rof}}</div>
					{{/rollTotal() roll 4}} {{#rollTotal() roll 5}}
					<div class="col-7-12 padr rt-value center">hits: {{hits5}}/{{rof}}</div>
					{{/rollTotal() roll 5}} {{#rollTotal() roll 6}}
					<div class="col-7-12 padr rt-value center">hits: {{hits6}}/{{rof}}</div>
					{{/rollTotal() roll 6}} {{#rollTotal() roll 7}}
					<div class="col-7-12 padr rt-value center">hits: {{hits7}}/{{rof}}</div>
					{{/rollTotal() roll 7}} {{#rollTotal() roll 8}}
					<div class="col-7-12 padr rt-value center">hits: {{hits8}}/{{rof}}</div>
					{{/rollTotal() roll 8}} {{#rollTotal() roll 9}}
					<div class="col-7-12 padr rt-value center">hits: {{hits9}}/{{rof}}</div>
					{{/rollTotal() roll 9}} {{#rollTotal() roll 10}}
					<div class="col-7-12 padr rt-value center">hits: {{hits10}}/{{rof}}</div>
					{{/rollTotal() roll 10}} {{#rollTotal() roll 11}}
					<div class="col-7-12 padr rt-value center">hits: {{hits11}}/{{rof}}</div>
					{{/rollTotal() roll 11}} {{#rollTotal() roll 12}}
					<div class="col-7-12 padr rt-value center">hits: {{hits12}}/{{rof}}</div>
					{{/rollTotal() roll 12}}
				</div>
				{{/autofire}} {{#blight}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Blight</div>
					<div class="col-7-12 padr rt-value center">Body vs TN{{blight}}</div>
				</div>
				{{/blight}} {{#contact}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Contact</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/contact}} {{#contagious}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Contagious</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/contagious}} {{#continuing}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Continuing Damage</div>
					{{#rollTotal() roll 2}}
					<div class="col-7-12 padr rt-value center">{{continuing2}}</div>
					{{/rollTotal() roll 2}} {{#rollTotal() roll 3}}
					<div class="col-7-12 padr rt-value center">{{continuing3}}</div>
					{{/rollTotal() roll 3}} {{#rollTotal() roll 4}}
					<div class="col-7-12 padr rt-value center">{{continuing4}}</div>
					{{/rollTotal() roll 4}} {{#rollTotal() roll 5}}
					<div class="col-7-12 padr rt-value center">{{continuing5}}</div>
					{{/rollTotal() roll 5}} {{#rollTotal() roll 6}}
					<div class="col-7-12 padr rt-value center">{{continuing6}}</div>
					{{/rollTotal() roll 6}} {{#rollTotal() roll 7}}
					<div class="col-7-12 padr rt-value center">{{continuing7}}</div>
					{{/rollTotal() roll 7}} {{#rollTotal() roll 8}}
					<div class="col-7-12 padr rt-value center">{{continuing8}}</div>
					{{/rollTotal() roll 8}} {{#rollTotal() roll 9}}
					<div class="col-7-12 padr rt-value center">{{continuing9}}</div>
					{{/rollTotal() roll 9}} {{#rollTotal() roll 10}}
					<div class="col-7-12 padr rt-value center">{{continuing10}}</div>
					{{/rollTotal() roll 10}} {{#rollTotal() roll 11}}
					<div class="col-7-12 padr rt-value center">{{continuing11}}</div>
					{{/rollTotal() roll 11}} {{#rollTotal() roll 12}}
					<div class="col-7-12 padr rt-value center">{{continuing12}}</div>
					{{/rollTotal() roll 12}}
				</div>
				{{/continuing}} {{#drain}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Drain</div>
					<div class="col-7-12 padr rt-value center">{{draintype}} -{{drain}}</div>
				</div>
				{{/drain}} {{#enervation}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Enervation</div>
					<div class="col-7-12 padr rt-value center">Energy -{{enervation}}</div>
				</div>
				{{/enervation}} {{#flare}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Flare ({{sense}})</div>
					<div class="col-7-12 padr rt-value center">{{obstacle}} Obstacle vs. TN 12</div>
				</div>
				{{/flare}} {{#flexible}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Flexible</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/flexible}} {{#helper}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Helper</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/helper}} {{#homing}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Homing</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/homing}} {{#incapacitating}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Incapacitating</div>
					<div class="col-7-12 padr rt-value center">{{obstacle}} vs. TN 12</div>
				</div>
				{{/incapacitating}} {{#inconspicuous}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Inconspicuous</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/inconspicuous}} {{#incurable}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Incurable</div>
					<div class="col-7-12 padr rt-value center">{{recovery}}</div>
				</div>
				{{/incurable}} {{#irritant}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Irritant</div>
					<div class="col-7-12 padr rt-value center">{{obstacle}} vs. TN 12</div>
				</div>
				{{/irritant}} {{#knockback}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Knockback</div>
					<div class="col-7-12 padr rt-value center">x{{kb}}</div>
				</div>
				{{/knockback}} {{#multidimensional}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Multidimensional</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/multidimensional}} {{#pen}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">{{pentype}}</div>
					<div class="col-7-12 padr rt-value center">{{penname}} -{{pen}}</div>
				</div>
				{{/pen}} {{#psychic}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Psychic</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/psychic}} {{#quake}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Quake</div>
					<div class="col-7-12 padr rt-value center">{{fissure}} m deep fissure</div>
				</div>
				{{/quake}} {{#reach}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Reach</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/reach}} {{#selective}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Selective</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/selective}} {{#spreading}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Spreading</div>
					<div class="col-7-12 padr rt-value center">{{spreading}} additional target</div>
				</div>
				{{/spreading}} {{#tangle}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Tangle</div>
					<div class="col-7-12 padr rt-value center">{{tangle}} HP</div>
				</div>
				{{/tangle}} {{#targeted}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Targeted</div>
					<div class="col-7-12 padr rt-value center">x2 vs {{hasenemy}}</div>
				</div>
				{{/targeted}} {{#vampiric}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Vampiric</div>
					<div class="col-7-12 padr rt-value center">{{stolenhealth}} health</div>
				</div>
				{{/vampiric}} {{#ammo}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Ammo</div>
					<div class="col-7-12 padr rt-value center">{{ammunition}}</div>
				</div>
				{{/ammo}} {{#backblast}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Backblast Affects</div>
					<div class="col-7-12 padr rt-value center">{{bystander}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Backblast Damage</div>
					{{#rollTotal() roll 2}}
					<div class="col-7-12 padr rt-value center">{{continuing2}}</div>
					{{/rollTotal() roll 2}} {{#rollTotal() roll 3}}
					<div class="col-7-12 padr rt-value center">{{continuing3}}</div>
					{{/rollTotal() roll 3}} {{#rollTotal() roll 4}}
					<div class="col-7-12 padr rt-value center">{{continuing4}}</div>
					{{/rollTotal() roll 4}} {{#rollTotal() roll 5}}
					<div class="col-7-12 padr rt-value center">{{continuing5}}</div>
					{{/rollTotal() roll 5}} {{#rollTotal() roll 6}}
					<div class="col-7-12 padr rt-value center">{{continuing6}}</div>
					{{/rollTotal() roll 6}} {{#rollTotal() roll 7}}
					<div class="col-7-12 padr rt-value center">{{continuing7}}</div>
					{{/rollTotal() roll 7}} {{#rollTotal() roll 8}}
					<div class="col-7-12 padr rt-value center">{{continuing8}}</div>
					{{/rollTotal() roll 8}} {{#rollTotal() roll 9}}
					<div class="col-7-12 padr rt-value center">{{continuing9}}</div>
					{{/rollTotal() roll 9}} {{#rollTotal() roll 10}}
					<div class="col-7-12 padr rt-value center">{{continuing10}}</div>
					{{/rollTotal() roll 10}} {{#rollTotal() roll 11}}
					<div class="col-7-12 padr rt-value center">{{continuing11}}</div>
					{{/rollTotal() roll 11}} {{#rollTotal() roll 12}}
					<div class="col-7-12 padr rt-value center">{{continuing12}}</div>
					{{/rollTotal() roll 12}}
				</div>
				{{/backblast}} {{#exclusive}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Exclusive</div>
					<div class="col-7-12 padr rt-value center">{{hasenemy}}</div>
				</div>
				{{/exclusive}} {{#fieldless}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Fieldless</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/fieldless}} {{#nostun}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">No Stun</div>
					<div class="col-7-12 padr rt-value center"></div>
				</div>
				{{/nostun}} {{#nonpenetrating}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Non-penetrating</div>
					<div class="col-7-12 padr rt-value center">AR +{{wontpenetrate}}</div>
				</div>
				{{/nonpenetrating}} {{#stoppable}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Stoppable</div>
					<div class="col-7-12 padr rt-value center">{{timetostop}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Stoppable</div>
					<div class="col-7-12 padr rt-value center">{{stopdamage}}</div>
				</div>
				{{/stoppable}} {{#toxic}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Toxic</div>
					<div class="col-7-12 padr rt-value center">{{escapable}}</div>
				</div>
				{{/toxic}} {{#unreliable}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Unreliable</div>
					<div class="col-7-12 padr rt-value center">Die roll of {{failure}}</div>
				</div>
				{{/unreliable}} {{#defense}}
				<div class="rt-emote"><i>{{character_name}} defends{{#target_name}} {{target_name}}{{/target_name}} with {{pronoun}} {{weapon_name}}!</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Maneuver</div>
					<div class="col-7-12 padr rt-value center">{{maneuver}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">DCV</div>
					<div class="col-7-12 padr rt-value center"><b>{{dcv}}</b></div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Roll</div>
					<div class="col-7-12 padr rt-value center">{{roll}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				{{#forcefield}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Forcefield</div>
					<div class="col-7-12 padr rt-value center">{{forcefield}}</div>
				</div>
				{{/forcefield}} {{#armor1}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Primary Armor</div>
					<div class="col-7-12 padr rt-value center">{{armor1}}</div>
				</div>
				{{/armor1}} {{#armor2}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Secondary Armor</div>
					<div class="col-7-12 padr rt-value center">{{armor2}}</div>
				</div>
				{{/armor2}} {{#armor3}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Tertiary Armor</div>
					<div class="col-7-12 padr rt-value center">{{armor3}}</div>
				</div>
				{{/armor3}} {{#mindshield}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Mind Shield</div>
					<div class="col-7-12 padr rt-value center">{{mindshield}}</div>
				</div>
				{{/mindshield}} {{#absorption1}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Absorption - Health</div>
					<div class="col-7-12 padr rt-value center">{{absorption1}}</div>
				</div>
				{{/absorption1}} {{#absorption2}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Absorption - Energy</div>
					<div class="col-7-12 padr rt-value center">{{absorption2}}</div>
				</div>
				{{/absorption2}} {{#conversion}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Conversion</div>
					<div class="col-7-12 padr rt-value center">{{conversion}}</div>
				</div>
				{{/conversion}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Shock Value</div>
					<div class="col-7-12 padr rt-value center">{{shockvalue}}</div>
				</div>
				{{/defense}} {{#doesnothing}}
				<div class="rt-emote"><i>{{character_name}} does nothing...</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Melee</div>
					<div class="col-7-12 padr rt-value center">TN 0</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Ranged</div>
					<div class="col-7-12 padr rt-value center">TN 12</div>
				</div>
				{{#forcefield}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Forcefield</div>
					<div class="col-7-12 padr rt-value center">{{forcefield}}</div>
				</div>
				{{/forcefield}} {{#shield}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Shield</div>
					<div class="col-7-12 padr rt-value center">{{shield}}</div>
				</div>
				{{/shield}} {{#armor1}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Primary Armor</div>
					<div class="col-7-12 padr rt-value center">{{armor1}}</div>
				</div>
				{{/armor1}} {{#armor2}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Secondary Armor</div>
					<div class="col-7-12 padr rt-value center">{{armor2}}</div>
				</div>
				{{/armor2}} {{#armor3}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Tertiary Armor</div>
					<div class="col-7-12 padr rt-value center">{{armor3}}</div>
				</div>
				{{/armor3}} {{#mindshield}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Mind Shield</div>
					<div class="col-7-12 padr rt-value center">{{mindshield}}</div>
				</div>
				{{/mindshield}} {{#absorption1}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Absorption - Health</div>
					<div class="col-7-12 padr rt-value center">{{absorption1}}</div>
				</div>
				{{/absorption1}} {{#absorption2}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Absorption - Energy</div>
					<div class="col-7-12 padr rt-value center">{{absorption2}}</div>
				</div>
				{{/absorption2}} {{#conversion}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Conversion</div>
					<div class="col-7-12 padr rt-value center">{{conversion}}</div>
				</div>
				{{/conversion}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Shock Value</div>
					<div class="col-7-12 padr rt-value center">{{shockvalue}}</div>
				</div>
				{{/doesnothing}} {{#twodsix}}
				<div class="rt-emote"><i>{{character_name}} rolls 2d6...</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				{{/twodsix}} {{#acvroll}}
				<div class="rt-emote"><i>{{character_name}} rolls {{pronoun}} ACV</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">ACV</div>
					<div class="col-7-12 padr rt-value center"><b>{{acv}}</b></div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Roll</div>
					<div class="col-7-12 padr rt-value center">{{roll}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				{{/acvroll}} {{#dcvroll}}
				<div class="rt-emote"><i>{{character_name}} rolls {{pronoun}} DCV</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">DCV</div>
					<div class="col-7-12 padr rt-value center"><b>{{dcv}}</b></div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Roll</div>
					<div class="col-7-12 padr rt-value center">{{roll}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				{{#forcefield}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Forcefield</div>
					<div class="col-7-12 padr rt-value center">{{forcefield}}</div>
				</div>
				{{/forcefield}} {{#armor1}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Primary Armor</div>
					<div class="col-7-12 padr rt-value center">{{armor1}}</div>
				</div>
				{{/armor1}} {{#armor2}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Secondary Armor</div>
					<div class="col-7-12 padr rt-value center">{{armor2}}</div>
				</div>
				{{/armor2}} {{#armor3}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Tertiary Armor</div>
					<div class="col-7-12 padr rt-value center">{{armor3}}</div>
				</div>
				{{/armor3}} {{#mindshield}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Mind Shield</div>
					<div class="col-7-12 padr rt-value center">{{mindshield}}</div>
				</div>
				{{/mindshield}} {{#absorption1}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Absorption - Health</div>
					<div class="col-7-12 padr rt-value center">{{absorption1}}</div>
				</div>
				{{/absorption1}} {{#absorption2}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Absorption - Energy</div>
					<div class="col-7-12 padr rt-value center">{{absorption2}}</div>
				</div>
				{{/absorption2}} {{#conversion}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Conversion</div>
					<div class="col-7-12 padr rt-value center">{{conversion}}</div>
				</div>
				{{/conversion}}
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Shock Value</div>
					<div class="col-7-12 padr rt-value center">{{shockvalue}}</div>
				</div>
				{{/dcvroll}} {{#initiative}}
				<div class="rt-emote"><i>{{character_name}} rolls {{pronoun}} initiative</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Base</div>
					<div class="col-7-12 padr rt-value center"><b>{{acv}}</b></div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Roll</div>
					<div class="col-7-12 padr rt-value center">{{roll}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				{{/initiative}} {{#perception}}
				<div class="rt-emote"><i>{{character_name}} rolls {{pronoun}} perception</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Base</div>
					<div class="col-7-12 padr rt-value center"><b>{{perception}}</b></div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Roll</div>
					<div class="col-7-12 padr rt-value center">{{roll}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				{{/perception}} {{#statroll}}
				<div class="rt-emote"><i>{{character_name}} rolls {{pronoun}} stat(s)</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Base</div>
					<div class="col-7-12 padr rt-value center"><b>{{base}}</b></div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Roll</div>
					<div class="col-7-12 padr rt-value center">{{roll}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				{{/statroll}} {{#skillroll}}
				<div class="rt-emote"><i>{{character_name}} rolls {{pronoun}} skill</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Base</div>
					<div class="col-7-12 padr rt-value center"><b>{{base}}</b></div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Roll</div>
					<div class="col-7-12 padr rt-value center">{{roll}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				{{/skillroll}} {{#attrroll}}
				<div class="rt-emote"><i>{{character_name}} rolls {{pronoun}} {{attribute}}</i></div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Base</div>
					<div class="col-7-12 padr rt-value center"><b>{{base}}</b></div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Roll</div>
					<div class="col-7-12 padr rt-value center">{{roll}}</div>
				</div>
				<div class="row">
					<div class="col-5-12 padl padr rt-key">Total</div>
					<div class="col-7-12 padr rt-value center">{{total}}</div>
				</div>
				{{/attrroll}}
			</div>
		</div>
	</rolltemplate>

	<!-- ********************* Sheet Worker Scripts ********************* -->

	<script type="text/worker">
		/** Global Variables **/

		/**** User Configurable Template Variables ****/
		const global_templates_race_default = "Human";
		const global_templates_class_default = "None";
		const global_templates_skills_json = "{\"template\":[{\"name\":\"Acrobatics\",\"description\":\"The ability to perform feats of agility with minimal chance for injury. Includes jumping, flipping, contorting, and reacting quickly.\",\"specializations\":\"Balance, Flexibility, Jumps, Tumbling\",\"statallaspect\":[\"body\"],\"statmajor\":[\"agi\"],\"cost\":[3,3,3,2,2,3,2,1,2,2,3,2,2,2,2,2,3,2,2,3,1,1,2,3,2,1,2,2,1,2]},{\"name\":\"Animal Training\",\"description\":\"The ability to teach and train animals with an intellect above that of instinctive insects. An animal usually has a Mind Stat of 1-2.\",\"specializations\":\"Any single animal such as bears, dogs, dolphins, horses, raccoons, etc.\",\"statallaspect\":[\"soul\"],\"statmajor\":[\"awa\"],\"cost\":[2,2,2,1,1,1,1,2,1,2,3,2,2,2,1,1,1,2,1,1,1,2,1,2,2,1,2,1,2,3]},{\"name\":\"Architecture\",\"description\":\"Knowledge of construction methods, architectural drafting, etc. A successful use of this Skill can also find weak points in constructions or help in locating old structural plans.\",\"specializations\":\"Aquatic, Bridges, Fortifications, Small Buildings, Skyscrapers\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"rea\"],\"cost\":[1,1,2,1,1,1,1,1,1,2,1,1,1,1,2,1,1,2,1,1,1,2,1,2,2,3,2,2,1,1]},{\"name\":\"Area Knowledge\",\"description\":\"Knowledge of the geography and people of a single area (choose one area) and a specific locale within it. The smaller the area, the more detailed and extensive the character’s knowledge. This Skill may be assigned multiple times to indicate knowledge of several areas.\",\"specializations\":\"One specific locale (city, forest, sea, desert, mountain) within the area\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[2,2,3,2,3,2,2,2,2,2,2,2,2,3,2,1,2,3,1,3,2,3,2,2,1,2,1,1,2,1]},{\"name\":\"Artisan\",\"description\":\"This Skill represents a character’s ability to workwith a variety of materials to repair or produce useful oraesthetically pleasing objects (not electronic or mechanical).\",\"specializations\":\"Bowyer / Fletcher, Blacksmithy, Carpentry, Enchanting Objects, Leatherworking, Metalworking, Plumbing, Pottery, Tailoring, Woodworking\",\"statallaspect\":[\"body\",\"mind\"],\"statmajor\":[\"dex\",\"cre\"],\"cost\":[1,1,1,1,1,1,1,2,1,2,2,1,1,1,1,1,1,2,1,1,1,2,2,2,2,2,2,2,2,2]},{\"name\":\"Biological Sciences\",\"description\":\"This diverse field covers scientific knowledge of howliving things survive, thrive, and function.\",\"specializations\":\"Astrobiology, Bacteria/Viruses, Bioengineering, Botany, Genetics, Physiology, Zoology\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[2,2,2,2,2,2,2,1,3,2,3,1,1,1,3,3,1,3,2,2,1,1,1,1,1,1,1,1,1,1]},{\"name\":\"Boating\",\"description\":\"The ability to safely operate a watercraft.\",\"specializations\":\"Hovercraft, Hydrofoils, Large Ships, Small Boats, Submarines\",\"statallaspect\":[\"body\",\"mind\"],\"statmajor\":[\"str\",\"per\"],\"cost\":[2,2,1,1,2,1,1,1,2,1,1,2,2,2,2,2,2,1,1,1,2,2,3,1,2,1,2,1,1,1]},{\"name\":\"Burglary\",\"description\":\"The ability to open locks, quietly cut glass, hot-wire car ignitions, etc. The ability does not cover disarming electronic security systems, which is handled by Electronics (Security) Skill.\",\"specializations\":\"Breaking-and-Entering, Disarming Physical Traps, Hot-Wiring, Safe Cracking\",\"statallaspect\":[\"body\",\"mind\"],\"statmajor\":[\"dex\",\"per\"],\"cost\":[2,2,2,2,3,2,2,1,2,1,2,2,2,2,2,1,2,2,2,2,2,1,3,2,2,1,2,2,1,2]},{\"name\":\"Business\",\"description\":\"The ability to organise, run, and understand part or all of a business organisation (including governments, non-profits, and association). This Skill is also useful for locating new employees.\",\"specializations\":\"Accounting, Administration, Economics, Executive, Fraud, Government, Management, Marketing, Negotiating, Sales\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[1,1,1,1,1,1,1,2,1,2,1,1,2,1,2,1,2,1,1,2,1,2,1,1,1,3,1,1,1,1]},{\"name\":\"Civilisation\",\"description\":\"This reflects knowledge of the history, religion, ethics, social structure, and lifestyle of a distinct culture or population. Select one civilisation culture for each Skill Level – one of which will also be the focus or Specialisation of the knowledge.\",\"specializations\":\"One Specific Culture or Population\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[2,1,1,1,1,1,1,1,2,2,3,3,2,1,2,1,2,2,2,3,2,3,1,1,1,2,1,2,1,1]},{\"name\":\"Climbing\",\"description\":\"The ability to scale vertical surfaces with or without the use of dedicated climbing equipment.\",\"specializations\":\"Natural Surfaces, Poles, Ropes, Vegetation, Walls\",\"statallaspect\":[\"body\"],\"statmajor\":[\"str\"],\"cost\":[2,2,2,2,2,2,2,1,2,1,2,2,2,2,2,1,1,2,2,1,2,1,3,1,1,1,1,2,2,1]},{\"name\":\"Computers\",\"description\":\"Practical and theoretical knowledge of computer systems and their general use. Computer engineering (hardware) is covered by Electronics.\",\"specializations\":\"Artificial Intelligence, Cryptography, Databases, Electronic Warfare, Intrusion/Security, Networks, Programming\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"tec\"],\"cost\":[2,3,1,3,3,3,2,2,3,2,0,0,0,2,3,3,3,2,2,2,2,0,0,0,0,0,0,0,0,0]},{\"name\":\"Controlled Breathing\",\"description\":\"The ability to control respiratory functions in order to maximise breathing efficiency or to perform tricks such as “playing dead.”\",\"specializations\":\"Calm, Cyclic Breathing, Holding Breath, Slow Heart Rate\",\"statallaspect\":[\"body\",\"soul\"],\"statmajor\":[\"con\",\"wil\"],\"cost\":[1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1]},{\"name\":\"Cultural Arts\",\"description\":\"Knowledge of aspects of human culture (or another species’ culture).\",\"specializations\":\"Gastronomy, History, Literature, Mythology, Nobility, Philosophy, Rare Object Appraisal, Urban Legends\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[1,1,1,1,1,1,2,2,1,2,2,1,1,2,1,1,2,1,2,1,1,2,1,2,2,2,1,2,1,1]},{\"name\":\"Demolitions\",\"description\":\"The ability to set explosive charges without getting hurt in the process or inflicting undesired collateral damage. It is also used for deactivating explosives set by someone else.\",\"specializations\":\"Artificial Structures, Bomb Disposal, Natural Structures, Safe Cracking, Underwater\",\"statallaspect\":[\"body\",\"mind\"],\"statmajor\":[\"dex\",\"per\"],\"cost\":[2,3,2,1,2,3,1,1,2,1,1,1,1,1,2,1,3,2,1,1,2,1,2,1,1,1,1,1,0,2]},{\"name\":\"Disguise\",\"description\":\"The ability to change one’s personal appearance in an attempt to deceive others.\",\"specializations\":\"Costume, Impersonation, Make-up, Prosthetics\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"cre\"],\"cost\":[2,2,2,2,2,3,2,2,3,2,1,2,2,2,2,1,1,1,1,3,2,1,2,2,2,1,2,2,1,2]},{\"name\":\"Domestic Arts\",\"description\":\"The ability to efficiently and effectively organise and run a domestic household.\",\"specializations\":\"Childrearing, Cleaning, Cooking, Decorating, Gardening, Home Budgeting\",\"statallaspect\":[\"mind\",\"soul\"],\"statmajor\":[\"rea\",\"awa\"],\"cost\":[1,1,1,1,1,2,3,3,1,1,1,1,2,1,1,1,1,2,2,1,1,2,2,2,1,2,2,2,3,2]},{\"name\":\"Driving\",\"description\":\"The ability to operate a powered ground vehicle. Skill checks are only necessary in difficult situations such as performing vehicular stunts, avoiding hazards, etc.\",\"specializations\":\"Armored Fighting Vehicle (tanks, APCs, etc.), Bicycle, Big Rig (large tractor/trailer trucks), Bus, Car, Giant Robot, Motorcycle, Small Truck (vans, pick-ups, hi-cubes), Teamster (Draft Animals), Walker\",\"statallaspect\":[\"body\",\"mind\"],\"statmajor\":[\"dex\",\"per\"],\"cost\":[2,3,1,2,3,2,2,2,2,2,0,0,0,2,2,2,3,2,2,2,3,1,1,1,1,1,1,3,2,1]},{\"name\":\"Engineering\",\"description\":\"The use of scientific principals and experimental data to design and build equipment, structures, and other useful devices.\",\"specializations\":\"Aerospace, Agricultural, Biomedical, Chemical, Civil, Computer, Electrical, Environmental, Mechanical, Mining\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"rea\"],\"cost\":[2,1,2,2,1,1,1,1,2,2,2,2,1,1,3,3,3,2,1,2,2,2,1,1,2,3,1,3,1,1]},{\"name\":\"Environmental Sciences\",\"description\":\"These scientific fields focus on the environment, with particular regard to the historical and current activities of sentient beings and their important impact on biodiversity and sustainability.\",\"specializations\":\"Climatology, Ecology, Geology, Geography, Geophysics, Hydrology, Meteorology, Oceanography\",\"statallaspect\":[\"soul\"],\"statmajor\":[\"int\"],\"cost\":[1,1,1,1,2,1,2,1,2,2,3,2,1,1,2,3,2,3,2,2,1,2,1,1,2,2,1,1,1,1]},{\"name\":\"Electronics\",\"description\":\"The ability to maintain, repair, build, modify (and at high Levels, design) electronic equipment.\",\"specializations\":\"Communications, Computers, Consumer Electronics, Robotics, Security, Sensors\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"rea\"],\"cost\":[2,2,1,2,2,2,1,1,2,2,1,1,1,1,3,3,3,2,2,2,2,0,0,0,0,0,0,0,0,0]},{\"name\":\"Empathy\",\"description\":\"The ability to understand, detect, and interpret the emotional state of people nearby, without having their experiences communicated explicitly.\",\"specializations\":\"Body Language, Calming, Interpreting Words, Intuition, Lie Detection, Listening\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"awa\"],\"cost\":[1,1,2,2,2,1,3,3,1,3,3,2,2,2,2,1,2,3,2,2,1,2,2,1,1,2,1,2,2,1]},{\"name\":\"Etiquette\",\"description\":\"The knowledge of the customary codes for polite, proper, and inoffensive behaviour in social settings.\",\"specializations\":\"Alien, Lower Class, Middle Class, Upper Class\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"per\"],\"cost\":[1,1,1,1,1,1,2,2,1,1,2,2,1,1,1,1,2,1,1,1,1,2,1,3,2,2,1,2,1,1]},{\"name\":\"Forgery\",\"description\":\"The ability to realistically counterfeit documents and papers. This Skill can be used in conjunction with the Computers Skill.\",\"specializations\":\"Artwork, Electronic Documents, Financial Notes, Handwriting, Paper Documents, Physical Objects\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"rea\"],\"cost\":[1,1,1,1,2,1,2,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1]},{\"name\":\"Gaming\",\"description\":\"The ability to comprehend and play various games and simulations well.\",\"specializations\":\"Board Games, Card Games, Computer Games, Gambling, Military Simulations, Role-Playing Games\",\"statallaspect\":[\"mind\",\"soul\"],\"statmajor\":[\"int\",\"awa\"],\"cost\":[1,1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,3]},{\"name\":\"Interrogation\",\"description\":\"The ability to convince someone to provide specific information against their will. Interrogation can also be used to help withhold such information when being questioned by an enemy.\",\"specializations\":\"Business, Drugs, Physical, Psychological, Spiritual\",\"statallaspect\":[\"mind\",\"soul\"],\"statmajor\":[\"per\",\"com\"],\"cost\":[2,2,2,2,3,2,2,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,2,2,2,1,2,2,1,2]},{\"name\":\"Intimidation\",\"description\":\"The ability to convincingly project a “tough guy” image. A successful check means someone witnessing your performance is convinced you mean any threats you make. How they react after that will depend on how tough they are themselves in relation to the kind of threat you present – they may respond with respect, fear, hatred, or amusement.\",\"specializations\":\"Business, Emotional, Political, Physical, Spiritual, Street\",\"statallaspect\":[\"soul\"],\"statmajor\":[\"com\"],\"cost\":[2,3,2,3,2,2,2,1,2,3,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,3,2,2,3,2]},{\"name\":\"Languages\",\"description\":\"Reflects an aptitude for languages and their historical usage. Additionally, a character will be able to speak and  write: 1 (Level 1), 2 (Level 2), 3-4 (Level 3), 5-7 (Level4), 8-11 (Level 5), or 12-16 (Level 6) foreign languages. Multiple Specialisations will be listed for Languages - the first is the character’s native language (a free Specialisation), while the others are foreign languages.\",\"specializations\":\"Any one language, Braille, Code Language, Lip Reading, Sign Language\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[1,1,1,2,1,1,1,2,1,3,2,2,1,1,1,1,1,1,3,1,1,2,2,1,1,2,1,1,1,1]},{\"name\":\"Law\",\"description\":\"Knowledge of legal procedure and practice. In addition to lawyers, many police officers, politicians, and even superbeings have the Law Skill at Level 1 or 2. All Specialisations, except International, are specific to one country or region only (for example, “American Criminal Law” or “Japanese Family Law”).\",\"specializations\":\"Civil, Criminal, Customs, Family, International, Political, Real Estate\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[1,1,1,1,3,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,2,1,1,1,2]},{\"name\":\"Leadership\",\"description\":\"The talent of having inspirational visions and goals, and communicating them effectively to others. The objective is to motivate and rally others to adopt and work towards those objectives as well.\",\"specializations\":\"Business, Co-operative, Political, Spiritual, Strategic, Transformational\",\"statallaspect\":[\"soul\"],\"statmajor\":[\"com\"],\"cost\":[1,2,2,2,2,1,2,1,2,3,1,1,2,2,2,2,3,2,2,2,2,3,2,3,2,2,2,2,3,3]},{\"name\":\"Listening\",\"description\":\"The ability to listen attentively or to perceive unusual or out of place noises.\",\"specializations\":\"Background Noise, Discrimination, Eavesdropping, Spiritual\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"per\"],\"cost\":[2,1,3,2,2,2,2,1,2,2,2,2,2,2,2,1,1,2,2,2,2,1,2,1,1,1,2,2,1,2]},{\"name\":\"Mechanics\",\"description\":\"The ability to maintain, repair, or build mechanical and electro-mechanical devices. This also includes knowledge of tool use, welding, etc. Armourer applies to heavy vehicle-mounted weapons while Gunsmith covers personal weaponry. Use Artisan for archaic weapons.\",\"specializations\":\"Aeronautical, Armourer, Automotive, Gunsmith, Locksmith, Nanotechology, Traps\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"rea\"],\"cost\":[2,2,1,1,2,1,1,2,2,2,1,1,1,2,2,2,3,3,2,2,2,2,1,1,1,3,1,3,0,1]},{\"name\":\"Medical\",\"description\":\"Knowledge of how to heal the body using a variety of techniques. A typical general practitioner would Specialise in Diagnosis, while most police officers or paramedics Specialise in Emergency Response.\",\"specializations\":\"Chiropractic, Dentistry, Diagnosis, Emergency Response, Family Practice, Nursing, Obstetrics, Pathology, Pharmacy, Surgery, Veterinary\",\"statallaspect\":[\"body\",\"mind\"],\"statmajor\":[\"dex\",\"rea\"],\"cost\":[2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,3,2,2,2,3,2,2,2,2,3,2,1,2]},{\"name\":\"Military Sciences\",\"description\":\"The character has military-style tactical, staff, or leadership training. In addition, SWAT (or other tactical police units) often include individuals who pick up similar Skills (and often recruit ex-military personnel).\",\"specializations\":\"Hardware Recognition, Intelligence Analysis, Logistics, Strategy, Tactics, Teamwork\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[2,2,2,2,2,1,1,1,2,1,2,3,2,1,2,2,3,2,2,2,3,2,2,2,2,1,2,2,1,2]},{\"name\":\"Naturopathy\",\"description\":\"The knowledge of alternative medical practices that emphasise prevention, treatment, and optimal health by encouraging the body’s self-healing process.\",\"specializations\":\"Acupuncture, Aromatherapy, Herbalism, Homoeopathy, Massage Therapy, Reflexology\",\"statallaspect\":[\"mind\",\"soul\"],\"statmajor\":[\"per\",\"awa\"],\"cost\":[1,1,1,1,1,1,1,2,1,3,3,2,2,1,2,1,1,2,2,1,1,1,1,1,2,1,1,1,3,2]},{\"name\":\"Navigation\",\"description\":\"The ability to read maps or use specialised navigation equipment (including electronic sensors, if appropriate to the setting). The Navigation Skill will help a character find the fastest/safest route to a destination. The commander of a large vessel is usually a skilled navigator, even if they have only slight knowledge of Boating or Piloting.\",\"specializations\":\"Air, Highway, Sea, Space, Undersea, Urban, Wilderness\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,2,3,2,2,3,2,2,3,2,2,2,2,2,2,2]},{\"name\":\"Occult\",\"description\":\"Knowledge of the arcane and mystical arts, and their applications in both historical and modern society.\",\"specializations\":\"Astrology, Augury, Channelling, Dream Interpretation, Numerology, Rituals, Spellcraft, Spirits, Tarot, Voodoo, Witchcraft\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[2,1,1,3,1,1,1,1,2,3,3,3,2,3,1,1,1,1,1,1,1,1,1,2,1,1,2,2,2,2]},{\"name\":\"Occupation\",\"description\":\"The skills, talent, activities, and experience required to carry out one specific occupation that may have interdisciplinary applications not adequately addressed by an alternate single Skill.\",\"specializations\":\"One Specific Occupation\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[1,1,1,1,1,2,1,2,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1]},{\"name\":\"Performing Arts\",\"description\":\"The ability to perform well before an audience of any size and composition, and to evoke an emotional response through the art form.\",\"specializations\":\"Comedy, Dance, Drama, Musical Instrument, Public Speaking, Singing\",\"statallaspect\":[\"body\",\"mind\",\"soul\"],\"statmajor\":[\"agi\",\"cre\",\"chr\"],\"cost\":[1,1,2,1,2,2,2,2,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1]},{\"name\":\"Persuasion\",\"description\":\"The ability to convince people to see new perspectives, consider other alternatives, change their minds, make different decisions, and even modify their actions as a result of the persuasion.\",\"specializations\":\"Bluffing, Bribery, Diplomacy, Emotional, Fast Talking, Hypnosis, Logic, Mediation, Rhetoric, Social Networking, Storytelling\",\"statallaspect\":[\"soul\"],\"statmajor\":[\"chr\"],\"cost\":[3,3,2,1,2,2,3,2,3,2,2,2,2,2,2,2,2,2,2,3,2,2,3,2,2,2,2,2,2,2]},{\"name\":\"Physical Sciences\",\"description\":\"Scientific training in the way the physical realm functions and manifests itself as reality, including the necessary background knowledge concerning universal laws and constants.\",\"specializations\":\"Alchemy, Astronomy, Biochemistry, Chemistry, Mathematics, Physics\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[2,1,1,1,2,2,1,1,2,2,2,1,1,1,1,3,2,2,2,2,1,1,1,1,1,2,1,2,1,1]},{\"name\":\"Piloting\",\"description\":\"The ability to operate atmospheric or space vehicles, as well as walking or transformable giant robots with familiar aircraft-style control layouts – even if such mecha are restricted to ground movement only. Skill checks are normally only necessary during play when performing an unusual manoeuvre, avoiding a hazard, piloting an unfamiliar aircraft, etc.\",\"specializations\":\"Giant Robot, Heavy Airplane (usually multi-engine), Helicopter, Jet Fighter, Light Airplane (usually single-engine), Lighter than Air Craft, Spacecraft\",\"statallaspect\":[\"body\",\"mind\"],\"statmajor\":[\"dex\",\"per\"],\"cost\":[2,2,1,2,2,2,1,1,2,1,1,1,0,1,2,2,2,2,2,3,3,0,0,0,0,0,0,3,0,0]},{\"name\":\"Poisons\",\"description\":\"The ability to recognise, concoct, apply, and neutralise a variety of poisons and toxins. For additional information on poisons, see page 89.\",\"specializations\":\"Alien, Natural, Synthetic, Technological\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"tec\"],\"cost\":[1,1,1,1,1,1,1,1,2,1,2,2,2,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,1,1]},{\"name\":\"Police Sciences\",\"description\":\"This is the science and methodology behind detective work. Ballistics is the study of the wounds inflicted by projectiles; criminology focuses on studies of criminal behaviour and strategies; forensics covers evidence gathering (including hair-and-fibre, fingerprint and DNA-based identification techniques).\",\"specializations\":\"Ballistics, Community Policing, Criminology, Forensics, International\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"per\"],\"cost\":[2,2,1,2,3,1,1,1,2,1,1,1,1,2,2,2,2,1,1,1,1,1,0,0,0,1,0,1,0,1]},{\"name\":\"Power Lifting\",\"description\":\"The ability to perform feats of strength with minimal chance for injury. Includes lifting or pushing heavy objects, stopping objects in motion, and supporting large masses for extended periods of time. This Skill is independent of the Superstrength Attribute (BESM4, page 124), and does not reflect strength directly. Rather, it represents a character’s efficiency and effectiveness of using the strength that they possess.\",\"specializations\":\"Bulky Objects, Free Weights, Humans, Moving Objects, Small Objects (Hand-Held)\",\"statallaspect\":[\"body\"],\"statmajor\":[\"str\"],\"cost\":[2,3,2,2,2,3,1,1,2,1,1,2,2,2,2,2,1,1,1,2,2,1,2,2,1,1,2,2,3,2]},{\"name\":\"Religion\",\"description\":\"The understanding and knowledge concerning the nature of a god or gods, including ceremonies and rituals, ethical standards, and historical origins.\",\"specializations\":\"Academic, Dogma, Congregational, Context, Enlightenment, Guidance, Interpretation, Scripture\",\"statallaspect\":[\"mind\",\"soul\"],\"statmajor\":[\"int\",\"wil\"],\"cost\":[1,1,1,3,1,1,1,1,2,3,2,2,2,2,1,1,1,1,1,2,1,2,1,2,3,1,2,1,1,1]},{\"name\":\"Riding\",\"description\":\"This is the knowledge of how to care for a riding beast, how to saddle, mount, and dismount the animal, how to get it to perform difficult or dangerous manoeuvres safely and without balking, and how to best pace it for longdistance rides.\",\"specializations\":\"By species (Camel, Horse, Tiger, etc.)\",\"statallaspect\":[\"body\",\"mind\",\"soul\"],\"statmajor\":[\"agi\",\"per\",\"awa\"],\"cost\":[1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,2,1,1,1,2,2,3,2,1,3,1,2,3]},{\"name\":\"Search\",\"description\":\"This Skill allows the character to find secret, hidden, or concealed objects.\",\"specializations\":\"Compartments, Detail Work, Electronics, Irregularities\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"per\"],\"cost\":[2,2,2,2,3,1,1,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2]},{\"name\":\"Seduction\",\"description\":\"A character with this Skill is adept at exploiting their sex appeal. A successful Skill check will convince another person that the character is genuinely interested in them. Whether or not the subject responds will depend on their own romantic inclinations and sexual preferences.\",\"specializations\":\"Emotional, Mental, Physical, Political, Social, Spiritual, Verbal\",\"statallaspect\":[\"soul\"],\"statmajor\":[\"chr\"],\"cost\":[2,2,2,2,2,1,3,2,2,3,2,2,2,2,2,2,3,2,3,2,2,2,3,2,2,2,2,2,2,3]},{\"name\":\"Sleight of Hand\",\"description\":\"A character with this Skill (also known as “prestidigitation”) has superior manual dexterity, greater than that suggested by their Body Stat. This includes the ability to perform “magic” tricks, palm small objects, cheat at cards, plant an item on someone, etc.\",\"specializations\":\"Card Sharking, Lock Picking, Pick Pocketing, Stage Magic\",\"statallaspect\":[\"body\"],\"statmajor\":[\"dex\"],\"cost\":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1,1,1,2,1,2,1,1,1,1,1,1,2]},{\"name\":\"Social Sciences\",\"description\":\"Understanding of the way populations and individual people function in and contribute to society, as well as larger societal behavioural patterns.\",\"specializations\":\"Archaeology, Anthropology, Communication, Education, Politics, Psychology, Social Work, Sociology\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"int\"],\"cost\":[1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,2,2,3,1,1,2,1,1,1,1,1,2,1,1]},{\"name\":\"Sports\",\"description\":\"The ability to play well with others in a team or individual sporting event with specialised rules, in a manner that minimises associated injury risks.\",\"specializations\":\"One specific sport\",\"statallaspect\":[\"body\",\"mind\",\"soul\"],\"statmajor\":[\"agi\",\"per\",\"wil\"],\"cost\":[1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,2,1,1,1,1,1]},{\"name\":\"Stealth\",\"description\":\"The ability to disguise objects or people so that they blend into their surroundings. This also includes the ability to conceal small objects on one’s person and the ability to move silently.\",\"specializations\":\"Camouflage, Concealment, Silent Movement\",\"statallaspect\":[\"body\"],\"statmajor\":[\"agi\"],\"cost\":[3,2,3,2,2,2,2,2,3,2,2,2,3,3,2,2,2,3,2,2,2,2,2,2,2,1,2,2,2,2]},{\"name\":\"Street Sense\",\"description\":\"The knowledge of street activity within a particular urban region or city. This is a vital survival Skill for a person on the streets.\",\"specializations\":\"Gang Activity, Influential Individuals, Territorial Divisions (all by region)\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"per\"],\"cost\":[2,2,1,2,3,2,2,2,3,2,1,1,2,2,3,2,2,3,2,2,2,1,2,2,2,2,3,1,1,2]},{\"name\":\"Survival\",\"description\":\"The ability to find food and shelter in the outdoors, to avoid natural hazards, and to identify edible and useful wild plants and animals. This Skill is often a learned area of expertise for more advanced cultures, but a natural way of life for more primitive ones.\",\"specializations\":\"Aquatic, Arctic, Desert, Dimensional, Forest, Jungle, Mountain, Plains\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"per\"],\"cost\":[2,2,3,2,2,2,1,1,2,2,2,2,3,1,1,1,1,3,1,1,2,2,3,2,2,2,2,2,3,2]},{\"name\":\"Swimming\",\"description\":\"The character is skilled at swimming or diving. The GM may assume that any character in a modern setting can swim even without this Skill. A swimmer can usually move at a speed equal to their Body Stat in kilometres per hour for short distances.\",\"specializations\":\"Aquabatics, Competition, Deep-Sea Diving, Free Diving, Recreational, Scuba, Snorkelling\",\"statallaspect\":[\"body\"],\"statmajor\":[\"agi\"],\"cost\":[1,1,2,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1]},{\"name\":\"Urban Tracking\",\"description\":\"Urban Tracking is the ability to “shadow” someone through an industrialised, populated area or, alternatively, to find certain people in a particular sub-culture or environment by asking the right questions.\",\"specializations\":\"Academic, Corporate, Political, Residential, Underworld\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"per\"],\"cost\":[2,1,2,3,3,1,2,1,2,3,1,1,1,2,3,1,2,2,1,1,2,1,1,1,1,2,2,1,0,2]},{\"name\":\"Visual Arts\",\"description\":\"The ability to produce a work of fine or commercial art in a particular visual field.\",\"specializations\":\"Animation, Carving, Drawing, Flower Arranging, Painting, Photography, Sculpting, Video\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"cre\"],\"cost\":[1,1,1,1,1,1,2,2,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1]},{\"name\":\"Wilderness Tracking\",\"description\":\"The ability to successfully trail or track someone or something while outdoors in a rural or wilderness setting.\",\"specializations\":\"Aquatic, Arctic, Desert, Forest, Jungle, Mountain, Plains\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"per\"],\"cost\":[1,1,2,1,1,1,1,1,1,1,2,2,2,1,1,1,1,2,1,1,2,2,3,2,2,1,2,2,3,2]},{\"name\":\"Writing\",\"description\":\"The ability to communicate ideas or emotions in a written work, though a person without this Skill may still know how to read and write.\",\"specializations\":\"Academic, Fiction, Journalistic, Poetic, Religious, Technical\",\"statallaspect\":[\"mind\"],\"statmajor\":[\"cre\"],\"cost\":[1,1,1,1,1,1,2,2,1,2,2,1,1,2,1,1,1,1,1,1,1,2,1,1,1,2,1,2,1,1]}]}";
		const global_templates_game_genre = 0;
		
		/**** DO NOT CHANGE THESE VARIABLES ****/
		const global_templates_size_json = "{\"template\":[{\"name\":\"Point\",\"rank\":\"-10\",\"height\":\"100-400μm\",\"mass\":\"1-40 μg\",\"lift\":0.0000002,\"strdmg\":-100,\"ar\":0,\"extradmg\":100,\"rnghitdef\":20,\"rngspd\":0.001},{\"name\":\"Mote\",\"rank\":\"-9\",\"height\":\"500-900μm\",\"mass\":\"50-500 μg\",\"lift\":0.000001,\"strdmg\":-90,\"ar\":0,\"extradmg\":90,\"rnghitdef\":18,\"rngspd\":0.002},{\"name\":\"Speck\",\"rank\":\"-8\",\"height\":\"1-4 mm\",\"mass\":\"1-5 mg\",\"lift\":0.000004,\"strdmg\":-80,\"ar\":0,\"extradmg\":80,\"rnghitdef\":16,\"rngspd\":0.004},{\"name\":\"Minute\",\"rank\":\"-7\",\"height\":\"5-9 mm\",\"mass\":\"6-40 mg\",\"lift\":0.00002,\"strdmg\":-70,\"ar\":0,\"extradmg\":70,\"rnghitdef\":14,\"rngspd\":0.008},{\"name\":\"Wee\",\"rank\":\"-6\",\"height\":\"1-2 cm\",\"mass\":\"50-500 mg\",\"lift\":0.0001,\"strdmg\":-60,\"ar\":0,\"extradmg\":60,\"rnghitdef\":12,\"rngspd\":0.01667},{\"name\":\"Teeny\",\"rank\":\"-5\",\"height\":\"3-4 cm\",\"mass\":\"1-5 g\",\"lift\":0.0004,\"strdmg\":-50,\"ar\":0,\"extradmg\":50,\"rnghitdef\":10,\"rngspd\":0.0333},{\"name\":\"Fine\",\"rank\":\"-4\",\"height\":\"5-9 cm\",\"mass\":\"6-30 g\",\"lift\":0.002,\"strdmg\":-40,\"ar\":0,\"extradmg\":40,\"rnghitdef\":8,\"rngspd\":0.06667},{\"name\":\"Diminutive\",\"rank\":\"-3\",\"height\":\"10-24 cm\",\"mass\":\"50-300 g\",\"lift\":0.01,\"strdmg\":-30,\"ar\":0,\"extradmg\":30,\"rnghitdef\":6,\"rngspd\":0.125},{\"name\":\"Tiny\",\"rank\":\"-2\",\"height\":\"25-49 cm\",\"mass\":\"500 g - 2 kg\",\"lift\":0.04,\"strdmg\":-20,\"ar\":0,\"extradmg\":20,\"rnghitdef\":4,\"rngspd\":0.25},{\"name\":\"Small\",\"rank\":\"-1\",\"height\":\"50-99 cm\",\"mass\":\"6-20 kg\",\"lift\":0.2,\"strdmg\":-10,\"ar\":0,\"extradmg\":10,\"rnghitdef\":2,\"rngspd\":0.5},{\"name\":\"Medium\",\"rank\":\"0\",\"height\":\"1-2 m\",\"mass\":\"50-150 kg\",\"lift\":0,\"strdmg\":0,\"ar\":0,\"extradmg\":0,\"rnghitdef\":0,\"rngspd\":0},{\"name\":\"Large\",\"rank\":\"1\",\"height\":\"3-4 m\",\"mass\":\"200-1,200 kg\",\"lift\":5,\"strdmg\":10,\"ar\":10,\"extradmg\":0,\"rnghitdef\":-2,\"rngspd\":2},{\"name\":\"Huge\",\"rank\":\"2\",\"height\":\"5-8 m\",\"mass\":\"1.5-8 tonnes\",\"lift\":25,\"strdmg\":20,\"ar\":20,\"extradmg\":0,\"rnghitdef\":-4,\"rngspd\":4},{\"name\":\"Mammoth\",\"rank\":\"3\",\"height\":\"9-15 m\",\"mass\":\"10-60 tonnes\",\"lift\":100,\"strdmg\":30,\"ar\":30,\"extradmg\":0,\"rnghitdef\":-6,\"rngspd\":8},{\"name\":\"Gigantic\",\"rank\":\"4\",\"height\":\"16-30 m\",\"mass\":\"75-500 tonnes\",\"lift\":500,\"strdmg\":40,\"ar\":40,\"extradmg\":0,\"rnghitdef\":-8,\"rngspd\":15},{\"name\":\"Gargantuan\",\"rank\":\"5\",\"height\":\"31-60 m\",\"mass\":\"550-4,000 tonnes\",\"lift\":2500,\"strdmg\":50,\"ar\":50,\"extradmg\":0,\"rnghitdef\":-10,\"rngspd\":30},{\"name\":\"Colossal\",\"rank\":\"6\",\"height\":\"61-125 m\",\"mass\":\"4 k - 30 k tonnes\",\"lift\":10000,\"strdmg\":60,\"ar\":60,\"extradmg\":0,\"rnghitdef\":-12,\"rngspd\":60},{\"name\":\"Enormous\",\"rank\":\"7\",\"height\":\"126-250 m\",\"mass\":\"40 k – 250 k tonnes\",\"lift\":50000,\"strdmg\":70,\"ar\":70,\"extradmg\":0,\"rnghitdef\":-14,\"rngspd\":125},{\"name\":\"Monstrous\",\"rank\":\"8\",\"height\":\"251-500 m\",\"mass\":\"300 k – 2 M tonnes\",\"lift\":250000,\"strdmg\":80,\"ar\":80,\"extradmg\":0,\"rnghitdef\":-16,\"rngspd\":250},{\"name\":\"Titanic\",\"rank\":\"9\",\"height\":\"500-1000 m\",\"mass\":\"2 M – 15 M tonnes\",\"lift\":1000000,\"strdmg\":90,\"ar\":90,\"extradmg\":0,\"rnghitdef\":-18,\"rngspd\":500},{\"name\":\"Monumental\",\"rank\":\"10\",\"height\":\"1-2 km\",\"mass\":\"15 M - 125 M tonnes\",\"lift\":5000000,\"strdmg\":100,\"ar\":100,\"extradmg\":0,\"rnghitdef\":-20,\"rngspd\":1000}]}";
		const global_templates_size_names = ["Point", "Mote", "Speck", "Minute", "Wee", "Teeny", "Fine", "Diminutive", "Tiny", "Small", "Medium", "Large", "Huge", "Mammoth", "Gigantic", "Gargantuan", "Colossal", "Enormous", "Monstrous", "Titanic", "Monumental"];
		const global_templates_size_default = "Medium";
		const global_initialized = 0;
		const global_attribute_data_json = '{"defects":[{"name":"achilliesheel","cost":-2},{"name":"awkwardsize","cost":-2},{"name":"bane","cost":-2},{"name":"blindfury","cost":-2},{"name":"conditionalownership","cost":-1},{"name":"confined","cost":-3},{"name":"cursed","cost":-2},{"name":"demure","cost":-1},{"name":"easilydistracted","cost":-1},{"name":"fragile","cost":-1},{"name":"hounded","cost":-2},{"name":"impairedmanipulation","cost":-3},{"name":"impairedspeech","cost":-3},{"name":"ineptattack","cost":-1},{"name":"ineptdefense","cost":-1},{"name":"involuntarychange","cost":-1},{"name":"ism","cost":-2},{"name":"magnet","cost":-1},{"name":"marked","cost":-1},{"name":"nemesis","cost":-1},{"name":"nightmares","cost":-1},{"name":"nohealing","cost":-2},{"name":"obligated","cost":-2},{"name":"phobia","cost":-1},{"name":"physicalimpairment","cost":-3},{"name":"redtape","cost":-1},{"name":"reduceddamage","cost":-3},{"name":"sensoryimpairment","cost":-3},{"name":"shortcoming","cost":-4},{"name":"significantother","cost":-1},{"name":"skeletoninthecloset","cost":-2},{"name":"socialfault","cost":-1},{"name":"specialrequirement","cost":-3},{"name":"unappealing","cost":-1},{"name":"uniquedefect","cost":0},{"name":"unsettled","cost":-1},{"name":"vulnerability","cost":-2},{"name":"wanted","cost":-2},{"name":"weakpoint","cost":-2}],"attributes":[{"name":"absorption","cost":5,"major":"body","minor":"con"},{"name":"alternateform","cost":4,"major":"body","minor":""},{"name":"alternateidentity","cost":1,"major":"body","minor":""},{"name":"armor","cost":2,"major":"","minor":""},{"name":"attackmastery","cost":1,"major":"","minor":""},{"name":"augmented","cost":4,"major":"","minor":""},{"name":"capacity","cost":1,"major":"","minor":""},{"name":"changestate","cost":3,"major":"body","minor":""},{"name":"cognition","cost":2,"major":"mind","minor":""},{"name":"combattechnique","cost":1,"major":"","minor":""},{"name":"companion","cost":4,"major":"","minor":""},{"name":"connected","cost":1,"major":"soul","minor":""},{"name":"controlenvironment","cost":1,"major":"soul","minor":""},{"name":"conversion","cost":3,"major":"body","minor":""},{"name":"dataaccess","cost":2,"major":"mind","minor":""},{"name":"defensemastery","cost":1,"major":"","minor":""},{"name":"dimensionwalk","cost":5,"major":"soul","minor":""},{"name":"dynamicpowers","cost":10,"major":"","minor":""},{"name":"elasticity","cost":1,"major":"body","minor":""},{"name":"enemyattack","cost":1,"major":"","minor":""},{"name":"enemydefense","cost":1,"major":"","minor":""},{"name":"energized","cost":1,"major":"","minor":""},{"name":"exorcism","cost":1,"major":"soul","minor":""},{"name":"extraactons","cost":4,"major":"","minor":""},{"name":"extraarms","cost":1,"major":"","minor":""},{"name":"extradefenses","cost":2,"major":"mind","minor":""},{"name":"features","cost":1,"major":"","minor":""},{"name":"flight","cost":3,"major":"body","minor":""},{"name":"forcefield","cost":4,"major":"body","minor":""},{"name":"gear","cost":1,"major":"","minor":""},{"name":"groundspeed","cost":1,"major":"body","minor":""},{"name":"healing","cost":1,"major":"soul","minor":""},{"name":"heightenedawareness","cost":1,"major":"mind","minor":""},{"name":"heightenedsenses","cost":1,"major":"body","minor":""},{"name":"illusion","cost":1,"major":"mind","minor":""},{"name":"immovable","cost":1,"major":"body","minor":""},{"name":"immunity","cost":3,"major":"body","minor":""},{"name":"immutable","cost":1,"major":"body or soul","minor":""},{"name":"inspire","cost":1,"major":"soul","minor":""},{"name":"jumping","cost":1,"major":"body","minor":""},{"name":"massivedamage","cost":3,"major":"","minor":""},{"name":"meleeattack","cost":1,"major":"","minor":""},{"name":"meleedefense","cost":1,"major":"","minor":""},{"name":"merge","cost":4,"major":"","minor":""},{"name":"metamorphosis","cost":2,"major":"mind or soul","minor":""},{"name":"mimic","cost":2,"major":"mind","minor":""},{"name":"mindcontrol","cost":5,"major":"mind","minor":""},{"name":"mindshield","cost":1,"major":"mind","minor":""},{"name":"minions","cost":2,"major":"soul","minor":""},{"name":"mulligan","cost":1,"major":"soul","minor":""},{"name":"nullify","cost":5,"major":"body or soul","minor":""},{"name":"plantcontrol","cost":1,"major":"mind","minor":""},{"name":"pocketdimension","cost":1,"major":"","minor":""},{"name":"portal","cost":2,"major":"soul","minor":""},{"name":"powerflux","cost":10,"major":"","minor":""},{"name":"powervariation","cost":4,"major":"","minor":""},{"name":"projection","cost":3,"major":"mind","minor":""},{"name":"rangedattack","cost":1,"major":"","minor":""},{"name":"rangeddefense","cost":1,"major":"","minor":""},{"name":"regeneration","cost":5,"major":"body","minor":""},{"name":"reincarnation","cost":2,"major":"soul","minor":""},{"name":"resilient","cost":2,"major":"body","minor":""},{"name":"sensoryblock","cost":1,"major":"mind","minor":""},{"name":"sixthsense","cost":1,"major":"soul","minor":""},{"name":"sizechange","cost":10,"major":"body","minor":""},{"name":"socialmastery","cost":1,"major":"","minor":""},{"name":"spaceflight","cost":1,"major":"body","minor":""},{"name":"specialmovement","cost":1,"major":"body","minor":""},{"name":"summoncreatures","cost":2,"major":"mind","minor":""},{"name":"supersense","cost":1,"major":"mind","minor":""},{"name":"superspeed","cost":3,"major":"body","minor":""},{"name":"superstrength","cost":4,"major":"body","minor":""},{"name":"swarm","cost":2,"major":"body","minor":""},{"name":"telekinesis","cost":4,"major":"mind","minor":""},{"name":"telepathy","cost":3,"major":"mind","minor":""},{"name":"teleport","cost":3,"major":"mind","minor":""},{"name":"tough","cost":1,"major":"","minor":""},{"name":"transfer","cost":3,"major":"soul","minor":""},{"name":"transmute","cost":3,"major":"mind or soul","minor":""},{"name":"tunneling","cost":1,"major":"body","minor":""},{"name":"unaffected","cost":2,"major":"body","minor":""},{"name":"unassailable","cost":1,"major":"","minor":""},{"name":"undetectable","cost":2,"major":"body","minor":""},{"name":"uniqueattribute","cost":0,"major":"","minor":""},{"name":"unknownpower","cost":1,"major":"","minor":""},{"name":"waterspeed","cost":1,"major":"body","minor":""},{"name":"wealth","cost":3,"major":"","minor":""},{"name":"weapon","cost":2,"major":"","minor":""}]}';
		let global_version = '0.0.0';
		
		const allaspects_stats_array = ['body', 'mind', 'soul'];
		const allaspects_stats_regex = /(body|mind|soul)/i;
		const major_stats_array = ['agi', 'con', 'dex', 'str', 'cre', 'int', 'per', 'rea', 'awa', 'cha', 'com', 'wil'];
		const major_stats_regex = /(str|agi|dex|con|int|rea|per|cre|wil|cha|awa|com)/i;
		const all_stats_array = ['body', 'mind', 'soul', 'agi', 'con', 'dex', 'str', 'cre', 'int', 'per', 'rea', 'awa', 'cha', 'com', 'wil'];
		const all_stats_regex = /(body|mind|soul|str|agi|dex|con|int|rea|per|cre|wil|cha|awa|com)/i;
		const stat_aspects_obj = {
			"body":["agi","dex","con","str"],
			"mind":["cre","int","pre","rea"],
			"soul":["awa","cha","com","wil"]
		};
		const conditions_array = ['bleeding', 'blinded', 'contagious', 'continuing', 'dead', 'drained', 'fractured', 'incurable', 'prone', 'stunned', 'tangled', 'unconscious'];
		const conditions_regex = /(bleeding|blinded|contagious|continuing|dead|drained|fractured|incurable|prone|stunned|tangled|unconscious)/i;
		const heightenedsense_array = ['heightenedsight', 'heightenedhearing', 'heightenedtouch', 'heightenedsmell', 'heightenedtaste'];
		const sense_array = ['sight', 'hearing', 'touch', 'smell', 'taste'];
		const attack_manuevers_array = ['attack', 'bite', 'bypassarmor', 'disarm', 'grab', 'lock', 'pin', 'reducearmor', 'throw', 'vitalspot', 'weakpoint'];
		const attack_maneuvers_regex = /(attack|bite|bypassarmor|disarm|grab|lock|pin|reducearmor|throw|vitalspot|weakpoint)/i;
		const defense_manuevers_array = ['defend', 'defendother', 'doesnothing', 'escape'];
		const defense_maneuvers_regex = /(defend|defendother|escape)/i;
		const non_damaging_attack_regex = /(disarm|grab|pin|defend|defendother|doesnothing|escape)/i;
		const minor_obstacle_maneuvers_regex = /(bite|reducearmor|defendother)/i;
		const major_obstacle_maneuvers_regex = /(bypassarmor|vitalspot)/i;
		const weapon_customizations_array = ['accurate', 'area', 'duration', 'range', 'aura', 'autofire', 'blight', 'contact', 'contageous', 'continuing', 'drain', 'enervation', 'flare', 'flexible', 'homing', 'inaccurate', 'incapacitating', 'incurable', 'insidious', 'irritant', 'knockback', 'multidimensional', 'penetrating', 'piercing', 'psychic', 'quake', 'reach', 'selective', 'spreading', 'stun', 'tangle', 'trap', 'vampiric'];
		const combattechniques_array = ['blackout','blindfighting','blindshooting','brutal','concealment','criticalstrike','deadeye','defelction','enhancedknockback','extendedrange','farshot','hardboiled','judgeopponent','lethalblow','lightningreflexes','multipletargets','portablearmory','preciseaim','reflection','rushattack','steadyhand','tournamentencyclopedia','twoweapons','weaponsencyclopedia'];
		const stats_array = ['static_stat_type_set', 'static_stat_temp_energy', 'static_stat_temp_health', 'stat_total_social', 'static_stat_total_shame', 'stat_total_sanity', 'static_stat_total_maddness', 'stat_total_energy', 'static_stat_total_fatigue', 'stat_total_health', 'static_stat_total_wounds', 'stat_total_shock', 'static_character_points_spent', 'bodystate', 'mindstate', 'soulstate', 'static_stat_base_body', 'static_stat_base_mind', 'static_stat_base_soul', 'stat_total_body', 'stat_total_mind', 'stat_total_soul', 'stat_total_acv', 'stat_total_dcv', 'stat_total_str', 'stat_total_cre', 'stat_total_com', 'stat_total_awa', 'stat_total_dex', 'stat_total_agi', 'stat_total_con', 'stat_total_int', 'stat_total_per', 'stat_total_rea', 'stat_total_wil', 'stat_total_cha', 'strstate', 'agistate', 'dexstate', 'constate', 'intstate', 'reastate', 'perstate', 'crestate', 'wilstate', 'chastate', 'awastate', 'comstate'];
		const rolls_array = ['static_roll_type_selection','static_button_personal_defense','static_button_movement_defense'];
		const combat_stats_array = ['static_weapon_autofire_selection','weapon_ammo_capacity','weapon_ammo_reloads','static_weapon_range_selection','mainhand_state', 'offhand_state', 'mainhand_source', 'offhand_source', 'extraarms', 'extraarms_inuse', 'static_button_targeted_rushdamage', 'static_button_targeted_damage', 'static_button_targeted_attack', 'static_button_targeted_defense', 'massivedamage_targeted', 'massivedamage', 'enemyattack', 'enemydefense'];
		const size_template_values_array = ['size', 'height', 'mass', 'size_lift', 'size_strdmg', 'size_ar', 'size_extradmg', 'size_rnghitdef', 'size_rngspd'];
		const size_template_keys_array = ['name','rank','cost','height','mass','lift','strdmg','ar','extradmg','rnghitdef','rngspd'];
		const all_attributes_array = ['absorption','alternate form','alternate identity','armor','attack mastery','augmented','capacity','change state','cognition','combat technique','companion','connected','control environment','conversion','data access','defect','defense mastery','dimension walk','dynamic powers','elasticity','enemy attack','enemy defense','energized','exorcism','extra actions','extra arms','extra defenses','features','flight','forcefield','gear','ground speed','healing','heightened awareness','heightened senses','illusion','immovable','immunity','immutable','inspire','jumping','massive damage','melee attack','melee defense','merge','metamorphosis','mimic','mind control','mind shield','minions','mulligan','nullify','plant control','pocket dimension','portal','power flux','power variation','projection','ranged attack','ranged defense','regeneration','reincarnation','resilient','sensory block','shield','sixth sense','size change','skill','social mastery','spaceflight','special movement','summon creatures','supersense','superspeed','superstrength','swarm','telekinesis','telepathy','teleport','tough','transfer','transmute','tunneling','unaffected','unassailable','undetectable','unique attribute','unknown power','water speed','wealth','weapon'];
		const all_attributes_regex = /(absorption|alternate form|alternate identity|armor|attack mastery|augmented|capacity|change state|cognition|combat technique|companion|connected|control environment|conversion|data access|defect|defense mastery|dimension walk|dynamic powers|elasticity|enemy attack|enemy defense|energized|exorcism|extra actions|extra arms|extra defenses|features|flight|forcefield|gear|ground speed|healing|heightened awareness|heightened senses|illusion|immovable|immunity|immutable|inspire|jumping|massive damage|melee attack|melee defense|merge|metamorphosis|mimic|mind control|mind shield|minions|mulligan|nullify|plant control|pocket dimension|portal|power flux|power variation|projection|ranged attack|ranged defense|regeneration|reincarnation|resilient|sensory block|shield|sixth sense|size change|skill|social mastery|spaceflight|special movement|summon creatures|supersense|superspeed|superstrength|swarm|telekinesis|telepathy|teleport|tough|transfer|transmute|tunneling|unaffected|unassailable|undetectable|unique attribute|unknown power|water speed|wealth|weapon)/i;
		const all_defects_array = ["achilles heel","awkward size","bane","blind fury","conditional ownership","confined","cursed","demure","easily distracted","fragile","hounded","impaired manipulation","impaired speech","inept attack","inept defense","involuntary change","ism","magnet","marked","nemesis","nightmares","no healing","obligated","phobia","physical impairment","red tape","reduced damage","sensory impairment","shortcoming","significant other","skeleton in the closet","social fault","special requirement","unappealing","unique defect","unsettled","vulnerability","wanted","weak point"];
		const all_defects_regex = /(achilles heel|awkward size|bane|blind fury|conditional ownership|confined|cursed|demure|easily distracted|fragile|hounded|impaired manipulation|impaired speech|inept attack|inept defense|involuntary change|ism|magnet|marked|nemesis|nightmares|no healing|obligated|phobia|physical impairment|red tape|reduced damage|sensory impairment|shortcoming|significant other|skeleton in the closet|social fault|special requirement|unappealing|unique defect|unsettled|vulnerability|wanted|weak point)/i;
		const lesser_defects_regex = /(conditionalownership|demure|easilydistracted|fragile|ineptattack|ineptdefense|involuntarychange|magnet|marked|nemesis|nightmares|phobia|redtape|shortcoming|significantother|socialfault|unappealing|unsettled)/i;
		const serious_defects_regex = /(confined|impairedmanipulation|impairedspeech|nohealing|physicalimpairment|reduceddamage|sensoryimpairment|specialrequirement)/i;
		const greater_defects_regex = /(achillesheel|awkwardsize|bane|blindfury|cursed|hounded|ism|obligated|skeletoninthecloset|vulnerability|wanted|weakpoint)/i;
		const special_defects_regex = /uniquedefect/i;
		const rollable_attributes_regex = /(healing|inspire|unaffected|exorcism|illusion|metamorphosis|mimic|mindcontrol|nullify|powerflux|powervariation|projection|sixthsense|supersense|telepathy|transfer|transmute)/i;
		const targetable_attributes_regex = /(healing|exorcism|illusion|metamorphosis|mimic|mindcontrol|nullify|telepathy|transfer)/i;
		const dymanicGrouRegex = /(flux|variation)/i;
		const dynamic_group_array = ['flux','variation'];
		const controlable_environments_array = ['arid', 'clouds', 'cold', 'darkness', 'heat', 'humidity', 'light', 'liquid', 'gaseous', 'smell', 'sound', 'storms', 'unique', 'vacuum'];
		const sixthsense_phenomena_array = ['attrsrc', 'danger', 'dimensions', 'elements', 'emotions', 'extraplanarbeings', 'illusions', 'morality', 'objects', 'placesofpower', 'uniquephenomena'];
		const special_movements_array = ['balance', 'catlike', 'fast', 'lightfooted', 'slithering', 'swinging', 'untrackable', 'wallbouncing', 'wallcrawling', 'waterwalking', 'zendirection'];
		const undetectable_methods_array = ['echolocation', 'hearing', 'infrared', 'infrasound', 'magnetic', 'odorant', 'radiation', 'radio', 'seismic', 'sight', 'smell', 'tastant', 'taste', 'thermal', 'touch', 'ultrasound', 'ultraviolet', 'x-ray'];
		const unaffected_attrs_array = ['alternateform','alternateidentity','changestate','dataaccess','dimensionwalk','dynamicpowers','exorcism','features','forcefield','illusion','metamorphosis','mindcontrol','nullify','plantcontrol','portal','projection','sensoryblock','sizechange','telekinesis','telepathy','teleport','transmute','undetectable','weapon'];
		const unaffected_states_array = ['alternateformstate', 'alternateidentitystate', 'changestatestate', 'dataaccessstate', 'dimensionwalkstate', 'dynamicpowersstate', 'exorcismstate', 'featuresstate', 'forcefieldstate', 'illusionstate', 'metamorphosisstate', 'mindcontrolstate', 'nullifystate', 'plantcontrolstate', 'portalstate', 'projectionstate', 'sensoryblockstate', 'sizechangestate', 'telekinesisstate', 'telepathystate', 'teleportstate', 'transmutestate', 'undetectablestate', 'weaponstate'];
		const non_actionable_events = ['costperlevel','visible','new','source','characteristic','rollable','attrdefecttoggle','damagetype'];
		const standard_limiters_array = ['activation','assisted','backlash','charges','concentration','consumable','delay','dependant','deplete','detectable','emotional','environmental','equipment','imbue','irreversible','localized','maximum','object','permanent','recovery','semipermanent','unique','unpredictable'];
		const attribute_settings_by_customization_array = ['ammo','attrsrc','broadcategory','charges','continuing','deplete','drain','enemy','focuseddamage','intensity','objects','specialized','specific','targeted','targeteddamage','uniquephenomena','unpredictable'];
		const hands_array = ['mainhand', 'offhand'];
		const instantaneous_attributes_array = ['absorption','cognition','conversion','data access','defense mastery','elasticity','exorcism','healing','immovable','massive damage','metamorphosis','mulligan','nullify','plant control','portal','power flux','power variation','reincarnation','sixth sense','telekinesis','telepathy','teleport','transfer','transmute','weapon'];
		//const ongoing_attributes_array = ['alternate form','alternate identity','armor','attack mastery','augmented','capacity','change state','combat technique','companion','connected','control environment','dimension walk','dynamic powers','enemy attack','enemy defense','energized','extra actions','extra arms','extra defenses','features','flight','forcefield','gear','ground speed','heightened awareness','heightened senses','illusion','immunity','immutable','inspire','jumping','melee attack','melee defense','merge','mimic','mind control','mind shield','minions','pocket dimension','projection','ranged attack','ranged defense','regeneration','resilient','sensory block','shield','size change','skill','social mastery','spaceflight','special movement','summon creatures','supersense','superspeed','superstrength','swarm','tough','tunneling','unaffected','unassailable','undetectable','unique attribute','unknown power','water speed','wealth'];
		
		const upgrade_to_1_5_0_array = ["upgraded_1_5_0"];
		const upgrade_to_1_3_1_array = ["upgraded_1_3_1", "attrdb"];
		const upgrade_to_1_2_2_array = ["upgraded_1_2_2", "name", "charactername"];
		const global_initialized_array = ["global_initialized"];
		const on_sheet_open_array = _.chain([upgrade_to_1_5_0_array, upgrade_to_1_3_1_array, upgrade_to_1_2_2_array, global_initialized_array])
			.flatten()
			.value();
		
		/** Utility Functions **/
		function getTimestamp(timer) {
			const timeNow = Date.now();
			const timeElapsed = timeNow - timer.start;
			timer.cache = timeElapsed - timer.elapsed;
			timer.elapsed = timeElapsed;
		}
		
		function capital(str) {
			if (str.length == 0) return;
			const whitespace = /\s/g.test(str);
			let result = '';
		
			if (whitespace) { str = str.split(" "); }
			else { str = [`${str}`]; }
		
			for (let i = 0, x = str.length; i < x; i++) {
				str[i] = str[i][0].toUpperCase() + str[i].substr(1);
			}
			if (whitespace) { result = str.join(" "); } else { result = str[0]; }
			return result;
		}
		
		function allcaps(str) {
			return str.toUpperCase();
		}
		
		function getIsObject(obj) {
			return Object.prototype.toString.call(obj) === '[object Object]';
		}
		
		function get1or3(level, start) {
			let result = 0;
			if (start == 1) {
				result = (level & 1) ? 1 : 3;
			} else if (start == 3) {
				result = (level & 1) ? 3 : 1;
			}
			return result;
		}
		
		function get1or2andHalfor5(level) {
			const oneTwoAndHalfOrFive = mod =>
				mod == 0 ? 1 :
				mod == 1 ? 2.5 :
				mod == 2 ? 5 :
				0;
			return oneTwoAndHalfOrFive(level % 3);
		}
		
		function setPreviousValue(eventInfo){
			eventInfo.previousValue = 
				eventInfo.previousValue === eventInfo.newValue ? 
					Number.isInteger(eventInfo.newValue) ? 
						0 :
						typeof eventInfo.newValue === 'string' || eventInfo.newValue instanceof String ? 
							'' :
							undefined : 
					eventInfo.previousValue;
		}
		
		function removeWhiteSpace(str){
			return str.replace(/\s+/g, '');
		}
		
		function isEmpty(str) {
			return (!str || str.length === 0);
		}
		
		function isFalsey(v) {
			const testFalsey = 
				parseInt(v) === 0 ? true :
				v === '' ? true :
				v === null ? true :
				v === undefined ? true :
				false;
			return testFalsey;
		}
		
		function clog(debug, timer, text, data = '', title = '', type = 'event') {
			//types = 'info', 'event'
			//debug = 0:off, 1:info, 2:event, 3:performance
			if(debug === 0 || debug === 1 && type === 'event') return;
			const color = 
				type == 'info' ? 'color:#7CFC00' :
				type == 'start' ? 'color:#EE82EE' :
				'color:cyan';
			title = title ? `.[${title}]` : '+';
			title ? console.log(`%c+----.----.----${title}`,color) : false;
			console.log(`%c${text}`,color,data);
			if (debug > 2) {
				getTimestamp(timer);
				console.log(`%crunTime[${timer.cache}] elapsedTime[${timer.elapsed}]`,'color:yellow');
			}
		}
		
		function doUpgrade(value, sheetdb, attrIDs, attrdb, sizetemplateIDs, setObj){
			clog(2, {}, `global_version =`, value.global_version, 'doUpgrade()');
			clog(2, {}, 'sheet_version =', value.version);
			const sheet_version = value.version;
			let global_version = value.global_version.split('.').map(Number);
			const major_global_version = parseInt(global_version.shift());
			const minor_global_version = parseFloat(global_version.join('.'));
			const isLesserThan122 = major_global_version <= 1 && minor_global_version < 2.2 ?
				true : false;
			if (isLesserThan122) {
				upgradeTo_1_2_2(value, setObj);
			}
			const isLesserThan131 = major_global_version <= 1 && minor_global_version < 3.1 ?
				true : false;
			if (isLesserThan131) {
				upgradeTo_1_3_1(value, setObj);
			}
			const isLesserThan150 = major_global_version <= 1 && minor_global_version < 5.0 ?
				true : false;
			if (isLesserThan150) {
				upgradeTo_1_5_0(setObj);
			}
			const isLesserThan172 = major_global_version <= 1 && minor_global_version < 7.2 ?
				true : false;
			if (isLesserThan172) {
				upgradeTo_1_7_2(attrIDs, setObj);
			}
			const isLesserThan180 = major_global_version <= 1 && minor_global_version < 8.0 ?
				true : false;
			if (isLesserThan180) {
				upgradeTo_1_8_0(sizetemplateIDs, value, sheetdb, setObj);
			}
			const isLesserThan183 = major_global_version <= 1 && minor_global_version < 8.3 ?
				true : false;
			if (isLesserThan183) {
				upgradeTo_1_8_3(value, setObj);
			}
			const isLesserThan186 = major_global_version <= 1 && minor_global_version < 8.6 ?
				true : false;
			if (isLesserThan186) {
				upgradeTo_1_8_6(value, setObj);
			}
			const isLesserThan189 = major_global_version <= 1 && minor_global_version < 8.9 ?
				true : false;
			if (isLesserThan189) {
				upgradeTo_1_8_9(value, attrIDs, attrdb, setObj);
			}
			setObj.global_version = sheet_version;
		}
		
		function upgradeTo_1_2_2(value, setObj){
			const oldname = value.name || '';
			const newname = value.charactername || '';
			if(oldname.length > 0 && newname.length == 0){
				setObj.charactername = oldname;
			}
			clog(2, {}, 'upgraded to 1.2.2');
		}
		
		function upgradeTo_1_3_1(value, setObj){
				if (value.attrdb !== undefined) {
					const attrdb = _.isString(value.attrdb) ? 
						JSON.parse(value.attrdb) : value.attrdb;
					const defectdb = attrdb.defect;
					_.each(defectdb, defect => {
						const rowID = defect.source;
						const rank = parseInt(defect.rank) || 0;
						setObj[`repeating_attr_${rowID}_rank`] = rank;
					});
				}		
			clog(2, {}, 'upgraded to 1.3.1');
		}
		
		function upgradeTo_1_5_0(setObj){
				const limiters_array = ['activation','ammo','assisted','backblast','backlash','bothdirections','broadcategory','capped','category','category','categoty','charges','concentration','consumable','delay','dependent','deplete','detectable','emotional','environmental','equipment','exclusive','fieldless','focused','focuseddamage','gap','glide','group','hands','imbue','impacting','inaccurate','ingest','intensity','internal','irreversible','localized','maintain','maximum','nonadjacent','nonpenetrating','nostun','object','permanent','proportionaldamage','recovery','roadbound','semipermanent','skillflux','skim','specialized','specificattribute','spread','stoppable','targeteddamage','toxic','unique','unpredictable','unreliable'];
				getSectionIDs('attr', attrIDs => {
					const attr_customization_array = _.map(attrIDs, id => {
						return `repeating_attr_${id}_customizations`;
					});
					const attr_names_array = _.map(attrIDs, id => {
						return `repeating_attr_${id}_attribute`;
					});
					const getAttrsArray = attr_customization_array.concat(attr_names_array);
					getAttrs(getAttrsArray, v => {
						_.each(attr_customization_array, c => {
							const customizations = _.each(v[`${c}`], customization => {
								if(_.isEmpty(customization)) return;
								if (limiters_array.indexOf(customization.name) >= 0) {
									return customization["type"] = "limiter";
								} else {
									return customization["type"] = "enhancement";
								}
							});
							setObj[`${c}`] = customizations;
						});
						_.each(attrIDs, id => {
							setAttrCustomizations(0, 0, v, id, setObj);
						})
					});
				});
			clog(2, {}, 'upgraded to 1.5.0');
		}
		
		function upgradeTo_1_6_0(value, sheetdb, skilltempIDs, setObj){
			const skillmap = _.chain(skilltempIDs)
				.map( id => {
					return { [id]: value[`repeating_skilltemplate_${id}_label`] };
				})
				.compact()
				.value();
			sheetdb.skillmap = skillmap;
			clog(2, {}, 'upgraded to 1.6.0');
		}
		
		function upgradeTo_1_7_2(attrIDs, setObj) {
			_.each(attrIDs, id => {
				setObj[`repeating_attr_${id}_lock`] = "1";
				setObj[`repeating_attr_${id}_options`] = 0;
			});
			clog(2, {}, 'upgraded to 1.7.2');
		}
		
		function upgradeTo_1_8_0(sizetemplateIDs, value, sheetdb, setObj) {
			const currSize = value.static_template_size_name || 'medium';
			setDefaultSize(sheetdb, setObj, currSize);
			setTotalLift(0, {}, {}, value, setObj);
			if (sizetemplateIDs.length !== undefined) {
				_.each(sizetemplateIDs, id => {
					removeRepeatingRow(`repeating_sizetemplate_${id}`);
				});
			}
			clog(2, {}, 'upgraded to 1.8.0');
		}
		
		function upgradeTo_1_8_3(value, setObj) {
			const statValues = [
				parseInt(value.static_stat_base_body) || 0,
				parseInt(value.static_stat_base_mind) || 0,
				parseInt(value.static_stat_base_soul) || 0
			];
			clog(2, {}, 'statValues:', statValues, 'upgradeTo_1_8_3()');
			_.each(statValues, (s, i) => {
				const cost = getStatCost(2, {}, s);
				clog(2, {}, 's =', s);
				setObj[`stat_cost_${allaspects_stats_array[i]}`] = cost;
			});
			clog(2, {}, 'upgraded to 1.8.3');
		}
		
		function upgradeTo_1_8_6(value, setObj) {
			const statValues = [
				parseInt(value.static_stat_base_body) || 0,
				parseInt(value.static_stat_base_mind) || 0,
				parseInt(value.static_stat_base_soul) || 0
			];
			clog(2, {}, 'statValues:', statValues, 'upgradeTo_1_8_6()');
			_.each(statValues, (s, i) => {
				const cost = getStatCost(2, {}, s);
				clog(2, {}, 's =', s);
				setObj[`stat_cost_${allaspects_stats_array[i]}`] = cost;
			});
			clog(2, {}, 'upgraded to 1.8.6');
		}
		
		function upgradeTo_1_8_9(value, attrIDs, attrdb, setObj) {
			const restoreActiveGroupID = value.static_attrgroup_selected_tab;
			_.each(attrIDs, id => {
				if (value[`repeating_attr_${id}_attribute`] === 'defect') {
					const rank = {};
					rank.newValue = parseInt(value[`repeating_attr_${id}_rank`]) || 0;
					value.static_attrgroup_selected_tab = 
						`attrgroup${value[`repeating_attr_${id}_group`]}`;
					setDefectPointsByRankChange(2, {}, rank, value, id, setObj);
					value[`repeating_attr_${id}_totalcost`] = setObj[`repeating_attr_${id}_totalcost`];
					setGroupDefectPointsOnActivation(2, {}, attrIDs, attrdb, value, 'attr', id, setObj);
				}
			})
			value.static_attrgroup_selected_tab = restoreActiveGroupID;
			clog(2, {}, 'upgraded to 1.8.9');
		}
		
		/** Build UI Functions **/
		
		function getSuperStrengthLift(debug, timer, level) {
			const lift = level !== 0 ?
				get1or2andHalfor5(level) * (10 ** (Math.floor(level/3) + 2)) :
				level;
			clog(debug, timer, 'lift =', lift, 'getSuperStrengthLift()');
			return lift;
		};
		
		function setTotalLift(debug, timer, attrdb, value, setObj) {
			const size = value.static_template_size_name;
			const rank = parseInt(value.static_template_size_rank) || 0;
			clog(debug, timer, 'size =', size, 'setTotalLift()');
			const liftMultiplier = size === 'Medium' ? 1 :
				rank < 0 ? parseFloat(value.static_template_size_lift) :
				parseInt(value.static_template_size_lift) || 0;
			clog(debug, timer, 'liftMultiplier =', liftMultiplier);
			const ssdb = attrdb.superstrength;
			const hasSuperStrength = ssdb === undefined ? false : 
				_.chain(ssdb).pluck('level').reduce((p,c) => { return p + c; }, 0).value();
			clog(debug, timer, 'hasSuperStrength =', hasSuperStrength);
			const strValue = isNaN(parseInt(setObj.stat_total_str)) ?
				parseInt(value.stat_total_str) || 0 : parseInt(setObj.stat_total_str);
			const lift = hasSuperStrength ? parseInt(getSuperStrengthLift(debug, timer, hasSuperStrength)) : 
				strValue * 25;
			clog(debug, timer, 'lift =', lift);
			const totalLift = lift * liftMultiplier;
			clog(debug, timer, 'totalLift =', totalLift);
			setObj.stat_total_lift = totalLift;
		}
		
		function setDefaultSize(sheetdb, setObj, size = 'Medium') {
			//clog(2, {}, 'size =', size, 'setDefaultSize()');
			const json = JSON.parse(global_templates_size_json);
			//clog(2, {}, 'json:', json);
			const template = _.find(json.template, t => {
				//clog(2, {}, 't:', t);
				if (t.name === size) return true;
			});
			//clog(2, {}, 'template:', template);
			const description = "Height/Length: " + template.height + "\r\nMass: " + template.mass + "\r\nLift: " + template.lift + "\r\nStrength Damage: " + template.strdmg + "\r\nArmor Rating: " + template.ar + "\r\nExtra Damage Taken: " + template.extradmg + "\r\nRanged Hit/Defend: " + template.rnghitdef + "\r\nRange Speed: " + template.rngspd;
			const cost = parseInt(template.rank) * 10;
			_.each(size_template_keys_array, key => {
				const val = isNaN(template[key]) ? template[key] : parseInt(template[key]);
				setObj[`static_template_size_${key}`] = val;
				sheetdb[`static_template_size_${key}`] = val;
			});
			setObj.static_template_size_selection = template.name.toLowerCase();
			sheetdb.static_template_size_selection = template.name.toLowerCase();
			setObj.static_template_size_description = description;
			setObj.static_template_size_cost = cost;
		}
		
		function setSizeTemplate(debug, timer, eventInfo, value, setObj) {
			const size = capital(eventInfo.newValue);
			clog(debug, timer, 'size =', size, 'setSizeTemplate()');
			const json = JSON.parse(global_templates_size_json);
			clog(debug, timer, 'json:', json);
			const template = _.find(json.template, t => {
				if (t.name === size) return true;
			});
			clog(debug, timer, 'template:', template);
			const description = "Height/Length: " + template.height + "\r\nMass: " + template.mass + "\r\nLift: " + template.lift + "\r\nStrength Damage: " + template.strdmg + "\r\nArmor Rating: " + template.ar + "\r\nExtra Damage Taken: " + template.extradmg + "\r\nRanged Hit/Defend: " + template.rnghitdef + "\r\nRange Speed: " + template.rngspd;
			clog(debug, timer, 'description =', description);
			const cost = parseInt(template.rank) * 10;
			_.each(size_template_keys_array, key => {
				writeValues(debug, timer, value, `static_template_size_${key}`, template[key], setObj);
			});
			writeValues(debug, timer, value, 'static_template_size_selection', template.name.toLowerCase(), setObj);
			setObj.static_template_size_description = description;
			setObj.static_template_size_cost = cost;
		}
		/*
		function buildSizeUI(sizes, setObj) {
			var json = JSON.parse(global_templates_size_json);
			_.each(sizes, (size, i) => {
				let rowID = generateRowID();
				let description = "Name: " + json.template[`${i}`].name + "\r\nRank: " + json.template[`${i}`].rank + "\r\nHeight/Length: " + json.template[`${i}`].height + "\r\nMass: " + json.template[`${i}`].mass + "\r\nLift: " + json.template[`${i}`].lift + "\r\nStrength Damage: " + json.template[`${i}`].strdmg + "\r\nArmor Rating: " + json.template[`${i}`].ar + "\r\nExtra Damage Taken: " + json.template[`${i}`].extradmg + "\r\nRanged Hit/Defend: " + json.template[`${i}`].rnghitdef + "\r\nRange Speed: " + json.template[`${i}`].rngspd;
				if (size == global_templates_size_default) {
					setObj[`repeating_sizetemplate_${rowID}_selection`] = "1";
					setObj[`static_template_size_name`] = size;
					setObj[`static_template_size_selection`] = `repeating_sizetemplate_${rowID}`;
					setObj.height = json.template[`${i}`].height;
					setObj.mass = json.template[`${i}`].mass;
				}
				setObj[`repeating_sizetemplate_${rowID}_label`] = size;
				setObj[`repeating_sizetemplate_${rowID}_description`] = description;
				setObj[`repeating_sizetemplate_${rowID}_height`] = json.template[`${i}`].height;
				setObj[`repeating_sizetemplate_${rowID}_mass`] = json.template[`${i}`].mass;
				setObj[`repeating_sizetemplate_${rowID}_lift`] = json.template[`${i}`].lift;
				setObj[`repeating_sizetemplate_${rowID}_strdmg`] = json.template[`${i}`].strdmg;
				setObj[`repeating_sizetemplate_${rowID}_ar`] = json.template[`${i}`].ar;
				setObj[`repeating_sizetemplate_${rowID}_extradmg`] = json.template[`${i}`].extradmg;
				setObj[`repeating_sizetemplate_${rowID}_rnghitdef`] = json.template[`${i}`].rnghitdef;
				setObj[`repeating_sizetemplate_${rowID}_rngspd`] = json.template[`${i}`].rngspd;
			});
		}
		*/
		function getSkillStatsDisplay(stats) {
			var result = "";
			_.each(stats, (stat, i) => {
				stat = stat.length > 3 ? capital(stat): allcaps(stat);
				if (i == 0) result = stat;
				if (i == 1) result = `Avg ${result}, ${stat}`;
				if (i > 1) result = `${result}, ${stat}`;
			});
			return result;
		}
		
		function buildSkillsUI(value, setObj, sheetdb) {
			const json = JSON.parse(global_templates_skills_json);
			const skills = json.template;
			let skills_array = [];
			_.each(skills, skill => {
				const rowID = generateRowID();
				const majorstat = getSkillStatsDisplay(skill.statallaspect);
				const minorstat = getSkillStatsDisplay(skill.statmajor);
				const game_genre = parseInt(value.static_options_selection_gamegenre) || 0;
				const description = "Name: " + skill.name + "\r\n\r\nDescription: " + skill.description + "\r\n\r\nSpecializations: " + skill.specializations + "\r\n\r\nStat: " + capital(majorstat) + " (" + allcaps(minorstat) + ")\r\n\r\nCost: " + skill.cost[game_genre];
				setObj[`repeating_skilltemplate_${rowID}_label`] = skill.name;
				setObj[`repeating_skilltemplate_${rowID}_description`] = description;
				setObj[`repeating_skilltemplate_${rowID}_specializations`] = skill.specializations;
				setObj[`repeating_skilltemplate_${rowID}_statallaspect`] = skill.statallaspect;
				setObj[`repeating_skilltemplate_${rowID}_statmajor`] = skill.statmajor;
				setObj[`repeating_skilltemplate_${rowID}_cost`] = skill.cost[game_genre];
				const skillID = rowID.toLowerCase();
				skills_array.push({ [skillID]: skill.name });
			});
			sheetdb.skillmap = skills_array;
		}
		
		function buildAttrGroupValuesArray() {
			let result = [];
			for (groupID = 1; groupID < 11; groupID++) {
				let groupAttrs = [`static_attrgroup_${groupID}_source`,`static_attrgroup_${groupID}_active`,`static_attrgroup_${groupID}_dynamicgroupsource`, `static_attrgroup_${groupID}_groupcost`, `static_attrgroup_${groupID}_isitem`, `static_attrgroup_${groupID}_name`, `static_attrgroup_${groupID}_groupmax`, `static_attrgroup_${groupID}_spent`, `static_attrgroup_${groupID}_stat`, `static_attrgroup_${groupID}_source`, `static_attrgroup_${groupID}_changegroup`, `static_attrgroup_${groupID}_type`];
				result = result.concat(groupAttrs);
			}
			return result;
		}
		
		function buildConditionStateArray() {
			const result = _.map(conditions_array, condition => {
				return `${condition}state`;
			})
			return result;
		}
		
		function buildSkillGroupValuesArray() {
			let result = [];
			for (groupID = 1; groupID < 6; groupID++) {
				let groupSkills = [`static_skillgroup_${groupID}_name`, `static_skillgroup_${groupID}_type`, `static_skillgroup_${groupID}_source`, `static_skillgroup_${groupID}_groupmax`, `static_skillgroup_${groupID}_spent`];
				result = result.concat(groupSkills);
			}
			return result;
		}
		
		function buildProtectionValuesArray() {
			var protections = ["forcefield", "shield", "armor1", "armor2", "armor3", "mindshield", "absorption1", "absorption2", "conversion"],
				result = [];
			_.each(protections, (protection) => {
				result[result.length] = `protection_${protection}_state`;
				result[result.length] = `protection_${protection}_source`;
				result[result.length] = `protection_${protection}_name`;
				result[result.length] = `protection_${protection}_ar`;
			});
			return result;
		}
		
		function buildReapeatingAttrValuesArray(attrIDs) {
			var result = [];
			const attrs = [
				'activate',
				'ammo',
				'ammostate',
				'armorlayer',
				'attrdefecttoggle',
				'attribute',
				'attrsrc',
				'augmentedstat',
				'bonus',
				'broadcategory',
				'capacity',
				'capacitystate',
				'capacitytype',
				'characteristic',
				'charges',
				'collectiontype',
				'conditions',
				'continuing',
				'continuingtype',
				'conversiontype',
				'costperlevel',
				'customizations',
				'damagetype',
				'defect',
				'defectaspect',
				'defenseclass',
				'deplete',
				'display',
				'drain',
				'draintype',
				'effect',
				'effectivelevel',
				'endurance',
				'enemy',
				'enhancementassignments',
				'extraarms',
				'fluxenable',
				'focuseddamage',
				'group',
				'immunityrole',
				'intensity',
				'isflux',
				'level',
				'limiterassignments',
				'lock',
				'name',
				//'new',
				'object',
				'objects',
				'options',
				'rank',
				'rollable',
				'seeinto',
				'sense',
				'skill',
				'skillgroup',
				'source',
				'specialized',
				'specific',
				'stat',
				'supersense',
				'targeted',
				'targeteddamage',
				'totalcost',
				'unaffectedattributes',
				'uniquephenomena',
				'uniqueattributecost',
				'unpredictable',
				'visible',
				'weaponclass'
			];
			_.each(attrIDs, id => {
				_.map(attrs.concat(unaffected_states_array), attr => {
					return result[result.length] = `repeating_attr_${id}_${attr}`;
				});
			});
			return result;
		}
		
		function buildReapeatingSkillValuesArray(attrIDs) {
			var result = [];
			_.each(attrIDs, (rowID) => {
				let attrs = [`repeating_skill_${rowID}_totalcost`,`repeating_skill_${rowID}_option`,`repeating_skill_${rowID}_statselection`,`repeating_skill_${rowID}_visible`, `repeating_skill_${rowID}_skillrollvalue`, `repeating_skill_${rowID}_name`, `repeating_skill_${rowID}_skillspecilizations`, `repeating_skill_${rowID}_group`, `repeating_skill_${rowID}_new`, `repeating_skill_${rowID}_level`, `repeating_skill_${rowID}_majorstat`, `repeating_skill_${rowID}_minorstat`, `repeating_skill_${rowID}_specializations`, `repeating_skill_${rowID}_skillspecilizations`, `repeating_skill_${rowID}_costperlevel`];
				const stats = allaspects_stats_array.concat(major_stats_array);
				_.each(stats,stat=>{
					attrs[attrs.length] = `repeating_skill_${rowID}_${stat.toLowerCase()}state`;
				})
				result = result.concat(attrs);
			});
			return result;
		}
		/*
		function buildSizeTemplateValuesArray(rowID) {
			const result = [`repeating_sizetemplate_${rowID}_height`, `repeating_sizetemplate_${rowID}_mass`, `repeating_sizetemplate_${rowID}_lift`, `repeating_sizetemplate_${rowID}_strdmg`, `repeating_sizetemplate_${rowID}_ar`, `repeating_sizetemplate_${rowID}_extradmg`, `repeating_sizetemplate_${rowID}_rnghitdef`, `repeating_sizetemplate_${rowID}_rngspd`, `repeating_sizetemplate_${rowID}_selection`, `repeating_sizetemplate_${rowID}_description`, `repeating_sizetemplate_${rowID}_label`];
			return result;
		}
		*/
		function buildRepeatingExtraArmValuesArray(extraarms) {
			var result = [];
			if (extraarms != undefined) {
				_.each(extraarms, (extraarm) => {
					let attrs = [`repeating_extraarm_${extraarm}_state`, `repeating_extraarm_${extraarm}_name`, `repeating_extraarm_${extraarm}_type`, `repeating_extraarm_${extraarm}_source`, `repeating_extraarm_${extraarm}_label`];
					result = result.concat(attrs);
				});
			}
			return result;
		}
		
		function getStatType(value){
			const type = value.static_stat_type_set;
			const major = (type == 'major') ? 0 : 1;
			const minor = (type == 'minor') ? 1 : 0;
			return { major: major, minor: minor };
		}
		
		function setStatType(type, setObj) {
			setObj.majorstats = type.major;
			setObj.minorstats = type.minor;
		}
		
		function switchStatRollType(type, setObj){
			setObj.dynamic_roll_base = 0;
			clearStatStates(type, setObj);
		}
		
		function setSkillStatDisplay(debug, timer, value, skillID, sourceAttr, setObj, type){
			const skillStatDisplay = getSkillStatTypeDisplay(debug, timer, value, skillID, sourceAttr, setObj, type);
			setObj[`repeating_skill_${skillID}_stat`] = skillStatDisplay;
			clog(debug, timer, 'skillStatDisplay =', skillStatDisplay, 'setSkillStatDisplay()');
		}
		
		function setSkillStatType(debug, timer, value, skillIDs, sourceAttr, type, setObj){
			_.each(skillIDs, skillID => {
				setSkillStatDisplay(debug, timer, value, skillID, sourceAttr, setObj, type);
				setObj[`repeating_skill_${skillID}_majorstats`] = type.major;
				setObj[`repeating_skill_${skillID}_minorstats`] = type.minor;
			});
		}
		
		function getSkillStatTypeDisplay(debug, timer, value, skillID, sourceAttr, setObj, type){
			const statsarray = type.major == 1 ? major_stats_array : allaspects_stats_array;
			const stats = _.chain(statsarray)
				.map(stat => {
					const state = (stat == sourceAttr ? 
						parseInt(setObj[`repeating_skill_${skillID}_${stat}state`]):
						parseInt(value[`repeating_skill_${skillID}_${stat}state`])) || 0;
					const active = state > 0 ? stat: '';
					return active;
				})
				.compact()
				.value();
			const result = getSkillStatsDisplay(stats);
			clog(debug, timer, 'result =', result, 'getSkillStatTypeDisplay()');
			return result;
		}
		
		function getStatCost(debug, timer, level) {
			let cost = 0;
			for(let i = 1; i <= level; i++) {
				if(i < 13) { cost += 2 } else { cost += 4 }
			}
			clog(debug, timer, 'cost =', cost, 'getStatCost()');
			return cost;
		}
		
		function setStatCost(debug, timer, eventInfo, value, setObj, sourceAttr) {
			const level = parseInt(eventInfo.newValue) || 0
			const statCost = getStatCost(debug, timer, level);
			writeValues(debug, timer, value, `stat_cost_${sourceAttr}`, statCost, setObj);
			clog(debug, timer, 'sourceAttr =', sourceAttr, 'setStatCost()');
		}
		
		function getDefectPointsByCategory(value, rowID, defect){
			const aspect = value[`repeating_attr_${rowID}_defectaspect`] || [];
			const result = defect == 'shortcoming' ? aspect.length > 3 ? -4 : -1 :
				lesser_defects_regex.test(defect) ? -1 :
				greater_defects_regex.test(defect) ? -2 :
				serious_defects_regex.test(defect) ? -3 :
				0;
			return result;
		}
		
		function setGroupDefectPointsOnActivation(debug, timer, attrIDs, attrdb, value, sectionName, rowID, setObj){
			const groupid = getGroupID(value, 'attr');
			const groupType = value[`static_attrgroup_${groupid}_type`] || 'Standard';
			const groupSourceID = value[`static_attrgroup_${groupid}_source`];
			const isPowerFlux = groupType.toLowerCase().indexOf('flux') !== -1 ? true : false;
			const fluxcost = parseInt(value[`repeating_attr_${groupSourceID}_totalcost`]) || 0;
			const standardgroupcost = getStandardGroupCost(debug, timer, attrIDs, value, rowID, false, groupid, setObj);
			const groupIsActive = groupSourceID !== false ? 
				parseInt(value[`repeating_attr_${groupSourceID}_activate`]) || 0 :
				false;
			const aggregateAttrGroupCost = 
				isPowerFlux && groupIsActive ? 
					getPowerFluxGroupCost(debug, timer, value, groupSourceID) :
				standardgroupcost;
			const aggregateDefectPoints = getAggregateGroupDefectPoints(debug, timer, attrdb, value);
			const groupcost = isPowerFlux ?
				fluxcost + aggregateDefectPoints :
				aggregateAttrGroupCost + aggregateDefectPoints;
			setObj[`static_attrgroup_${groupid}_groupcost`] = groupcost;
		}
		
		function setDefectPointsByRankChange(debug, timer, eventInfo, value, rowID, setObj) {
			const defect = removeWhiteSpace(value[`repeating_attr_${rowID}_defect`]);
			const category = getDefectPointsByCategory(value, rowID, defect);
			const rank = parseInt(eventInfo.newValue) || 0;
			const cost = rank * category;
			setObj[`repeating_attr_${rowID}_totalcost`] = cost;
			clog(debug, timer, 'cost =', cost, 'setDefectPointsByRankChange()');
		}
		
		function setEffectiveLevelByLevelChange(debug, timer, eventInfo, value, sectionName, rowID, sourceAttr, setObj) {
			const newLevel = parseInt(eventInfo.newValue) || 0;
			const previousLevel = parseInt(eventInfo.previousValue) || 0;
			const diffLevel = newLevel - previousLevel;
			const effectivelevel = parseInt(getAttrValue(value, `repeating_${sectionName}_${rowID}`, "effectivelevel", setObj)) || 0;
			const result = effectivelevel + diffLevel;
			clog(debug, timer, 'result =', result,'setEffectiveLevelByLevelChange()');
			setObj[`repeating_${sectionName}_${rowID}_effectivelevel`] = result;
		}
		
		function getFluxGroupIsNotActive(debug, timer, value, rowID){
			const groupid = getGroupID(value, 'attr');
			clog(debug, timer, 'groupid =', groupid, 'getFluxGroupIsNotActive()');
			const groupType = value[`static_attrgroup_${groupid}_type`];
			clog(debug, timer, 'groupType =', groupType);
			const groupSourceID = value[`static_attrgroup_${groupid}_source`];
			clog(debug, timer, 'groupSourceID =', groupSourceID);
			const isGroupActive = parseInt(value[`repeating_attr_${groupSourceID}_activate`]) || 0;
			clog(debug, timer, 'isGroupActive =', isGroupActive);
			const isFlux = groupType.toLowerCase().indexOf('flux') !== -1 ? true : false;
			clog(debug, timer, 'isFlux =', isFlux);
			const result =  
				!isFlux ? 
					false : //not flux group, keep running
					groupSourceID === rowID ? 
						false : //flux group source, keep running
						isGroupActive ? 
							false : //flux group is active, keep running
							true; //flux group is not active, stop
			clog(debug, timer, 'result =', result);//, 'getFluxGroupIsNotActive()');
			return result;
		}
		
		function setPoolCostIfGroupIsVariation(debug, timer, isActive, attrIDs, value, rowID, setObj){
			const groupid = getGroupID(value, 'attr');
			const groupType = value[`static_attrgroup_${groupid}_type`] || 'Standard';
			//const isPowerVariation = /variation/i.test(groupType);
			const isPowerVariation = groupType.toLowerCase().indexOf('variation') !== -1 ? true : false;
			const groupSourceID = value[`static_attrgroup_${groupid}_source`];
			const groupIsActive = parseInt(value[`repeating_attr_${groupSourceID}_activate`]) || 0;
			clog(debug, timer, 'isPowerVariation =', isPowerVariation, 'setPoolCostIfGroupIsVariation()');
			if(!isPowerVariation || !groupIsActive){
				clog(debug, timer, 'groupIsActive =', groupIsActive);
				return;
			}
			const groupCost = parseInt(value[`repeating_attr_${groupSourceID}_totalcost`]) || 0;
			const defect = value[`repeating_attr_${rowID}_attribute`];
			const isDefect = defect.indexOf(defect) !== -1 ? true : false;
			const attrcost = groupSourceID == rowID ? 0 : 
				isDefect ? 0 :
				parseInt(value[`repeating_attr_${rowID}_totalcost`]) || 0;
			const aggregateAttrCost = 
				getAggregateAttrGroupCost(debug, timer, attrIDs, value, 'attr', rowID, setObj);
			const poolcost = aggregateAttrCost - groupCost;
			const setAttrCostIfVariation = isVariation => isVariation ? 
				setObj[`static_attrgroup_${groupid}_spent`] = poolcost : false;
			setAttrCostIfVariation(isPowerVariation);
		}
		
		function setPoolCostIfGroupIsFlux(debug, timer, attrIDs, value, rowID, setObj){
			const groupid = getGroupID(value, 'attr');
			const groupType = value[`static_attrgroup_${groupid}_type`] || 'Standard';
			const isPowerFlux = groupType.toLowerCase().indexOf('flux') !== -1 ? true : false;
			clog(debug, timer, 'isPowerFlux =', isPowerFlux, 'setPoolCostIfGroupIsFlux()');
			if(!isPowerFlux) return;
			const groupSourceID = value[`static_attrgroup_${groupid}_source`];
			clog(debug, timer, 'groupSourceID =', groupSourceID);
			const groupCost = parseInt(value[`repeating_attr_${groupSourceID}_totalcost`]) || 0;
			clog(debug, timer, 'groupCost =', groupCost);
			const fluxactive = parseInt(value[`repeating_attr_${groupSourceID}_activate`]) || 0;
			clog(debug, timer, 'fluxactive =', fluxactive);
			const isDefect = value[`repeating_attr_${rowID}_attribute`].substring('defect') !== -1 ?
				true : false;
			clog(debug, timer, 'isDefect =', isDefect);
			const attrcost = groupSourceID == rowID ? 0 : 
				isDefect ? 0 :
				parseInt(value[`repeating_attr_${rowID}_totalcost`]) || 0;
			clog(debug, timer, 'attrcost =', attrcost);
			const isFluxActive = isPowerFlux && fluxactive ? true : false;
			clog(debug, timer, 'isFluxActive =', isFluxActive);
			const aggregateAttrCost = getAggregateAttrGroupCost(debug, timer, attrIDs, value, 'attr', rowID, setObj, isFluxActive);
			clog(debug, timer, 'aggregateAttrCost =', aggregateAttrCost);
			const poolcost = aggregateAttrCost - groupCost;
			clog(debug, timer, 'poolcost =', poolcost);
			const setAttrCostIfFlux = isFlux => isFlux ? 
				setObj[`static_attrgroup_${groupid}_spent`] = poolcost : false;
			setAttrCostIfFlux(isPowerFlux);
		}
		
		function setAttrCost(debug, timer, value, rowID, setObj) {
			const isWeapon = value[`repeating_attr_${rowID}_attribute`] === 'weapon' ?
				true : false;
			const isAltmunition = isWeapon && 
				getCustomizationExists('altmunition', value[`repeating_attr_${rowID}_customizations`]) ?
				2 : 1;
			const result = 
				Math.round((getAttrCostPerLevel(debug, timer, value, rowID) *
				(parseInt(value[`repeating_attr_${rowID}_level`])) || 0) / isAltmunition);
			clog(debug, timer, `repeating_attr_${rowID}_totalcost =`, result, 'setAttrCost()');
			clog(debug, timer, `isWeapon =`, isWeapon);
			clog(debug, timer, `isAltmunition =`, isAltmunition);
			setObj[`repeating_attr_${rowID}_totalcost`] = result;
		}
		
		function setAttrGroupCost(debug, timer, attrIDs, attrdb, value, rowID, sourceAttr, setObj, isRankChange = false) {
			const isLevelChange = sourceAttr === 'level' || isRankChange;
			const groupid = getGroupID(value, 'attr');
			const groupType = 
				value[`static_attrgroup_${groupid}_type`] || 'Standard';
			const isPowerFlux = 
				groupType.toLowerCase().indexOf('flux') !== -1 ? 
					true : false;
			const isPowerVariation = 
				groupType.toLowerCase().indexOf('variation') !== -1 ? 
					true : false;
			const groupSourceID = isPowerFlux || isPowerVariation ? 
				value[`static_attrgroup_${groupid}_source`] : false;
			const groupIsActive = groupSourceID !== false ? 
				parseInt(value[`repeating_attr_${groupSourceID}_activate`]) || 0 :
				false;
			const isVariationPool = isPowerVariation && groupIsActive ? true : false;
			const standardgroupcost = getStandardGroupCost(debug, timer, attrIDs, value, rowID, isLevelChange, groupid, setObj, isVariationPool);
			const groupcost = 
				isPowerFlux && groupIsActive ? 
					getPowerFluxGroupCost(debug, timer, value, groupSourceID) :
				isPowerVariation && groupIsActive ? 
					getPowerVariationGroupCost(debug, timer, value, groupid) :
				standardgroupcost;
			const poolspent = 
				isPowerFlux && groupIsActive ? 
					parseInt(value[`static_attrgroup_${groupid}_spent`]) || 0 :
				isPowerVariation && groupIsActive ? 
					getPowerVariationPoolCost(debug, timer, value, standardgroupcost, groupSourceID, groupid, setObj) :
				0;
			const defectcost = getAggregateGroupDefectPoints(debug, timer, attrdb, value);
			clog(debug, timer, 'isLevelChange =', isLevelChange, 'setAttrGroupCost()');
			clog(debug, timer, 'groupid =', groupid);
			clog(debug, timer, 'groupType =', groupType);
			clog(debug, timer, 'isPowerFlux =', isPowerFlux);
			clog(debug, timer, 'isPowerVariation =', isPowerVariation);
			clog(debug, timer, 'standardgroupcost =', standardgroupcost);
			clog(debug, timer, 'groupcost =', groupcost);
			clog(debug, timer, 'poolspent =', poolspent);
			clog(debug, timer, 'defectcost =', defectcost);
			setObj[`static_attrgroup_${groupid}_groupcost`] = groupcost - defectcost;
			setObj[`static_attrgroup_${groupid}_spent`] = poolspent;
		}
		
		function setAttrGroupPoolSpentByActivation(debug, timer, isActive, attrIDs, value, rowID, setObj) {
			const groupid = parseInt(value[`repeating_attr_${rowID}_group`]) || 0; //getGroupID(value, 'attr');
			clog(debug, timer, 'groupid =', groupid, 'setAttrGroupPoolSpentByActivation()');
			const groupType = 
				value[`static_attrgroup_${groupid}_type`] || 'Standard';
			clog(debug, timer, 'groupType =', groupType);
			const isPowerFlux = 
				groupType.toLowerCase().indexOf('flux') !== -1 ? 
					true : false;
			clog(debug, timer, 'isPowerFlux =', isPowerFlux);
			const isPowerVariation = 
				groupType.toLowerCase().indexOf('variation') !== -1 ? 
					true : false;
			clog(debug, timer, 'isPowerVariation =', isPowerVariation);
			if (isPowerFlux || isPowerVariation) {
				const poolmax = parseInt(value[`static_attrgroup_${groupid}_groupmax`]) || 0;
				clog(debug, timer, 'poolmax =', poolmax);
				const poolspent = 
					isPowerFlux ?
						getPowerFluxPoolSpent(debug, timer, isActive, attrIDs, value, rowID, groupid, setObj) :
					isPowerVariation ?
						getPowerVariationPoolCost(debug, timer, isActive, attrIDs, value, rowID, groupid, setObj) :
					0;
				clog(debug, timer, 'poolspent =', poolspent);
				setObj[`static_attrgroup_${groupid}_spent`] = poolmax - poolspent;
			}
		}
		
		function getStandardGroupCost(debug, timer, attrIDs, value, rowID, isLevelChange, groupid, setObj, isVariationPool = false) {
			const result = 
				_.chain(attrIDs)
				.map(id=>{
					const attribute = value[`repeating_attr_${id}_attribute`];
					const group = parseInt(value[`repeating_attr_${id}_group`]) || 0;
					const isGroupMember = group === groupid;
					if (!isGroupMember) return 0;
					const isDefect = attribute === 'defect' ? true : false;
					if (isDefect) return 0;
					const isWeapon = attribute === 'weapon' ? true : false;
					const isAltmunition = isWeapon && isVariationPool &&
						getCustomizationExists('altmunition', value[`repeating_attr_${id}_customizations`]) ?
						2 : 1;
					const isCurrAttr = id === rowID ? true : false;
					const attrcost = isCurrAttr && isLevelChange ?
						(parseInt(setObj[`repeating_attr_${id}_totalcost`]) || 0) * isAltmunition :
						(parseInt(value[`repeating_attr_${id}_totalcost`]) || 0) * isAltmunition;
					return attrcost;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			clog(debug, timer, 'groupid =', groupid, 'getStandardGroupCost()');
			clog(debug, timer, 'result =', result);
			return result;
		}
		
		function getPowerFluxGroupCost(debug, timer, value, groupSourceID) {
			const result = value[`repeating_attr_${groupSourceID}_totalcost`];
			clog(debug, timer, 'result =', result, 'getPowerFluxGroupCost()');
			return result;
		}
		
		function getPowerVariationGroupCost(debug, timer, value, groupid) {
			const result = value[`static_attrgroup_${groupid}_groupcost`];
			clog(debug, timer, 'result =', result, 'getPowerVariationGroupCost()');
			return result;
		}
		
		function getPowerFluxPoolSpent(debug, timer, isActive, attrIDs, value, rowID, groupid, setObj) {
			clog(debug, timer, 'groupid =', groupid, 'getPowerFluxPoolSpent()');
			const groupSourceID = value[`static_attrgroup_${groupid}_source`];
			const groupIsActive = parseInt(value[`repeating_attr_${groupSourceID}_activate`]) || 0;
			const result = !groupIsActive ? 0 :
				_.chain(attrIDs)
				.map(id=>{
					const group = parseInt(value[`repeating_attr_${id}_group`]) || 0;
					const isGroupMember = group === groupid;
					if (!isGroupMember) return 0;
		
					const attribute = value[`repeating_attr_${id}_attribute`];
					clog(debug, timer, 'attribute =', attribute);
					
					const isWeapon = attribute === 'weapon' ? true : false;
					const isAltmunition = isWeapon && 
						getCustomizationExists('altmunition', value[`repeating_attr_${id}_customizations`]) ?
						2 : 1;
					
					const isGroupSource = groupSourceID === id ? true : false;
					clog(debug, timer, 'isGroupSource =', isGroupSource);
					if (isGroupSource) return 0;
					
					const isDefect = attribute === 'defect' ? true : false;
					clog(debug, timer, 'isDefect =', isDefect);
					if (isDefect) return 0;
		
					const isCurrAttr = id === rowID;
					const isActivated = 
						isCurrAttr ? 
							isActive :
							isNaN(parseInt(setObj[`repeating_attr_${id}_activate`])) ?
								(parseInt(value[`repeating_attr_${id}_activate`]) || 0) > 0 ? true : false :
								parseInt(setObj[`repeating_attr_${id}_activate`]) > 0 ?	true : false;
					clog(debug, timer, 'isActivated =', isActivated);
					if (!isActivated) return 0;
		
					const attrcost = (parseInt(value[`repeating_attr_${id}_totalcost`]) || 0) * isAltmunition;
					clog(debug, timer, 'attrcost =', attrcost);
					return attrcost;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			//clog(debug, timer, 'groupid =', groupid, 'getPowerFluxPoolSpent()');
			clog(debug, timer, 'result =', result);
			return result;
		}
		
		function getPowerVariationPoolCost(debug, timer, isActive, attrIDs, value, rowID, groupid, setObj) {
			const groupSourceID = value[`static_attrgroup_${groupid}_source`];
			const groupIsActive = parseInt(value[`repeating_attr_${groupSourceID}_activate`]) || 0;
			clog(debug, timer, 'groupid =', groupid, 'getPowerVariationPoolCost()');
			const result = !groupIsActive ? 0 :
				_.chain(attrIDs)
				.map(id=>{
					const group = parseInt(value[`repeating_attr_${id}_group`]) || 0;
					const isGroupMember = group === groupid;
					if (!isGroupMember) return 0;
		
					const attribute = value[`repeating_attr_${id}_attribute`];
					clog(debug, timer, 'attribute =', attribute);
					
					const isWeapon = attribute === 'weapon' ? true : false;
					const isAltmunition = isWeapon && 
						getCustomizationExists('altmunition', value[`repeating_attr_${id}_customizations`]) ?
						2 : 1;
					
					const isGroupSource = groupSourceID === id ? true : false;
					clog(debug, timer, 'isGroupSource =', isGroupSource);
					if (isGroupSource) return 0;
					
					const isDefect = attribute === 'defect' ? true : false;
					clog(debug, timer, 'isDefect =', isDefect);
					if (isDefect) return 0;
		
					const isCurrAttr = id === rowID;
					const isActivated = 
						isCurrAttr ? 
							isActive :
							isNaN(parseInt(setObj[`repeating_attr_${id}_activate`])) ?
								(parseInt(value[`repeating_attr_${id}_activate`]) || 0) > 0 ? true : false :
								parseInt(setObj[`repeating_attr_${id}_activate`]) > 0 ?	true : false;
					clog(debug, timer, 'isActive =', isActive);
					if (!isActivated) return 0;
		
					const attrcost = (parseInt(value[`repeating_attr_${id}_totalcost`]) || 0) * isAltmunition;
					clog(debug, timer, 'attrcost =', attrcost);
					return attrcost;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			//clog(debug, timer, 'groupid =', groupid, 'getPowerVariationPoolCost()');
			clog(debug, timer, 'result =', result);
			return result;
		}
		
		function cleanupSkillCosts(debug, timer, skillIDs, value, rowID, setObj){
			const groupid = getGroupID(value, 'skill');
			const aggregateSkillCost = getAggregateSkillGroupCost(debug, timer, skillIDs, value, rowID, groupid, setObj);
			setObj[`static_skillgroup_${groupid}_spent`] = aggregateSkillCost;
			clog(debug, timer, 'aggregateSkillCost', aggregateSkillCost, 'cleanupSkillCosts()');
		}
		
		function cleanupCosts(debug, timer, attrIDs, attrdb, value, sectionName, rowID, setObj){
			const debugtext = `[cleanupCosts()]`;
			const groupid = getGroupID(value, sectionName);
			const groupType = value[`static_${sectionName}group_${groupid}_type`] || 'standard';
			//const isPowerFlux = /flux/i.test(groupType);
			//const isPowerVariation = /variation/i.test(groupType);
			const isPowerFlux = groupType.toLowerCase().indexOf('flux') !== -1 ? true : false;
			const isPowerVariation = groupType.toLowerCase().indexOf('variation') !== -1 ? true : false;
			const groupSourceID = value[`static_${sectionName}group_${groupid}_source`];
			const groupActive = parseInt(value[`static_${sectionName}group_${groupid}_active`]) || 0;
			const removedIsGroupSource = groupSourceID == rowID ? true : false;
			const poolCost = parseInt(value[`repeating_${sectionName}_${groupSourceID}_totalcost`]) || 0;
			const isFluxActive = isPowerFlux && groupActive ? true : false;
			const aggregateAttrCost = getAggregateAttrGroupCost(debug, timer, attrIDs, value, sectionName, rowID, setObj, isFluxActive);
			const aggregateDefectPoints = getAggregateGroupDefectPoints(debug, timer, attrdb, value);
		
			const poolSpent = isPowerFlux ? removedIsGroupSource ? 0 : 
				groupActive ? aggregateAttrCost : 0 :
				isPowerVariation ? removedIsGroupSource ? 0 :
				groupActive ? aggregateAttrCost : 0 : 0;
			const groupCost = isPowerFlux ? removedIsGroupSource ? 
				aggregateAttrCost + aggregateDefectPoints : 
				groupActive ? poolCost : 
				aggregateAttrCost + aggregateDefectPoints + poolCost :
				isPowerVariation ? removedIsGroupSource ? 
				aggregateAttrCost + aggregateDefectPoints :
				aggregateAttrCost + aggregateDefectPoints + poolCost : 
				aggregateAttrCost + aggregateDefectPoints;
			setObj[`static_${sectionName}group_${groupid}_spent`] = poolSpent;
			setObj[`static_${sectionName}group_${groupid}_groupcost`] = groupCost;
			clog(debug, timer, 'poolSpent =', poolSpent, 'cleanupCosts()');
			clog(debug, timer, 'groupCost =', groupCost);
		}
		
		function cleanupGroupType(debug, timer, removedInfo, attrIDs, attrdb, value, rowID, setObj){
			const attribute = _.find(removedInfo, o=>{ return /(flux|variation)/i.test(o); });
			const wasDynamicGroup = attr => attr === undefined ? false : true;
			clog(debug, timer, 'attribute', attribute, 'cleanupGroupType()');
			if(wasDynamicGroup(attribute)) convertToStandardGroup(debug, timer, attrIDs, attrdb, value, rowID, setObj);
		}
		
		function cleanupSheetdb(debug, timer, removedInfo, value) {
			//clog(debug, timer, 'removedInfo:', removedInfo, 'cleanupSheetdb()');
			const omitted_keys_array = _.chain(removedInfo).keys().map( k => {
				return k.toLowerCase();
			}).value();
			//clog(debug, timer, 'omitted_keys_array:', omitted_keys_array);
			value = _.omit(value, omitted_keys_array);
			//clog(debug, timer, 'value', value);//, 'cleanupSheetdb()');
		}
		
		function cleanupAttrIDs(attrIDs, rowID) {
			attrIDs.splice(attrIDs.indexOf(rowID), 1);
		}
		
		function restoreActiveAttribute(removedInfo){
			setAttrs(removedInfo,{silent:true});
		}
		
		function getRemovedAttribute(removedInfo){
			return _.find(removedInfo,o=>{ return all_attributes_regex.test(o); });
		}
		
		function getWasActive(removedInfo, originalCaseRowID){
			const result = parseInt(removedInfo[`repeating_attr_${originalCaseRowID}_activate`]) > 0 ?
				true : false;
			return result;
		}
		
		function getAggregateGroupDefectPoints(debug, timer, attrdb, value){
			const groupid = getGroupID(value, 'attr');
			const defectdb = attrdb.defect;
			const aggregateGroupDefectPoints = _.chain(defectdb)
				.map(o=>{
					const id = o.source;
					const defect = o.name;
					const defectcategory = getDefectPointsByCategory(value, id, defect);
					const group = parseInt(value[`repeating_attr_${id}_group`]) || 0;
					const defectpoints = (parseInt(value[`repeating_attr_${id}_rank`]) || 0) * defectcategory;
					const appliedPoints = group == groupid ?
					defectpoints : 0;
					return appliedPoints;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			clog(debug, timer, 'aggregateGroupDefectPoints =', aggregateGroupDefectPoints,'getAggregateGroupDefectPoints()');
			return aggregateGroupDefectPoints;
		}
		
		function getAggregatePoolCost(debug, timer, ids, eventInfo, value, sectionName, rowID, setObj){
			const groupid = getGroupID(value, sectionName);
			const groupType = value[`static_${sectionName}group_${groupid}_type`] || 
				'Standard';
			const groupSourceID = value[`static_${sectionName}group_${groupid}_source`];
			const aggregatePoolCost = _.chain(ids)
				.map(id=>{
					const isGroupMember = 
						(parseInt(value[`repeating_${sectionName}_${id}_group`]) || 0) == groupid ?
						true : false;
					const isDefect = 
						value[`repeating_attr_${id}_attribute`] === 'defect' ? 
						true : false;
					const isStandardGroup = groupType.toLowerCase() === 'standard' ?
						true : false;
					const isGroupSourceAttr = id == groupSourceID ?
						true : false;
					const isFluxGroup = groupType.toLowerCase() === 'powerflux' ?
						true : false;
					const isActivated = sectionName == 'skill' ? 1 :
						isNaN(parseInt(setObj[`repeating_attr_${id}_activate`])) ?
						parseInt(value[`repeating_attr_${id}_activate`]) || 0 :
						parseInt(setObj[`repeating_attr_${id}_activate`]);
					const attrcost = id == rowID ? 
						parseInt(eventInfo.newValue) * getAttrCostPerLevel(debug, timer, value, rowID) : 
						parseInt(value[`repeating_${sectionName}_${id}_totalcost`]) || 0;
					const appliedCost = isGroupMember ? 
						isDefect ? 0 :	
							isStandardGroup ? 0 : 
								isGroupSourceAttr ? 0 : 
									isFluxGroup ? 
										isActivated ? 
											attrcost : 0 :
									attrcost : 
						0;
					return appliedCost;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			return aggregatePoolCost;
		}
		
		function getAggregateAttrGroupCost(debug, timer, ids, value, sectionName, rowID, setObj, isPowerFlux = false){
			const groupid = getGroupID(value, sectionName);
			clog(debug, timer, 'groupid =', groupid,'getAggregateAttrGroupCost()');
			const aggregateGroupCost = _.chain(ids)
				.map(id=>{
					const isCurrAttr = id == rowID ? true : false;
					const attribute = value[`repeating_attr_${id}_attribute`];
					clog(debug, timer, 'attribute =', attribute);
					clog(debug, timer, 'isCurrAttr =', isCurrAttr);
					const group = parseInt(value[`repeating_attr_${id}_group`]) || 0;
					clog(debug, timer, 'group =', group);
					const activated =  
						parseInt(setObj[`repeating_attr_${id}_activate`]) ||
						parseInt(value[`repeating_attr_${id}_activate`]) || 0;
					clog(debug, timer, 'activated =', activated);
					const attrcost = parseInt(value[`repeating_attr_${id}_totalcost`]) || 0;
					clog(debug, timer, 'attrcost =', attrcost);
					const isGroupMember = group == groupid ? true : false;
					clog(debug, timer, 'isGroupMember =', isGroupMember);
					const isDefect = attribute == 'defect' ? true : false;
					clog(debug, timer, 'isDefect =', isDefect);
					const appliedCost = 
						!isGroupMember ? 0 :
						isDefect ? 0 :
						isCurrAttr ? 0 :
						isPowerFlux && !activated ? 0 :
						attrcost;
					return appliedCost;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			clog(debug, timer, 'aggregateGroupCost =', aggregateGroupCost);//,'getAggregateAttrGroupCost()');
			return aggregateGroupCost;
		}
		
		function getSkillCost(debug, timer, value, name){
			const json = JSON.parse(global_templates_skills_json);
			const skills = json.template;
			const capName = capital(name);
			const skill = _.find(skills, s => {
				const result = s.name === capName ? true : false;
				return result;
			});
			const game_genre = parseInt(value.static_options_selection_gamegenre) || 0;
			clog(debug, timer, `${name} =`, skill.cost[game_genre], 'getSkillCost()');
			return skill.cost[game_genre];
		}
		
		function getAggregateSkillGroupCost(debug, timer, skillIDs, value, rowID, groupID, setObj){
			const result = _.chain(skillIDs)
				.map(id => {
					const group = parseInt(value[`repeating_skill_${id}_group`]) || 0;
					const totalcost = isNaN(parseInt(setObj[`repeating_skill_${id}_totalcost`])) ?
						parseInt(value[`repeating_skill_${id}_totalcost`]) || 0 :
						parseInt(setObj[`repeating_skill_${id}_totalcost`]);
					const appliedCost = group == groupID ? 
						id == rowID ? 0 :
						totalcost : 0;
					return appliedCost;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			clog(debug, timer, 'result =', result, 'getAggregateSkillGroupCost()');
			return result;
		}
		
		function setSkillCostByRankChange(debug, timer, skillIDs, value, rowID, setObj){
			const specilizations = value[`repeating_skill_${rowID}_specializations`] || '';
			clog(debug, timer, 'specilizations =', specilizations, 'setSkillCostByRankChange()');
			const specilizationscost = specilizations === "" ? 0 :
				(specilizations.match(/,/g) || []).length;
			clog(debug, timer, 'specilizationscost =', specilizationscost);
			const groupid = getGroupID(value, 'skill');
			clog(debug, timer, 'groupid =', groupid);
			const skillname = value[`repeating_skill_${rowID}_name`];
			clog(debug, timer, 'skillname =', skillname);
			const skillcost = getSkillCost(debug, timer, value, skillname);
			clog(debug, timer, 'skillcost =', skillcost);
			const skillrank = isNaN(parseInt(setObj[`repeating_skill_${rowID}_level`])) ?
				parseInt(value[`repeating_skill_${rowID}_level`]) || 0 : 
				parseInt(setObj[`repeating_skill_${rowID}_level`]);
			clog(debug, timer, 'skillrank =', skillrank);
			const totalcost = (skillcost * skillrank) + specilizationscost;
			const spent = getAggregateSkillGroupCost(debug, timer, skillIDs, value, rowID, groupid, setObj);
			setObj[`repeating_skill_${rowID}_totalcost`] = totalcost;
			setObj[`static_skillgroup_${groupid}_spent`] = spent + totalcost;
			clog(debug, timer, 'totalcost =', totalcost);//, 'setSkillCostByRankChange()');
			clog(debug, timer, 'spent =', spent);
		}
		
		function setAttrCostByLevelChange(debug, timer, attrdb, eventInfo, value, attrIDs, sectionName, rowID, sourceAttr, setObj) {
			const groupid = getGroupID(value, sectionName);
			const groupType = value[`static_attrgroup_${groupid}_type`] || 'Standard';
			const isPowerFlux = groupType == 'Power Flux';
			const isPowerVariation = groupType == 'Power Variation';
			const groupSourceID = value[`static_attrgroup_${groupid}_source`];
			//const isGroupSourceAttr = groupSourceID == rowID ? true : false;
			const isGroupActive = parseInt(value[`repeating_attr_${groupSourceID}_active`]) || 0;
			const level = parseInt(value[`repeating_attr_${rowID}_level`]) || 0;
			const cost = parseInt(value[`repeating_attr_${rowID}_costperlevel`]) || 0;
			const attrcost = level * cost;
			const isFluxActive = isPowerFlux && isGroupActive ? true : false;
			const aggregateAttrCost = getAggregateAttrGroupCost(debug, timer, attrIDs, value, sectionName, rowID, setObj, isFluxActive);
			const aggregatePoolCost = getAggregatePoolCost(debug, timer, attrIDs, eventInfo, value, sectionName, rowID, setObj);
			const aggregateDefectPoints = getAggregateGroupDefectPoints(debug, timer, attrdb, value);
			const poolSpent = aggregatePoolCost;
			
			const standardcost = aggregateAttrCost + aggregateDefectPoints + attrcost;
			const variationcost = parseInt(value[`static_attrgroup_${groupid}_groupcost`]) || 0;
			const fluxcost = parseInt(value[`repeating_attr_${groupSourceID}_totalcost`]) || 0;	
			const groupCost = 
				isPowerFlux && isGroupActive ? fluxcost : 
				isPowerVariation && isGroupActive ? variationcost :
				standardcost;
			/*
			const groupCost = isPowerFlux ? isGroupActive ? poolCost : 
				isGroupSourceAttr ? attrcost :
				poolCost + aggregateAttrCost + aggregateDefectPoints + attrcost :
				isPowerVariation ? isGroupActive ? lockGroupCost :
				aggregateAttrCost + aggregateDefectPoints + attrcost :
				aggregateAttrCost + aggregateDefectPoints + attrcost;
			*/
			setObj[`repeating_attr_${rowID}_totalcost`] = attrcost;
			clog(debug, timer, 'totalcost =', attrcost, 'setAttrCostByLevelChange()');
			setObj[`static_attrgroup_${groupid}_groupcost`] = groupCost;
			clog(debug, timer, 'groupcost =', groupCost);
			isPowerFlux ? false :
				setObj[`static_attrgroup_${groupid}_spent`] = poolSpent;
			clog(debug, timer, 'spent =', setObj[`static_attrgroup_${groupid}_spent`]);
		}
		
		function getAllAttrNames() {
			const names = [`absorption`, `alternateform`, `alternateidentity`, `armor`, `attackmastery`, `augmented`, `capacity`, `changestate`, `cognition`, `combattechnique`, `companion`, `connected`, `controlenvironment`, `conversion`, `dataaccess`, `defensemastery`, `dimensionwalk`, `dynamicpowers`, `elasticity`, `enemyattack`, `enemydefense`, `energized`, `exorcism`, `extraactions`, `extraarms`, `extradefenses`, `features`, `flight`, `forcefield`, `gear`, `groundspeed`, `healing`, `heightenedawareness`, `heightenedsenses`, `illusion`, `immovable`, `immunity`, `immutable`, `inspire`, `jumping`, `massivedamage`, `meleeattack`, `meleedefense`, `merge`, `metamorphosis`, `mimic`, `mindcontrol`, `mindshield`, `minions`, `mulligan`, `nullify`, `plantcontrol`, `pocketdimension`, `portal`, `powerflux`, `powervariation`, `projection`, `rangedattack`, `rangeddefense`, `regeneration`, `reincarnation`, `resilient`, `sensoryblock`, `shield`, `sixthsense`, `sizechange`, `skill`, `socialmastery`, `spaceflight`, `specialmovement`, `summoncreatures`, `supersense`, `superspeed`, `superstrength`, `swarm`, `telekinesis`, `telepathy`, `teleport`, `tough`, `transfer`, `transmute`, `tunneling`, `unaffected`, `unassailable`, `undetectable`, `uniqueattribute`, `unknownpower`, `waterspeed`, `wealth`, `weapon`];
			return names;
		}
		
		function getStatBase(value, stat) {
			return parseInt(value[`static_stat_base_${stat}`]) || 0;
		}
		
		function getShortcomingRank(debug, timer, attrdb, value, stat) {
			const defectdb = attrdb.defect;
			const aggregateRank = _.chain(defectdb)
				.map(defect => {
					const result = defect.name == 'shortcoming' ? defect.aspect == stat ?
						(parseInt(value[`repeating_attr_${defect.source}_activate`]) || 0) > 0 ?
						defect.rank : 0 : 0 : 0;
					return result;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			clog(debug, timer, 'aggregateRank =', aggregateRank, 'getShortcomingRank()');
			return aggregateRank;
		}
		
		function writeValues(debug, timer, value, key, result, setObj) {
			const isKeyUndefined = 
				key === undefined ? true :
				key === "" ? true :
				key.indexOf('undefined') !== -1 ? true :
				key.indexOf('__') !== -1 ? true :
				false;
			const isResultUndefined =
				result === undefined ? true :
				//result === "" ? true :
				false;
			if (isKeyUndefined || isResultUndefined) {
				const getUndefinedString = 
					isKeyUndefined ? 'key' :
					isResultUndefined ? 'result' :
					'';
				const getValueUndefined = 
					isKeyUndefined ? key :
					isResultUndefined ? result :
					'';
				clog(debug, timer, `${getUndefinedString} is undefined, write cancelled:`, getValueUndefined, 'writeValues()');
				return;
			}
			clog(debug, timer, `setObj.${key} =`, result, 'writeValues()');
			setObj[key] = result;
			const lowerkey = key.toLowerCase();
			clog(debug, timer, `value.${lowerkey} =`, result);
			value[lowerkey] = result;
		}
		
		function setAllAspectStats(debug, timer, eventInfo, attrdb, value, setObj, stat) {
			if (allaspects_stats_array.indexOf(stat) === -1) return;
			const newValue = getStatBase(value, stat);
			const augmented = getSumOfActiveAttrLevels(attrdb, 'augmented', stat) || 0;
			const shortcoming = getShortcomingRank(debug, timer, attrdb, value, stat);
			const result = newValue + augmented - shortcoming;
			writeValues(debug, timer, value, `stat_total_${stat}`, result, setObj);
			clog(debug, timer, 'result =', result, 'setAllAspectStats()');
			setStatCost(debug, timer, eventInfo, value, setObj, stat);
			setStatAspectLevels(debug, timer, attrdb, value, stat, result, setObj)
		}
		
		function setStatAspectLevels(debug, timer, attrdb, value, stat, statbase, setObj) {
			const minorstats = 
				(stat == 'body') ? ['agi', 'con', 'dex', 'str'] :
				(stat == 'mind') ? ['cre', 'int', 'per', 'rea'] :
				(stat == 'soul') ? ['awa', 'cha', 'com', 'wil'] :
				[];
			const result = _.chain(minorstats)
				.map(minorstat => {
					const result = getShortcomingRank(debug, timer, attrdb, value, minorstat);
					return result;
				})
				.map(shortcoming => { 
					return statbase - shortcoming; 
				})
				.value();
			_.each(minorstats, (minorstat, i) => { 
				//setObj[`stat_total_${minorstat}`] = result[i];
				writeValues(debug, timer, value, `stat_total_${minorstat}`, result[i], setObj);
			});
			clog(debug, timer, 'result:', result, 'setStatAspectLevels()');
		}
		
		function getAggregateShortcomingRanks(debug, timer, value, defectdb, stat, setObj) {	
			const result = _.chain(defectdb)
				.map(defect => {
					/*
					const isActive = isNaN(parseInt(setObj[`repeating_attr_${defect.source}_activate`])) ?
						parseInt(value[`repeating_attr_${defect.source}_activate`]) :
						parseInt(setObj[`repeating_attr_${defect.source}_activate`]);
					
					const getIsActive = source => isNaN(source) ? 
						parseInt(value[`repeating_attr_${defect.source}_activate`]) :
						source;
					const isActive = getIsActive(parseInt(setObj[`repeating_attr_${defect.source}_activate`]));
					*/
					const rank = defect.name == 'shortcoming' ? defect.aspect == `${stat}` ?
					//	isActive > 0 ?
						parseInt(defect.rank) : 0 : 0;	
					return rank;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			clog(debug, timer, 'result =', result, 'getAggregateShortcomingRanks()');
			return result;
		}
		
		function getStatAspectLevel(debug, timer, attrdb, value, defectdb, aspect, setObj) {
			const allaspectstat = aspect.length > 3 ?
				aspect : getAllAspectStat(aspect);
			const statbase = getStatBase(value, allaspectstat);
			const augmented = getSumOfActiveAttrLevels(attrdb, 'augmented', allaspectstat) || 0;
			const aggregateShorcomingRanks = getAggregateShortcomingRanks(debug, timer, value, defectdb, aspect, setObj);
			const result = statbase + augmented - aggregateShorcomingRanks;
			clog(debug, timer, `${aspect} =`, result, 'getStatAspectLevel()');
			return result;
		}
		
		function setStatAspectLevel(debug, timer, attrdb, value, defectdb, aspect, setObj) {
			const stataspectlevel = getStatAspectLevel(debug, timer, attrdb, value, defectdb, aspect, setObj);
			if(aspect.length > 3){
				const aspects = stat_aspects_obj[`${aspect}`];
				_.each(aspects, a => {
					const aggregateaspectlevel = getAggregateShortcomingRanks(debug, timer, value, defectdb, a, setObj);
					setObj[`stat_total_${a}`] = stataspectlevel - aggregateaspectlevel;
				})
			}
			setObj[`stat_total_${aspect}`] = stataspectlevel;
			clog(debug, timer, `${aspect} =`, stataspectlevel, 'setStatAspectLevel()');
		}
		
		function getIsMajorAspectInUse(debug, timer, attrdb, value, setObj){
			const defectdb = attrdb.defect;
			const result = _.chain(defectdb)
				.map(defect => {
					const isActive = isNaN(parseInt(setObj[`repeating_attr_${defect.source}_activate`])) ?
						parseInt(value[`repeating_attr_${defect.source}_activate`]) || 0 :
						parseInt(setObj[`repeating_attr_${defect.source}_activate`]);
					const rank = defect.name == 'shortcoming' ? 
						major_stats_regex.test(defect.aspect) ?
						isActive > 0 ?
						parseInt(defect.rank) > 0 ?
						1 : 0 : 0 : 0 : 0;
					return rank;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			const majorAspectInUse = result > 0 ? true : false;
			clog(debug, timer, 'majorAspectInUse =', majorAspectInUse, 'getIsMajorAspectInUse()');
			return majorAspectInUse;
		}
		
		function setStatAspectView(debug, timer, attrdb, value, setObj) {
			const majorAspectInUse = getIsMajorAspectInUse(debug, timer, attrdb, value, setObj);
			const showAllAspectsStats = majorAspectInUse ? 1 : 0;
			const showMajorAspectStats = majorAspectInUse ? 1 : 0;
			setObj.showallaspectsstats = showAllAspectsStats;
			setObj.showmajoraspectstats = showMajorAspectStats;
			clog(debug, timer, 'showallaspectsstats =', showAllAspectsStats, 'setStatAspectView()');
			clog(debug, timer, 'showmajoraspectstats =', showMajorAspectStats);
		}
		
		function setDamageLevelByDamageTaken(debug, timer, value, setObj, sourceAttr) {
			const damage_taken_array = ['wounds','fatigue','maddness','shame','health','energy'];
			if (damage_taken_array.indexOf(sourceAttr) === -1) return;
			const source = 
				`${sourceAttr}` == "wounds" ? "health" : 
				`${sourceAttr}` == "fatigue" ? "energy" : 
				`${sourceAttr}` == "maddness" ? "sanity" : 
				`${sourceAttr}` == "shame" ? "social" : 
				`${sourceAttr}`;
			const damage = 
				parseInt(value[`static_stat_total_${sourceAttr}`]) || 0;
			const health = 
				parseInt(setObj[`stat_total_${source}`]) || 
				parseInt(value[`stat_total_${source}`]) || 0;
			let status = Math.floor(10 - (damage / health) * 10);
			status = (damage < 1) ? 10 : status;
			status = (status < 0) ? 0 : status;
			setObj[`${source}`] = status;
			clog(debug, timer, `${sourceAttr} =`, status, 'setDamageLevelByDamageTaken()');
		}
		
		function setDamageLevelByTempChange(debug, timer, value, setObj, sourceAttr) {
			//const isDamage = /(health|energy)/i.test(`${sourceAttr}`); if (!isDamage) return;
			const temp_stat_array = ['health','energy'];
			if (temp_stat_array.indexOf(sourceAttr) === -1) return;
			let source = (`${sourceAttr}` == "health") ? "wounds" : (`${sourceAttr}` == "energy") ? "fatigue" : 0,
				damage = parseInt(value[`static_stat_total_${source}`]) || 0,
				health = parseInt(setObj[`stat_total_${sourceAttr}`]) || parseInt(value[`stat_total_${sourceAttr}`]) || 0,
				status = Math.floor(10 - (damage / health) * 10);
			status = (damage < 1) ? 10 : status;
			status = (status < 0) ? 0 : status;
			setObj[`${sourceAttr}`] = status;
			clog(debug, timer, 'status =', status, 'setDamageLevelByTempChange()');
		}
		
		function setDerivedValue(debug, timer, attrdb, value, setObj, derivedvalue = '') {
			const derived_values_array = ['health','energy','sanity','social'];
			if (derived_values_array.indexOf(derivedvalue) === -1) return;
			const stat = (derivedvalue == 'health') ? 'body' : 'mind';
			const bodyormind = parseInt(setObj[`stat_total_${stat}`]) || 
				parseInt(value[`stat_total_${stat}`]) || 0;
			const soul = parseInt(setObj.stat_total_soul) || 
				parseInt(value.stat_total_soul) || 0;
			const attribute = 
				(derivedvalue == 'health') ? 'tough' : 
				(derivedvalue == 'energy') ? 'energized' : 
				(derivedvalue == 'sanity') ? 'unassailable' : 
				(derivedvalue == 'social') ? 'socialmastery' : 
				'';
			const multiplier = attribute === 'tough' || attribute === 'energized' ? 10 : 2;
			const bonusattribute = attrdb[`${attribute}`];
			const bonus = _.chain(bonusattribute)
				.map(o => {
					const result = parseInt(o.level) * multiplier || 0;
					return result;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			const temp = parseInt(setObj[`static_stat_temp_${derivedvalue}`]) || 
				parseInt(value[`static_stat_temp_${derivedvalue}`]) || 0;
			const result = 
				derivedvalue == 'health' || derivedvalue == 'energy' ? 
					(bodyormind + soul) * 5 + bonus + temp : 
				derivedvalue == 'sanity' ? 
					(bodyormind + soul) + bonus + temp : 
				derivedvalue == 'social' ? 
					Math.round((bodyormind + soul) / 2) + bonus + temp :
				0;
			writeValues(debug, timer, value, `stat_total_${derivedvalue}`, result, setObj);
			clog(debug, timer, derivedvalue, result, 'setDerivedValue()');
		}
		
		function setTotalShock(debug, timer, value, attrdb, setObj) {
			const health = 
				parseInt(setObj.stat_total_health) || 
				parseInt(value.stat_total_health) || 0;
			const hardboiled = 
				getSumOfActiveSubAttrRanks(attrdb, 'combattechnique', 'hardboiled') || 0;
			const result = Math.round(health / 5) + hardboiled;
			writeValues(debug, timer, value, 'stat_total_shock', result, setObj);
			clog(debug, timer, 'result =', result, 'setTotalShock()');
		}
		
		function setTotalMovement(debug, timer, value, attrdb, setObj) {
			const body = 
				parseInt(setObj.stat_total_body) || 
				parseInt(value.stat_total_body) || 0;
			const fast = 
				getSumOfActiveSubAttrRanks(attrdb, 'specialmovement', 'fast') || 0;
			const move = (fast > 0) ? body * (2 * fast) : body || 0;
			const walk_swim = move;
			const jog = Math.ceil(move * 1.5);
			const jump = Math.ceil(move * 0.25);
			const jumpup = Math.ceil(move * 0.125);
			const run_swimsprint = move * 2;
			const sprint = move * 4;
			setObj.stat_total_walk = walk_swim;
			setObj.stat_total_leap = walk_swim;
			setObj.stat_total_jog = jog;
			setObj.stat_total_jump = jump;
			setObj.stat_total_jumpup = jumpup;
			setObj.stat_total_run = run_swimsprint;
			setObj.stat_total_swim = walk_swim;
			setObj.stat_total_sprint = sprint;
			setObj.stat_total_sswim = run_swimsprint;
			clog(debug, timer, 'movement_base =', move, 'setTotalMovement()');
		}
		
		function setAttrVisibilityByGroup(value, eventInfo, attrIDs, setObj, sectionName) {
			const section = sectionName.substring(0, sectionName.length - 5);
			_.each(attrIDs, (id) => {
				const group = parseInt(value[`repeating_${section}_${id}_group`]) || 0;
				const currGroup = eventInfo.newValue.substring(sectionName.length);
				const visible = group == currGroup ? 0 : 1;
				setObj[`repeating_${section}_${id}_visible`] = visible;
			});
		}
		
		function isPowerFlux(attribute) {
			const result = (attribute == "power flux") ? true : false;
			return result;
		}
		
		function isPowerVariation(attribute) {
			const result = (attribute == "power variation") ? true : false;
			return result;
		}
		
		function convertToDynamicGroup(debug, timer, attrIDs, attrdb, eventInfo, value, rowID, setObj){
			const groupType = eventInfo.newValue;
			clog(debug, timer, 'groupType =', groupType,'convertToDynamicGroup()');
			const convert = 
				groupType.indexOf('flux') !== -1 ?
					makeGroupPowerFlux(debug, timer, attrIDs, attrdb, eventInfo, value, rowID, setObj) :
				groupType.indexOf('variation') !== -1 ?
					makeGroupPowerVariation(debug, timer, attrIDs, attrdb, eventInfo, value, rowID, setObj) :
				false;
			clog(debug, timer, 'convert =', convert);
			if (!convert) return;
			clog(debug, timer, 'rowID =', rowID);
			setObj[`static_attrgroup_${getGroupID(value, 'attr')}_source`] = rowID;
			value[`static_attrgroup_${getGroupID(value, 'attr')}_source`] = rowID;
		}
		
		function makeGroupPowerFlux(debug, timer, attrIDs, attrdb, eventInfo, value, rowID, setObj){
			const groupid = getGroupID(value, 'attr');
			const aggregateAttrCost = getAggregateAttrGroupCost(debug, timer, attrIDs, value, 'attr', rowID, setObj);
			const aggregateDefectPoints = getAggregateGroupDefectPoints(debug, timer, attrdb, value);
			const aggregatePoolCost = getAggregatePoolCost(debug, timer, attrIDs, eventInfo, value, 'attr', rowID, setObj);
			clog(debug, timer, 'groupid =', groupid,'makeGroupPowerFlux()');
			setObj[`static_attrgroup_${groupid}_changemax`] = 0;
			setObj[`static_attrgroup_${groupid}_changegroup`] = 1;
			setObj[`static_attrgroup_${groupid}_pointype`] = 'Flux Points';
			setObj[`static_attrgroup_${groupid}_type`] = 'Power Flux';
			setObj[`static_attrgroup_${groupid}_spent`] = aggregatePoolCost;
			setObj[`static_attrgroup_${groupid}_groupcost`] = aggregateAttrCost + aggregateDefectPoints;
			return true;
		}
		
		function makeGroupPowerVariation(debug, timer, attrIDs, attrdb, eventInfo, value, rowID, setObj){
			const groupid = getGroupID(value, 'attr');
			const aggregateAttrCost = getAggregateAttrGroupCost(debug, timer, attrIDs, value, 'attr', rowID, setObj);
			const aggregateDefectPoints = getAggregateGroupDefectPoints(debug, timer, attrdb, value);
			const aggregatePoolCost = getAggregatePoolCost(debug, timer, attrIDs, eventInfo, value, 'attr', rowID, setObj);
			setObj[`static_attrgroup_${groupid}_changemax`] = 1;
			setObj[`static_attrgroup_${groupid}_changegroup`] = 1;
			setObj[`static_attrgroup_${groupid}_pointype`] = 'Character Points';
			setObj[`static_attrgroup_${groupid}_type`] = 'Power Variation';
			setObj[`static_attrgroup_${groupid}_spent`] = aggregatePoolCost;
			setObj[`static_attrgroup_${groupid}_groupcost`] = aggregateAttrCost + aggregateDefectPoints;
			return true;
		}
		
		function convertToStandardGroup(debug, timer, attrIDs, attrdb, value, rowID, setObj){
			const groupid = getGroupID(value, 'attr');
			const aggregateAttrCost = getAggregateAttrGroupCost(debug, timer, attrIDs, value, 'attr', rowID, setObj);
			const aggregateDefectPoints = getAggregateGroupDefectPoints(debug, timer, attrdb, value);
			clog(debug, timer, 'groupid', groupid, 'convertToStandardGroup()');
			setObj[`static_attrgroup_${groupid}_changemax`] = 0;
			setObj[`static_attrgroup_${groupid}_changegroup`] = 0;
			setObj[`static_attrgroup_${groupid}_groupmax`] = 0;
			setObj[`static_attrgroup_${groupid}_spent`] = 0;
			setObj[`static_attrgroup_${groupid}_pointype`] = '';
			setObj[`static_attrgroup_${groupid}_type`] = '';
			setObj[`static_attrgroup_${groupid}_source`] = '';
			setObj[`static_attrgroup_${groupid}_groupcost`] = aggregateAttrCost + aggregateDefectPoints;
		}
		
		function setGroupType(debug, timer, attrIDs, attrdb, eventInfo, value, sectionName, rowID, setObj){
			const dynamicGroup = attr => dymanicGrouRegex.test(attr);
			const isDynamic = dynamicGroup(eventInfo.newValue);
			const wasDynamic = dynamicGroup(eventInfo.previousValue);
			if(!isDynamic && !wasDynamic){
				return;
			}else if(!isDynamic && wasDynamic){
				convertToStandardGroup(debug, timer, attrIDs, attrdb, value, rowID, setObj);
			}else{
				convertToDynamicGroup(debug, timer, attrIDs, attrdb, eventInfo, value, rowID, setObj);
			}
			cleanupCosts(debug, timer, attrIDs, attrdb, value, sectionName, rowID, setObj);
		}
		
		function setAttrGroupType(debug, groupid, grouptype, setObj, sourceAttr) {
			switch (grouptype) {
				case `standard`: //standard
					setObj[`static_attrgroup_${groupid}_changegroup`] = 0;
					setObj[`static_attrgroup_${groupid}_pointype`] = "";
					setObj[`static_attrgroup_${groupid}_type`] = "Standard";
					break;
				case `power flux`: //power flux
					setObj[`static_attrgroup_${groupid}_changegroup`] = 1;
					setObj[`static_attrgroup_${groupid}_pointype`] = "Flux Points";
					setObj[`static_attrgroup_${groupid}_type`] = "Power Flux";
					break;
				case `power variation`: //power variation
					setObj[`static_attrgroup_${groupid}_changegroup`] = 1;
					setObj[`static_attrgroup_${groupid}_pointype`] = "Character Points";
					setObj[`static_attrgroup_${groupid}_type`] = "Power Variation";
					break;
				default:
					setObj[`static_attrgroup_${groupid}_changegroup`] = 0;
					setObj[`static_attrgroup_${groupid}_pointype`] = "";
					setObj[`static_attrgroup_${groupid}_type`] = "Standard";
			}
		}
		
		function removePoolCpFromGroupCost(value, source, setObj) {
			let type = parseInt(value[`${source}_type`]) || 0;
			if (type < 3) {
				let groupcost = setObj[`${source}_groupcost`] - setObj[`${source}_poolcp`];
				setObj[`${source}_groupcost`] = groupcost;
			}
		}
		
		function setPoolCp(value, source, setObj) {
			let type = parseInt(value[`${source}_type`]) || 0,
				level = parseInt(value[`${source}_grouplevel`]) || 0,
				groupenhancement = parseInt(value[`${source}_groupmodification`]) || 0,
				groupmax = (type == 2) ? (level - groupenhancement) * 10 : 0;
			setObj[`${source}_groupmax`] = groupmax;
		}
		
		function setLevelElevation(eventInfo, source, target, setObj) {
			const level = parseInt(eventInfo.newValue) || 0;
			if (level == 7) { 
				setObj[`${source}_${target}`] = 1; 
			} else if (level < 7) { 
				setObj[`${source}_${target}`] = 0; 
			}
		}
		
		function setPoolCost(debug, timer, eventInfo, value, setObj, source, sourceAttr) {
			//const isSkill = /skill/i.test(source);
			const isSkill = source.indexOf('skill') !== -1 ? true : false;
			const newlevel = parseInt(eventInfo.newValue) || 0;
			const previouslevel = parseInt(eventInfo.previousValue) || 0;
			const poolenhancement = parseInt(value[`${source}_groupmodification`]) || 0;
			const groupcost = parseInt(value[`${source}_groupcost`]) || 0;
			const type = parseInt(value[`${source}_type`]) || 0;
			const groupmax = 
				type == 2 ? 
					(newlevel - poolenhancement) * 5 : 
				type == 3 ? 
					parseInt(value[`${source}_groupmax`]) || 0 : 
				isSkill ? newlevel * 10 : 0;
			setLevelElevation(eventInfo, `${source}`, `poollevelelevation`, setObj);
			const newgroupcost = 
				groupcost + ((newlevel * groupcost) - (previouslevel * groupcost));
			setObj[`${source}_groupmax`] = groupmax;
			setObj[`${source}_groupcost`] = newgroupcost;
			clog(debug, timer, 'groupmax =', groupmax, 'setPoolCost()');
			clog(debug, timer, 'newgroupcost =', newgroupcost);
		}
		
		function isDynamicGroup(value, sectionName) {
			const groupid = getGroupID(value, sectionName);
			//const result = /(flux|variation)/i.test(value[`static_attrgroup_${groupid}_type`]);
			const groupType = value[`static_attrgroup_${groupid}_type`];
			const result = dynamic_group_array.indexOf(groupType.toLowerCase()) !== -1 ? true : false;
			return result;
		}
		
		function getGroupID(value, sectionName) {
			return parseInt(value[`static_${sectionName}group_selected_tab`].replace(/\D/ig, '')) || 0;
		}
		
		function resetOnAlreadyDynamicGroup(debug, timer, eventInfo, value, sectionName, match, source, rowID, setObj) {
			const attribute = value[`${source}_attribute`];
			const isDynamicAttr = 
				attribute.toLowerCase().indexOf('flux') !== -1 || 
				attribute.toLowerCase().indexOf('variation') !== -1 ? true : false;
			let debugtext = '';
			let result = false;
			if (isDynamicAttr && isDynamicGroup(value, sectionName)) {
				setObj[`${match}`] = eventInfo.previousValue;
				clog(debug, timer, 'setObj:', setObj, 'Changes To Sheet Values', 'info');
				setAttrs(setObj,{silent:true});
				clog(debug, timer, 'Changes written to sheet', '', 'setAttrs()', 'info');
				result = true;
				debugtext = `Group is dynamic, resetting attribute selection`;
			} else {
				debugtext = `Group is not dynamic`;
			}
			clog(debug, timer, debugtext, '','resetOnAlreadyDynamicGroup()]');
			return result;
		}
		
		function setGroupMembership(debug, timer, value, setObj, source, sectionName) {
			const tab = value[`static_${sectionName}group_selected_tab`];
			clog(debug, timer, 'tab =', tab, 'setGroupMembership()');
			const currGroup = tab.replace(/attrgroup/g, '');
			clog(debug, timer, 'currGroup =', currGroup);
			//setObj[`${source}_new`] = 0;
			//setObj[`${source}_group`] = currGroup;
			//writeValues(debug, timer, value, `${source}_new`, 0, setObj);
			writeValues(debug, timer, value, `${source}_group`, currGroup, setObj);
		}
		
		function resetOnActive(debug, timer, eventInfo, value, match, rowID, setObj) {
			const activate = parseInt(value[`repeating_attr_${rowID}_activate`]) || 0;
			const reset = (eventInfo.previousValue == eventInfo.newValue) ? 0 : eventInfo.previousValue;
			if (activate) {
				clog(debug, timer, 'attribute is active, exiting', '', 'resetOnActive()');
				setObj[`${match}`] = reset;
				clog(debug, timer, 'setObj:', setObj, 'Changes To Sheet Values', 'info');
				setAttrs(setObj,{silent:true});
				clog(debug, timer, 'Changes written to sheet', '', 'setAttrs()', 'info');
				return true;
			} else { return false; }
		}
		
		function resetOnLocked(debug, timer, eventInfo, value, match, rowID, setObj) {
			const locked = parseInt(value[`repeating_attr_${rowID}_lock`]) || 0;
			const reset = (eventInfo.previousValue == eventInfo.newValue) ? 0 : eventInfo.previousValue;
			if (locked) {
				clog(debug, timer, 'attribute is locked, exiting', '', 'resetOnLocked()');
				setObj[`${match}`] = reset;
				clog(debug, timer, 'setObj:', setObj, 'Changes To Sheet Values', 'info');
				setAttrs(setObj);
				clog(debug, timer, 'Changes written to sheet', '', 'setAttrs()', 'info');
				return true;
			} else { return false; }
		}
		
		function getIsLocked(debug, timer, value, rowID, sourceAttr) {
			const result = (parseInt(value[`repeating_attr_${rowID}_lock`]) || 0) ? true : false;
			clog(debug, timer, 'result =', result, 'getIsLocked()');
			return result;
		}
		
		function resetOnLevelNotZero(debug, timer, eventInfo, value, match, rowID, setObj) {
			const level = parseInt(value[`repeating_attr_${rowID}_level`]) || 0;
			const elevel = parseInt(value[`repeating_attr_${rowID}_effectivelevel`]) || 0;
			const reset = (eventInfo.previousValue == eventInfo.newValue) ? 0 : eventInfo.previousValue;
			if (level || elevel) {
				clog(debug, timer, 'can‘t change Attribute when Level or Effective Level is greater than 0, exiting', '', 'resetOnLevelNotZero()');
				setObj[`${match}`] = reset;
				clog(debug, timer, 'setObj:', setObj, 'Changes To Sheet Values', 'info');
				setAttrs(setObj,{silent:true});
				clog(debug, timer, 'Changes written to sheet', '', 'setAttrs()', 'info');
				return true;
			} else { return false; }
		}
		
		function resetOnNoAttr(debug, timer, timer, eventInfo, value, match, rowID, setObj) {
			if (eventInfo.sourceType === "sheetworker") return;
			const attr = value[`repeating_attr_${rowID}_attribute`] || '';
			if (attr.length == 0) {
				clog(debug, timer, 'can‘t change Level when no Attribute is selected, exiting', '', 'resetOnNoAttr()');
				setObj[`${match}`] = 0;
				clog(debug, timer, 'setObj:', setObj, 'Changes To Sheet Values', 'info');
				setAttrs(setObj,{silent:true});
				clog(debug, timer, 'Changes written to sheet', '', 'setAttrs()', 'info');
				return true;
			} else { return false; }
		}
		
		function setAttrCostPerLevel(debug, timer, value, rowID, setObj) {
			let attribute = value[`repeating_attr_${rowID}_attribute`],
				obj = {
					"absorption": 5,
					"alternateform": 4,
					"alternate identity": 1,
					"armor": 2,
					"attack mastery": 1,
					"augmented": 4,
					"capacity": 1,
					"change state": 3,
					"cognition": 2,
					"combat technique": 1,
					"companion": 4,
					"connected": 1,
					"control environment": 1,
					"conversion": 3,
					"data access": 2,
					"defense mastery": 1,
					"dimension walk": 5,
					"dynamic powers": 10,
					"elasticity": 4,
					"enemy attack": 1,
					"enemy defense": 1,
					"energized": 1,
					"exorcism": 1,
					"extra actions": 4,
					"extra arms": 1,
					"extra defenses": 2,
					"features": 1,
					"flight": 3,
					"forcefield": 4,
					"gear": 1,
					"ground speed": 1,
					"healing": 1,
					"heightened awareness": 1,
					"heightened senses": 1,
					"illusion": 1,
					"immovable": 1,
					"immunity": 3,
					"immutable": 1,
					"inspire": 1,
					"jumping": 1,
					"massive damage": 3,
					"melee attack": 1,
					"melee defense": 1,
					"merge": 4,
					"metamorphosis": 2,
					"mimic": 2,
					"mind control": 5,
					"mind shield": 1,
					"minions": 2,
					"mulligan": 1,
					"nullify": 5,
					"plant control": 1,
					"pocket dimension": 1,
					"portal": 2,
					"power flux": 10,
					"power variation": 4,
					"projection": 3,
					"ranged attack": 1,
					"ranged defense": 1,
					"regeneration": 5,
					"reincarnation": 2,
					"resilient": 2,
					"sensory block": 1,
					"shield": 2,
					"sixth sense": 1,
					"size change": 10,
					"skill": 1,
					"social mastery": 1,
					"spaceflight": 1,
					"special movement": 1,
					"summon creatures": 2,
					"supersense": 1,
					"superspeed": 3,
					"superstrength": 4,
					"swarm": 2,
					"telekinesis": 4,
					"telepathy": 3,
					"teleport": 3,
					"tough": 1,
					"transfer": 3,
					"transmute": 3,
					"tunneling": 1,
					"unaffected": 2,
					"unassailable": 1,
					"undetectable": 2,
					"unique attribute": 0,
					"unknown power": 1,
					"water speed": 1,
					"wealth": 3,
					"weapon": 2,
					"default": 0
				},
				result = (obj[attribute] || obj["default"]);
			clog(debug, timer, 'result:', result,'setAttrCostPerLevel()');
			setObj[`repeating_attr_${rowID}_costperlevel`] = result;
		}
		
		function getAttrCostPerLevel(debug, timer, value, rowID) {
			const attribute = value[`repeating_attr_${rowID}_attribute`];
			const obj = {
				"absorption": 5,
				"alternate form": 4,
				"alternate identity": 1,
				"armor": 2,
				"attack mastery": 1,
				"augmented": 4,
				"capacity": 1,
				"change state": 3,
				"cognition": 2,
				"combat technique": 1,
				"companion": 4,
				"connected": 1,
				"control environment": 1,
				"conversion": 3,
				"data access": 2,
				"defense mastery": 1,
				"dimension walk": 5,
				"dynamic powers": 10,
				"elasticity": 4,
				"enemy attack": 1,
				"enemy defense": 1,
				"energized": 1,
				"exorcism": 1,
				"extra actions": 4,
				"extra arms": 1,
				"extra defenses": 2,
				"features": 1,
				"flight": 3,
				"forcefield": 4,
				"gear": 1,
				"ground speed": 1,
				"healing": 1,
				"heightened awareness": 1,
				"heightened senses": 1,
				"illusion": 1,
				"immovable": 1,
				"immunity": 3,
				"immutable": 1,
				"inspire": 1,
				"jumping": 1,
				"massive damage": 3,
				"melee attack": 1,
				"melee defense": 1,
				"merge": 4,
				"metamorphosis": 2,
				"mimic": 2,
				"mind control": 5,
				"mind shield": 1,
				"minions": 2,
				"mulligan": 1,
				"nullify": 5,
				"plant control": 1,
				"pocket dimension": 1,
				"portal": 2,
				"power flux": 10,
				"power variation": 4,
				"projection": 3,
				"ranged attack": 1,
				"ranged defense": 1,
				"regeneration": 5,
				"reincarnation": 2,
				"resilient": 2,
				"sensory block": 1,
				"shield": 2,
				"sixth sense": 1,
				"size change": 10,
				"skill": 1,
				"social mastery": 1,
				"spaceflight": 1,
				"special movement": 1,
				"summon creatures": 2,
				"supersense": 1,
				"superspeed": 3,
				"superstrength": 4,
				"swarm": 2,
				"telekinesis": 4,
				"telepathy": 3,
				"teleport": 3,
				"tough": 1,
				"transfer": 3,
				"transmute": 3,
				"tunneling": 1,
				"unaffected": 2,
				"unassailable": 1,
				"undetectable": 2,
				"unique attribute": parseInt(value[`repeating_attr_${rowID}_uniqueattributecost`]),
				"unknown power": 1,
				"water speed": 1,
				"wealth": 3,
				"weapon": 2,
				"default": 0
			};
			const result = (obj[attribute] || obj["default"]);
			clog(debug, timer, 'result =', result, 'getAttrCostPerLevel()');
			return result;
		}
		
		function setDefectCharacteristic(debug, timer,attrdb, value, rowID, setObj){
			const defect = value[`repeating_attr_${rowID}_defect`];
			const defectid = removeWhiteSpace(defect);
			const shortcoming = value[`repeating_attr_${rowID}_defectaspect`];
			const rank = parseInt(value[`repeating_attr_${rowID}_rank`]) || 0;
			const shortcomingCharacteristics = {
				"body": `Body -${rank}`,
				"mind": `Mind -${rank}`,
				"soul": `Soul -${rank}`,
				"agi": `Agility -${rank}`,
				"con": `Constitution -${rank}`,
				"dex": `Dexterity -${rank}`,
				"str": `Strength -${rank}`,
				"cre": `Creativity -${rank}`,
				"int": `Intellect -${rank}`,
				"per": `Perception -${rank}`,
				"rea": `Reasoning -${rank}`,
				"awa": `Awareness -${rank}`,
				"cha": `Charisma -${rank}`,
				"com": `Composure -${rank}`,
				"wil": `Willpower -${rank}`
			};
			const defectCharacteristics = {
				"achillesheel":{
					1: "rare attack form",
					2: "uncommon attack form",
					3: "common attack form",
					"default": ""
				},
				"awkwardsize":{
					0: "Medium",
					1: "Large",
					2: "Huge",
					3: "Mammoth",
					4: "Gigantic",
					5: "Gargantuan",
					6: "Colossal",
					7: "Enormous",
					8: "Monstrous",
					9: "Titanic",
					10: "Monumental"
				},
				"bane":{
					1: "10 damage/round exposed",
					2: "20 damage/round exposed",
					3: "30 damage/round exposed",
					"default": ""
				},
				"blindfury":{
					1: "difficult initiate; easy revert",
					2: "moderately difficult initiate/revert",
					3: "easy initiate; difficult revert",
					"default": ""
				},
				"conditionalownership":{
					1: "mild conditions",
					2: "strict conditions",
					3: "severe conditions",
					"default": ""
				},
				"confined":{
					1: "large area (100 km radius)",
					2: "moderate area (1 km radius)",
					3: "small area (100 m radius)",
					"default": ""
				},
				"cursed":{
					1: "slight disadvantage",
					2: "moderate disadvantage",
					3: "severe disadvantage",
					"default": ""
				},
				"demure":{
					1: "Social Combat Value -2",
					2: "Social Combat Value -4",
					3: "Social Combat Value -6",
					"default": ""
				},
				"easilydistracted":{
					1: "triggered infrequently",
					2: "triggered frequently",
					3: "triggered constantly",
					"default": ""
				},
				"fragile":{
					1: "Health Points -10",
					2: "Health Points -20",
					3: "Health Points -30",
					"default": ""
				},
				"hounded":{
					1: "slightly inconvenient",
					2: "moderately inconvenient",
					3: "severely inconvenient",
					"default": ""
				},
				"impairedmanipulation":{
					1: "only one usable arm",
					2: "rudimentary manipulative ability",
					3: "no usable arms",
					"default": ""
				},
				"impairedspeech":{
					1: "severe speech impediment",
					2: "sounds that carry emotional content",
					3: "completely mute",
					"default": ""
				},
				"ineptattack":{
					1: "-1 Attack Combat Value",
					2: "-2 Attack Combat Value",
					3: "-3 Attack Combat Value",
					"default": ""
				},
				"ineptdefence":{
					1: "-1 Defence Combat Value",
					2: "-2 Defence Combat Value",
					3: "-3 Defence Combat Value",
					"default": ""
				},
				"involuntarychange":{
					1: "Difficult to trigger",
					2: "Moderately easy to trigger",
					3: "Easy to trigger",
					"default": ""
				},
				"ism":{
					1: "slight discrimination",
					2: "moderate discrimination",
					3: "severe discrimination",
					"default": ""
				},
				"magnet":{
					1: "few adoring fans",
					2: "handful of adoring fans",
					3: "swarms of adoring fans",
					"default": ""
				},
				"marked":{
					1: "easily concealable",
					2: "concealed with moderate difficulty",
					3: "cannot be concealed in most circumstances",
					"default": ""
				},
				"nemesis":{
					1: "interferes infrequently",
					2: "interferes frequently",
					3: "interferes constantly",
					"default": ""
				},
				"nightmares":{
					1: "occur infrequently",
					2: "occur frequently",
					3: "occur constantly",
					"default": ""
				},
				"nohealing":{
					1: "healing/recovery at slight disadvantage",
					2: "healing/recovery at moderate disadvantage",
					3: "healing/recovery at severe disadvantage",
					"default": ""
				},
				"obligated":{
					1: "small obligation",
					2: "moderate obligation",
					3: "large obligation",
					"default": ""
				},
				"phobia":{
					1: "slight- encountered infrequently",
					2: "moderate- encountered frequently",
					3: "severe- encountered constantly",
					"default": ""
				},
				"physicalimpairment":{
					1: "slight inconvenience",
					2: "moderate inconvenience",
					3: "severe inconvenience",
					"default": ""
				},
				"redtape":{
					1: "generally easy to manage",
					2: "moderately difficult to manage",
					3: "difficult to manage",
					"default": ""
				},
				"reduceddamage":{
					1: "Damage Multiplier -1",
					2: "Damage Multiplier -2",
					3: "Damage Multiplier -3",
					"default": ""
				},
				"sensoryimpairment":{
					1: "minor obstacle",
					2: "major obstacle",
					3: "loss of sense",
					"default": ""
				},
				"significantother":{
					1: "appears infrequently",
					2: "appears frequently",
					3: "appears constantly",
					"default": ""
				},
				"skeletoninthecloset":{
					1: "difficult to discover",
					2: "moderately easy to discover",
					3: "easy to discover",
					"default": ""
				},
				"socialfault":{
					1: "slight disadvantage",
					2: "moderate disadvantage",
					3: "severe disadvantage",
					"default": ""
				},
				"specialrequirement":{
					1: "easy/infrequent",
					2: "moderately difficult/frequent",
					3: "difficult/constant",
					"default": ""
				},
				"unappealing":{
					1: "slightly",
					2: "moderately",
					3: "severely",
					"default": ""
				},
				"unique":{
					1: "infrequent/slight effect",
					2: "frequent/moderate effect",
					3: "constant/severe effect",
					"default": ""
				},
				"unsettled":{
					1: "Sanity Points -2",
					2: "Sanity Points -4",
					3: "Sanity Points -6",
					"default": ""
				},
				"vulnerability":{
					1: "drop by one quarter",
					2: "drop by one half",
					3: "cannot be used",
					"default": ""
				},
				"wanted":{
					1: "incentive offered is slight",
					2: "incentive offered is moderate",
					3: "incentive offered is extreme",
					"default": ""
				},
				"weakpoint":{
					1: "difficult to hit",
					2: "moderately easy to hit",
					3: "easy to hit",
					"default": ""
				}
			};
			const characteristic = defect == 'shortcoming' ?
				shortcomingCharacteristics[`${shortcoming}`] :
				defectCharacteristics[`${defectid}`][rank] || 
				defectCharacteristics[`${defectid}`]["default"];
			const result = `${capital(defect)}, ${characteristic}`;
			clog(debug, timer, 'characteristic =', result, 'setDefectCharacteristic()');
			setObj[`repeating_attr_${rowID}_characteristic`] = result;
		}
		
		function setAttrCharacteristic(debug, timer, value, rowID, setObj) {
			const attribute = removeWhiteSpace(value[`repeating_attr_${rowID}_attribute`]);
			if (attribute === 'defect') return;
			const level = isNaN(parseInt(setObj[`repeating_attr_${rowID}_effectivelevel`])) ?
				parseInt(value[`repeating_attr_${rowID}_effectivelevel`]) || 0 :
				parseInt(setObj[`repeating_attr_${rowID}_effectivelevel`]) || 0;
			let characteristic = "";
			switch (attribute) {
				case "absorption": characteristic = `${level * 5} Damage Absorbed`; break;
				case "alternateform": characteristic = `${level * 5} Character Points`; break;
				case "alternateidentity": characteristic = `${level} Alternate Identities`; break;
				case "armor": characteristic = `${level * 5} Armor Rating`; break;
				case "attackmastery": characteristic = `ACV +${level}`; break;
				case "augmented": const stat = value[`repeating_attr_${rowID}_augmentedstat`]; characteristic = `${stat} +${level}`; break;
				case "capacity": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "changestate": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "cognition": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "combattechnique": characteristic = `${level} Techniques Remaining`; break;
				case "companion": characteristic = `${level * 10} Character Points`; break;
				case "connected": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "controlenvironment": characteristic = getCharacteristicByCustomizations(debug, timer, value, rowID, attribute); break;
				case "conversion": characteristic = `${level} Character Points/10 Damage`; break;
				case "dataaccess": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "defensemastery": characteristic = `DCV +${level}`; break;
				case "dimensionwalk": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "dynamicpowers": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "elasticity": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "enemyattack": characteristic = `ACV +${level * 2} vs. ${getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute)}`; break;
				case "enemydefense": characteristic = `DCV +${level * 2} vs. ${getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute)}`; break;
				case "energized": characteristic = `Energy Points +${level * 10}`; break;
				case "exorcism": characteristic = `Soul +${level * 2}`; break;
				case "extraactions": characteristic = `+${level} additional actions each round`; break;
				case "extraarms": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "extradefenses": characteristic = `+${level} defensive actions each round`; break;
				case "features": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "flight": characteristic = `Flight speed up to ${get1or3(level, 1) * (10 ** (Math.ceil((level) / 2)))} kph`; break;
				case "forcefield": characteristic = `${level * 10} Armor Rating`; break;
				case "gear": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "groundspeed": characteristic = `${level} kph`; break;
				case "healing": characteristic = `Restore ${level * 5} Health Points`; break;
				case "heightenedawareness": characteristic = `${level} Awareness Bonus`; break;
				case "heightenedsenses": characteristic = `${level} Senses Remaining`; break;
				case "illusion": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "immovable": characteristic = `Knockback reduced by ${level * 10} m`; break;
				case "immunity": characteristic = `Immune to ${getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute)}`; break;
				case "immutable": const immutablestat = getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute); characteristic = `+${level * 2} ${capital(immutablestat)} roll to resist effects`; break;
				case "inspire": characteristic = `Stat/Skill Rolls +${level}`; break;
				case "jumping": characteristic = `${get1or3(level, 3) * (10 ** (Math.ceil((level - 1) / 2)))} Times Normal Distance`; break;
				case "massivedamage": characteristic = setMassiveDamageCharacteristic(debug, timer, value, rowID, level, setObj); break;
				case "meleeattack": characteristic = `ACV +${level * 2} with ${getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute)} weapons`; break;
				case "meleedefense": characteristic = `DCV +${level * 2} with ${getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute)} weapons`; break;
				case "merge": characteristic = `Contribute ${level * 10} Character Points`; break;
				case "metamorphosis": characteristic = `Race Template +/- ${level * 5} Character Points`; break;
				case "mimic": characteristic = `Mimic Level ${level} Attributes`; break;
				case "mindcontrol": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "mindshield": characteristic = `${level} + Mind`; break;
				case "minions": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "mulligan": characteristic = `${level * 2} re-rolls each game session`; break;
				case "nullify": characteristic = `Nullify ${level} Levels of an attribute`; break;
				case "plantcontrol": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "pocketdimension": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "portal": characteristic = `${level} one-way portals`; break;
				case "powerflux": characteristic = `${level * 5} Flux Points`; break;
				case "powervariation": characteristic = `${level + 1} Variable Attributes`; break;
				case "projection": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "rangedattack": characteristic = `ACV +${level * 2} with ${getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute)} weapons`; break;
				case "rangeddefense": characteristic = `DCV +${level * 2} ${getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute)} Ranged Defense`; break;
				case "regeneration": characteristic = `Regenerate ${level * 5} Heath Points/Round`; break;
				case "reincarnation": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "resilient": characteristic = `${level} Resiliencies Remaining`; break;
				case "sensory block": characteristic = `Block ${getCharacteristicByCustomizations(debug, timer, value, rowID, attribute)}`; break;
				case "shield": characteristic = `${level * 5} Armor Rating` + getShieldParryBonus(debug, timer, value, rowID); break;
				case "sixthsense": characteristic = getCharacteristicByCustomizations(debug, timer, value, rowID, attribute); break;
				case "sizechange": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "skill": characteristic = `${level * 10} Skill Points to Skill Group ${getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute)}`; break;
				case "socialmastery": characteristic = `SCV +${level * 2}`; break;
				case "spaceflight": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "specialmovement": characteristic = getCharacteristicByCustomizations(debug, timer, value, rowID, attribute); break;
				case "summoncreatures": characteristic = `Summon up to ${get1or3(level, 1) * (10 ** (Math.ceil((level) / 2)))} Creatures`; break;
				case "supersense": characteristic = getCharacteristicByCustomizations(debug, timer, value, rowID, attribute); break;
				case "superspeed": characteristic = `Superspeed up to ${get1or3(level, 1) * (10 ** (Math.ceil((level + 2) / 2)))} kph`; break;
				case "superstrength": characteristic = `${level} tonns`; break;
				case "swarm": characteristic = `Health Points * ${level} Creatures`; break;
				case "telekinesis": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "telepathy": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "teleport": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "tough": characteristic = `Health Points +${level * 10}`; break;
				case "transfer": characteristic = `Transer Attributes as Level ${level}`; break;
				case "transmute": characteristic = `Transmute objects of ${level * 5} Character Points`; break;
				case "tunneling": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "unaffected": characteristic = `Attacker's roll ${level * -2}`; break;
				case "unassailable": characteristic = `Sanity Points +${level * 2}`; break;
				case "undetectable": characteristic = getCharacteristicByCustomizations(debug, timer, value, rowID, attribute); break;
				case "uniqueattribute": characteristic = ""; break;
				case "unknownpower": characteristic = `${level} Character Points`; break;
				case "waterspeed": characteristic = `Water speed up tp ${get1or3(level, 1) * (10 ** (Math.ceil(level / 2)))} kph`; break;
				case "wealth": characteristic = getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj); break;
				case "weapon": characteristic = `${level} Damage`; break;
				default: characteristic = "";
			}
			clog(debug, timer, 'characteristic =', characteristic, 'setAttrCharacteristic()');
			setObj[`repeating_attr_${rowID}_characteristic`] = characteristic;
		}
		
		function getShieldParryBonus(debug, timer, value, rowID) {
			const parry = getCustomizationValue(debug, timer, value, rowID, 'rank', 'parry');
			const result = (parry.rank == 2) ? `; Major Egde Parry` : 
				(parry.rank == 1) ? '; Minor Edge Parry' : '';
			clog(debug, timer, 'result =', result, 'getShieldParryBonus()');
			return result;
		}
		
		function setMassiveDamageCharacteristic(debug, timer, value, rowID, level, setObj) {
			const targeted = getIsTargeted(debug, timer, value, rowID, setObj);
			const focused = getCustomizationValue(debug, timer, value, rowID, 'rank', 'focuseddamage');
			const enemy = value[`repeating_attr_${rowID}_enemy`] || '<not configured>';
			const weaponclass = value[`repeating_attr_${rowID}_weaponclass`];
			let characteristic = `DM +${level}`;
			if (targeted) characteristic = characteristic + ` vs. ${enemy}`;
			if (focused > 0) characteristic = characteristic + ` with ${weaponclass} weapons`;
			return characteristic;
		}
		
		function getCharacteristicSpecializationByAttr(debug, timer, value, rowID, attribute) {
			const obj = {
				"meleeattack": "weaponclass",
				"rangedattack": "weaponclass",
				"meleedefense": "weaponclass",
				"enemyattack": "enemy",
				"enemydefense": "enemy",
				"immunity": "immunityrole",
				"immutable": "stat",
				"rangeddefense": "defenseclass",
				"skill": "skillgroup"
			};
			const default_obj = {
				"meleeattack": "<select weapon class>",
				"rangedattack": "<select weapon class>",
				"meleedefense": "<select weapon class>",
				"enemyattack": "<not configured>",
				"enemydefense": "<not configured>",
				"immunity": "<not configured>",
				"immutable": "body",
				"rangeddefense": "personal",
				"skill": 1
			}
			const characteristic = (obj[attribute]);
			clog(debug, timer, 'characteristic =', characteristic, 'getCharacteristicSpecializationByAttr()');
			const characteristicValue = value[`repeating_attr_${rowID}_${characteristic}`];
			clog(debug, timer, 'characteristicValue =', characteristicValue);
			const result = characteristicValue === undefined ? 
				default_obj[attribute] :
				capital(characteristicValue);
			clog(debug, timer, 'result =', result);//, 'getCharacteristicSpecializationByAttr()');
			return result;
		}
		
		function getCharacteristicByAttr(debug, timer, value, rowID, attribute, setObj) {
			const level = 
				parseInt(setObj[`repeating_attr_${rowID}_effectivelevel`]) || 
				parseInt(value[`repeating_attr_${rowID}_effectivelevel`]) || 0;
			const chardb = {
					"capacity": {
						0: {
							1: "200 kg",
							2: "500 kg",
							3: "1 tonne",
							4: "2 tonnes",
							5: "5 tonnes",
							6: "10 tonnes",
							7: "25 tonnes",
							8: "50 tonnes",
							9: "100 tonnes",
							10: "200 tonnes",
							"default": ""
						},
						1: {
							1: "+1 person",
							2: "+2 people",
							3: "+5 people",
							4: "+10 people",
							5: "+25 people",
							6: "+50 people",
							7: "+100 people",
							8: "+250 people",
							9: "+500 people",
							10: "+1,000 people",
							"default": ""
						}
					},
					"changestate": {
						1: "Liquid state, short duration",
						2: "Liquid state, long duration",
						3: "Gaseous state, short duration",
						4: "Gaseous state, long duration",
						5: "Incorpreal state, short duration",
						6: "Incorpreal state, long duration",
						7: "Energy state, short duration",
						8: "Energy state, long duration",
						"default": "Does not improve beyond level 8"
					},
					"cognition": {
						1: "Future: a few seconds; Past: 1 minute",
						2: "Future: 1 minute; Past: 1 hour",
						3: "Future: 10 minutes; Past: 1 day",
						4: "Future: 1 hour; Past: 1 week",
						5: "Future: 1 day; Past: 1 month",
						6: "Future: 1 week; Past: 1 year",
						7: "Future: 1 month; Past: 2 years",
						8: "Future: 1 year; Past: 4 years",
						"default": ""
					},
					"connected": {
						1: "Associated",
						2: "Respected",
						3: "Modest Authority",
						4: "Local Authority",
						5: "Regional Authority.",
						6: "Provincial Authority",
						7: "National Authority",
						8: "International Authority",
						9: "Planetary Authority",
						10: "Extraplanetary Authority",
						"default": "Does not improve beyond level 10"
					},
					"dataaccess": {
						1: "Tiny-sized (10 cm radius)",
						2: "Small-sized (1 m radius)",
						3: "Moderately-sized (10 m radius)",
						4: "Building-sized (100 m radius)",
						5: "Neighbourhood-sized (1 km radius)",
						6: "City-sized (10 km radius)",
						"default": ""
					},
					"dimensionwalk": {
						1: "Reflect insignificant changes",
						2: "Reflect specific changes",
						3: "Reflect minor changes",
						4: "Reflect moderate changes",
						5: "Reflect significant changes",
						6: "Reflect major changes",
						"default": "Does not improve beyond level 6"
					},
					"dynamicpowers": {
						1: "Minimal control",
						2: "Minor control",
						3: "Moderate control",
						4: "Good control",
						5: "Significant control",
						6: "Major control",
						"default": "Does not improve beyond level 6"
					},
					"elasticity": {
						1: "Stretch up to 10 cm",
						2: "Stretch up to 30 cm",
						3: "Stretch up to 1 m",
						4: "Stretch up to 3 m",
						5: "Stretch up to 10 m",
						6: "Stretch up to 30 m",
						"default": ""
					},
					"extraarms": {
						1: "1 additional arm",
						2: "2 additional arms",
						3: "Up to 5 additional arms",
						4: "Up to 10 additional arms",
						5: "Up to 25 additional arms",
						6: "Up to 50 additional arms",
						"default": "Does not improve beyond level 6"
					},
					"features": {
						1: "Up to 2 features",
						2: "Up to 5 features",
						3: "Up to 10 features",
						4: "Up to 25 features",
						5: "Up to 50 features",
						6: "Up to 100 features",
						"default": "Does not improve beyond level 6"
					},
					"gear": {
						1: "Up to 2 pieces of gear",
						2: "Up to 5 pieces of gear",
						3: "Up to 10 pieces of gear",
						4: "Up to 25 pieces of gear",
						5: "Up to 50 pieces of gear",
						6: "Up to 100 pieces of gear",
						"default": "Does not improve beyond level 6"
					},
					"groundspeed": {
						1: "Ground speed up to 10 kph",
						2: "Ground speed up to 25 kph",
						3: "Ground speed up to 50 kph",
						4: "Ground speed up to 100 kph",
						5: "Ground speed up to 250 kph",
						6: "Ground speed up to 500 kph",
						"default": "Does not improve beyond level 6"
					},
					"illusion": {
						1: "Tiny-sized (10 cm radius)",
						2: "Small-sized (1 m radius)",
						3: "Moderately-sized (10 m radius)",
						4: "Building-sized (100 m radius)",
						5: "Neighbourhood-sized (1 km radius)",
						6: "City-sized (10 km radius)",
						"default": "Does not improve beyond level 6"
					},
					"mindcontrol": {
						1: "Extremely basic, non-aggressive suggestions",
						2: "Simple, non-aggressive suggestions",
						3: "Copmlex, non-aggressive suggestions",
						4: "Complex, aggressive suggestions",
						5: "Complex/aggressive suggestions, erase brief events",
						6: "Complex/aggressive suggestions, alter events",
						"default": ""
					},
					"minions": {
						1: "Up to 5 Minions",
						2: "Up to 10 Minions",
						3: "Up to 25 Minions",
						4: "Up to 50 Minions",
						5: "Up to 100 Minions",
						6: "Up to 200 Minions",
						"default": ""
					},
					"plantcontrol": {
						1: "Control 10 cm radius; Growth 3x",
						2: "Control 1 m radius; Growth 10x",
						3: "Control 10 m radius; Growth 30x",
						4: "Control 100 m radius; Growth 100x",
						5: "Control 1 km radius; Growth 300x",
						6: "Control 10 km radius; Growth 1000x",
						"default": ""
					},
					"pocketdimension": {
						1: "Tiny-sized (10 cm radius)",
						2: "Small-sized (1 m radius)",
						3: "Moderately-sized (10 m radius)",
						4: "Building-sized (100 m radius)",
						5: "Neighbourhood-sized (1 km radius)",
						6: "City-sized (10 km radius)",
						"default": ""
					},
					"projection": {
						1: "Tiny-sized (10 cm radius)",
						2: "Small-sized (1 m radius)",
						3: "Moderately-sized (10 m radius)",
						4: "Building-sized (100 m radius)",
						5: "Neighbourhood-sized (1 km radius)",
						6: "City-sized (10 km radius)",
						"default": ""
					},
					"reincarnation": {
						1: "Up to 1 month to reincarnate",
						2: "Up to 1 week to reincarnate",
						3: "Up to 1 day to reincarnate",
						4: "Up to 12 hours to reincarnate",
						5: "Up to 1 hour to reincarnate",
						6: "Up to 1 minute to reincarnate",
						"default": "Does not improve beyond level 6"
					},
					"spaceflight": {
						1: "Primitive near-planetary Spaceflight",
						2: "Slow interplanetary Spaceflight",
						3: "Average interplanetary Spaceflight",
						4: "Fast interplanetary Spaceflight",
						5: "Extrasolar Spaceflight",
						6: "Slow faster-than-light Spaceflight",
						"default": "Does not improve beyond level 6"
					},
					"telekinesis": {
						1: "Move 1 kg",
						2: "Move 10 kg",
						3: "Move 100 kg",
						4: "Move 1 tonne",
						5: "Move 10 tonnes",
						6: "Move 100 tonnes",
						"default": ""
					},
					"telepathy": {
						"default": "See rulebook for capabilities"
					},
					"teleport": {
						1: "10 m teleportation distance",
						2: "100 m teleportation distance",
						3: "1 km teleportation distance",
						4: "10 km teleportation distance",
						5: "100 km teleportation distance",
						6: "1000 km teleportation distance",
						"default": ""
					},
					"tunneling": {
						1: "10 meters per hour",
						2: "30 meters per hour",
						3: "100 meters per hour",
						4: "300 meters per hour",
						5: "1 kph",
						6: "3 kph",
						"default": ""
					},
					"wealth": {
						1: "Financially stable ($300,000)",
						2: "Well off ($1M)",
						3: "Moderately rich ($3M)",
						4: "Very rich ($10M)",
						5: "Extremely rich ($30M)",
						6: "Moderately wealthy ($100M)",
						"default": ""
					}
				};
			let characteristic = '';
			if (level == 0) {
				return characteristic;
			} else if (attribute == 'capacity') {
				const type = parseInt(setObj[`repeating_attr_${rowID}_capacitytype`]) || parseInt(value[`repeating_attr_${rowID}_capacitytype`]) || 0;
				characteristic = (level < 11) ? (chardb[`${attribute}`][type][level] || chardb[`${attribute}`][type]["default"]) : (type == 0) ? `${(2 ** (level - 9)) * 100} tonnes` : (type == 1) ? `+${(2 ** (level - 10)) * 1000} people` : '';
			} else if (attribute == 'cognition') {
				characteristic = (level < 9) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `Future: ${2 ** (level - 8)} years; Past: ${2 ** (level - 6)} years`;
			} else if (attribute == 'dataaccess') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `${10 ** (level - 5)} km radius`;
			} else if (attribute == 'elasticity') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `Stretch body up to ${get1or3(level, 1) * (10 ** (Math.ceil((level - 4) / 2)))} km`;
			} else if (attribute == 'mindcontrol') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : chardb[`${attribute}`][6];
			} else if (attribute == 'minions') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `Up to ${400 * (level - 6)} Minions`;
			} else if (attribute == 'plantgrowth') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `Control ${(10 ** (level - 5))} km radius; Growth ${get1or3(level, 3) * (10 ** (Math.ceil((level - 4) / 2)))}x`;
			} else if (attribute == 'pocketdimension') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `Massive dimension (${(10 ** (level - 5))} km radius)`;
			} else if (attribute == 'projection') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `Massive-sized projection (${(10 ** (level - 5))} km radius)`;
			} else if (attribute == 'sizechange') {
				characteristic = (level < 11) ? `Grow/Shrink by ${level} Size Ranks` : `Does not improve beyond level 10`;
			} else if (attribute == 'telekinesis') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `Move ${(10 ** (level - 4))} tonnes`;
			} else if (attribute == 'teleport') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `${(10 ** (level - 3))} km teleportation distance`;
			} else if (attribute == 'tunneling') {
				const highlevel = `${get1or3(level, 1) * (10 ** (Math.ceil((level - 6) / 2)))} kph`;
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : highlevel;
			} else if (attribute == 'wealth') {
				characteristic = (level < 7) ? (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) : `Extremely wealthy ($${get1or3(level, 3) * (10 ** (Math.ceil((level - 3) / 2)))}M)`;
			} else {
				characteristic = (chardb[`${attribute}`][level] || chardb[`${attribute}`]["default"]) || '';
			}
			clog(debug, timer, 'characteristic =', characteristic,'getCharacteristicByAttr()');
			return characteristic;
		}
		
		function getCharacteristicByCustomizations(debug, timer, value, rowID, attribute) {
			const characteristics = 
				(attribute == 'sixthsense') ? sixthsense_phenomena_array :
				(attribute == 'undetectable') ? undetectable_methods_array :
				(attribute == 'controlenvironment') ? controlable_environments_array :
				(attribute == 'specialmovement') ? special_movements_array : [];
			let result = [];
			if (characteristics && _.isArray(characteristics)) {
				_.each(characteristics, (characteristic) => {
					if (getCustomizationValue(debug, timer, value, rowID, 'rank', characteristic) > 0) {
						let fetch = '';
						if (characteristic == "attrsrc" || 
							characteristic == "objects" || 
							characteristic == "uniquephenomena") {
						//if (/(attrsrc|objects|uniquephenomena)/i.test(characteristic)) {
							fetch = capital(value[`repeating_attr_${rowID}_${characteristic}`]);
						} else if (characteristic == "unique") {
							fetch = capital(getCustomizationValue(debug, timer, value, rowID, 'type', characteristic));
						} else {
							fetch = capital(getCustomizationValue(debug, timer, value, rowID, 'name', characteristic));
						}
						if (fetch != undefined) result[result.length] = fetch;
					}
				});
				result = result.join(", ")
			} else {
				result = capital(value[`repeating_attr_${rowID}_${attribute}`]);
			}
			clog(debug, timer, 'result:', result, 'getCharacteristicByCustomizations()');
			return result;
		}
		
		function setAttrStat(debug, timer, value, rowID, setObj, type) {
			const attribute = value[`repeating_attr_${rowID}_attribute`].replace(/\s+/g, '');
			const obj = {
				"major": {
					"absorption": "body",
					"alternateform": "body",
					"alternateidentity": "body",
					"changestate": "body",
					"cognition": "mind",
					"connected": "soul",
					"controlenvironment": "soul",
					"conversion": "body",
					"dataaccess": "mind",
					"dimensionwalk": "soul",
					"dynamicpowers": "",
					"elasticity": "body",
					"exorcism": "soul",
					"features": "",
					"flight": "body",
					"forcefield": "body",
					"groundspeed": "body",
					"healing": "soul",
					"heightenedawareness": "mind",
					"heightenedsenses": "mind",
					"illusion": "mind",
					"immovable": "body",
					"immunity": "body",
					"immutable": " body or soul",
					"inspire": "soul",
					"jumping": "body",
					"metamorphosis": "mind or soul",
					"mimic": "mind",
					"mindcontrol": "mind",
					"mindshield": "mind",
					"minions": "soul",
					"mulligan": "soul",
					"nullify": "body or soul",
					"plantcontrol": "mind",
					"portal": "soul",
					"powerflux": "",
					"powervariation": "",
					"projection": "mind",
					"regeneration": "body",
					"reincarnation": "soul",
					"resilient": "body",
					"sensoryblock": "mind",
					"sixthsense": "soul",
					"sizechange": "body",
					"spaceflight": "body",
					"specialmovement": "body",
					"summoncreatures": "mind",
					"supersense": "mind",
					"superspeed": "body",
					"superstrength": "body",
					"swarm": "body",
					"telekinesis": "mind",
					"telepathy": "mind",
					"teleport": "mind",
					"transfer": "soul",
					"transmute": "mind or soul",
					"tunneling": "body",
					"unaffected": "body",
					"undetectable": "body",
					"waterspeed": "body"
				},
				"minor": {
					"absorption": "con",
					"alternateform": "con",
					"alternateidentity": "dex",
					"changestate": "dex",
					"cognition": "per",
					"connected": "chr",
					"controlenvironment": "wil",
					"conversion": "con",
					"dataaccess": "rea",
					"dimensionwalk": "awa",
					"dynamicpowers": "",
					"elasticity": "dex",
					"exorcism": "wil",
					"features": "",
					"flight": "dex",
					"forcefield": "con",
					"groundspeed": "dex",
					"healing": "wil",
					"heightenedawareness": "per",
					"heightenedsenses": "per",
					"illusion": "per",
					"immovable": "str",
					"immunity": "con",
					"immutable": "con or wil",
					"inspire": "chr",
					"jumping": "dex",
					"metamorphosis": "cre or awa",
					"mimic": "per",
					"mindcontrol": "int",
					"mindshield": "int",
					"minions": "chr",
					"mulligan": "awa",
					"nullify": "agi or wil",
					"plantcontrol": "cre",
					"portal": "wil",
					"powerflux": "",
					"powervariation": "",
					"projection": "per",
					"regeneration": "con",
					"reincarnation": "wil",
					"resilient": "con",
					"sensoryblock": "per",
					"sixthsense": "awa",
					"sizechange": "str",
					"spaceflight": "dex",
					"specialmovement": "dex",
					"summoncreatures": "int",
					"supersense": "per",
					"superspeed": "dex",
					"superstrength": "str",
					"swarm": "dex",
					"telekinesis": "int",
					"telepathy": "int",
					"teleport": "int",
					"transfer": "wil",
					"transmute": "cre or awa",
					"tunneling": "str",
					"unaffected": "con",
					"undetectable": "dex",
					"waterspeed": "dex"
				}
			};
			const result = (type == 'minor') ? obj.minor[attribute] || "" : obj.major[attribute] || "";
			clog(debug, timer, 'result:', result,'setAttrStat()');
			setObj[`repeating_attr_${rowID}_stat`] = result;
		}
		
		function setAttrDuration(debug, timer, value, rowID, setObj) {
			let attribute = value[`repeating_attr_${rowID}_attribute`],
				obj = {
					"illusion": 3,
					"metamorphosis": 3,
					"mimic": 3,
					"mind control": 3,
					"nullify": 3,
					"plant control": 3,
					"projection": 3,
					"transfer": 3,
					"transmute": 3,
					"default": 0
				},
				result = (obj[attribute] || obj["default"]);
			clog(debug, timer, 'result:', result,'setAttrDuration()');
			setObj[`repeating_attr_${rowID}_customizationduration`] = result;
		}
		
		function setAttrRange(debug, timer, value, rowID, setObj) {
			let attribute = value[`repeating_attr_${rowID}_attribute`],
				obj = {
					"telekinesis": 1,
					"telepathy": 1,
					"default": 0
				},
				result = (obj[attribute] || obj["default"]);
			clog(debug, timer, 'result:', result,'setAttrRange()');
			setObj[`repeating_attr_${rowID}_customizationrange`] = result;
		}
		
		function setAttrArea(debug, timer, value, rowID, setObj) {
			let attribute = value[`repeating_attr_${rowID}_attribute`],
				obj = {
					"dimension walk": 2,
					"portal": 1,
					"control environment": 3,
					"illusion": 5,
					"projection": 5,
					"sensory block": 2,
					"sixth sense": 3,
					"default": 0
				},
				result = (obj[attribute] || obj["default"]);
			clog(debug, timer, 'result:', result,'setAttrArea()');
			setObj[`repeating_attr_${rowID}_customizationarea`] = result;
		}
		
		function setRollUI(debug, timer, value, setObj) {
			const rolltype = value.static_roll_type_selection;
			const obj = {
					"2d6": 1,
					"acv": 2,
					"dcv": 3,
					"initiative": 4,
					"perception": 5,
					"stat": 6,
					"default": 0
				};
			const result = (obj[rolltype] || obj["default"]);
			setObj.rolltab = result;
			clog(debug, timer, 'rolltab =', result, 'setRollUI()');
		}
		
		function setDynamicRollValue(debug, timer, eventInfo, value, attrdb, rowID, sourceAttr, setObj) {
			const rolltype = value.static_roll_type_selection;
			clog(debug, timer, 'rolltype =', rolltype, 'setDynamicRollValue()');
			let cv = 0;
			let rollmod = 0;
			let type = '';
			let title = '';
			let stat = '';
			let base = 0;
			let turntracker = '';
			let result = `&{template:besmDefault} {{rolls=1}} {{character_name=@{charactername}}} {{pronoun=@{pronoun}}} `;
			switch (rolltype) {
				case '2d6':
					type = '{{twodsix=1}}';
					title = '{{title=Roll 2d6}}';
					break;
				case 'acv':
					cv = getCV(debug, timer, value, attrdb, setObj, 'acv', '');
					type = '{{acvroll=1}}';
					title = '{{title=Roll ACV}}';
					stat = `{{acv=${cv}}}`;
					base = cv;
					break;
				case 'dcv':
					const defensetype = 
						parseInt(setObj.static_button_movement_defense) ?
						'movement' :
						parseInt(setObj.static_button_personal_defense) ?
						'personal' :
						parseInt(value.static_button_movement_defense) ?
						'movement' :
						parseInt(value.static_button_personal_defense) ?
						'personal' :
						'';
					clog(debug, timer, 'defensetype =', defensetype);
					cv = getCV(debug, timer, value, attrdb, setObj, 'dcv', defensetype);
					type = '{{dcvroll=1}}';
					title = '{{title=Roll DCV}}';
					stat = `{{dcv=${cv}}}`;
					base = cv;
					result = `${result} ${buildProtectionsString(debug, timer, value)}`;
					break;
				case 'initiative':
					cv = getCV(debug, timer, value, attrdb, setObj, 'acv', '');
					rollmod = getSumOfActiveSubAttrRanks(attrdb, 'combattechnique', 'lightningreflexes') || 0;
					type = '{{initiative=1}}';
					title = '{{title=Roll Initiative}}';
					stat = `{{acv=${cv}}}`;
					base = cv;
					turntracker = '&{tracker}';
					break;
				case 'perception':
					const perception = getPerceptionRollBase(debug, timer, value, attrdb, setObj);
					type = '{{perception=1}}';
					title = '{{title=Roll Perception}}';
					stat = `{{perception=${perception}}}`;
					base = perception;
					setHeightenedSenses(debug, timer, attrdb, setObj);
					break;
				case 'stat':
					setStatButtonStatsAndRolls(debug, timer, eventInfo, value, rowID, sourceAttr, setObj);
					/*
					type = '{{statroll=1}}';
					title = '{{title=Stat Roll}}';
					stat = `{{stat=${}}}`;
					base = statBase;
					*/
					break;
			}
			result = `${result} ${type} ${title} ${stat} ` +
				`{{total=[[[[?{Roll is|Normal, ${setDice(rollmod)}` +
				`|Minor Edge, ${setDice(rollmod, 1)}|Minor Obstacle, ${setDice(rollmod, -1)}` +
				`|Major Edge, ${setDice(rollmod, 2)}|Major Obstacle, ${setDice(rollmod, -2)}}]]` +
				`+[[${base}]] ${turntracker}]]}} {{roll=$[[0]]}}`;
			clog(debug, timer, 'result =', result);
			setObj.dynamic_roll_value = result;
			setObj.dynamic_roll_base = base;
		}
		
		function setAttrCustomizations(debug, timer, value, rowID, setObj) {
			const attribute = value[`repeating_attr_${rowID}_attribute`];
			const obj = {
					"absorption": 6,
					"armor": 2,
					"change state": 17,
					"combat technique": 4,
					"connected": 16,
					"control environment": 39,
					"conversion": 7,
					"dimension walk": 40,
					"dynamic powers": 8,
					"exorcism": 41,
					"flight": 11,
					"forcefield": 12,
					"ground speed": 14,
					"healing": 42,
					"heightened senses": 37,
					"illusion": 13,
					"massive damage": 15,
					"merge": 10,
					"metamorphosis": 18,
					"mimic": 19,
					"mind control": 20,
					"nullify": 21,
					"plant control": 22,
					"portal": 43,
					"power flux": 36,
					"power variation": 44,
					"resilient": 23,
					"projection": 24,
					"regeneration": 25,
					"reincarnation": 26,
					"sensory block": 45,
					"shield": 27,
					"sixth sense": 38,
					"size change": 28,
					"special movement": 29,
					"summon creatures": 5,
					"telekinesis": 30,
					"telepathy": 31,
					"teleport": 32,
					"transfer": 33,
					"transmute": 34,
					"unaffected": 3,
					"undetectable": 9,
					"unique attribute": 46,
					"unknown power": 47,
					"weapon": 35,
					"default": 1
				};
			const result = (obj[attribute] || obj["default"]);
			clog(debug, timer, 'result:', result,'setAttrCustomizations()');
			if (`${attribute}` == "defect") { 
				setObj[`repeating_attr_${rowID}_attrdefecttoggle`] = 1; 
			} else { 
				setObj[`repeating_attr_${rowID}_attrdefecttoggle`] = 0; 
			}
			setObj[`repeating_attr_${rowID}_enhancementtab`] = result;
			setObj[`repeating_attr_${rowID}_limitertab`] = result;
		}
		
		function resetRank(value, rowID, setObj){
			const debugtext = `[resetRank()]`;
			const rank = parseInt(value[`repeating_attr_${rowID}_rank`]) || 0;
			const resetRankValue = r => r > 0 ?
				setObj[`repeating_attr_${rowID}_rank`] = 0 :
				false;
			resetRankValue(rank);
		}
		
		function exposeDefectSettingsOnDefectChange(debug, timer, value, rowID, setObj){
			const defect = removeWhiteSpace(value[`repeating_attr_${rowID}_defect`]);
			let exposed_settings = [];
			_.each(all_defects_array, defectmatch => {
				defectmatch = removeWhiteSpace(defectmatch);
				const exposesetting = defectmatch == defect ? 1 : 0;
				//setObj[`repeating_attr_${rowID}_show${defectmatch}`] = exposesetting;
				writeValues(debug, timer, value, `repeating_attr_${rowID}_show${defectmatch}`, exposesetting, setObj);
				exposesetting ? exposed_settings.push(`show${defectmatch}`) : false;
			});
			clog(debug, timer, 'exposed_settings:', exposed_settings, 'exposeDefectSettingsOnDefectChange()');
		}
		
		function exposeAttrSettingsOnAttributeChange(debug, timer, value, match, source, setObj) {
			const attribute = value[`${match}`] === undefined ? 'default' :
				removeWhiteSpace(value[`${match}`]);
			const settings = [
				'showarmorlayer', 
				'showattrsrc', 
				'showaugmentedstat', 
				'showcapacitytype', 
				'showcollectiontype', 
				'showconversiontype',
				'showdamagecategory',
				'showdamagetype',
				'showdefect',
				'showdefenseclass', 
				'showenemy', 
				'showextraarms', 
				'showimmunityrole', 
				'showmeleeclass',
				'showrangedclass',
				'showseeinto', 
				'showskillgroup', 
				'showsupersense',
				'showunaffected',
				'showunaffectedweapon',
				'showuniqueattributecost',
				'showvariablestat', 
				'showweaponclass'
			];
			const settingsObj = {
				'absorption':['showcollectiontype'],
				'armor':['showarmorlayer'],
				'augmented':['showaugmentedstat'],
				'capacity':['showcapacitytype'],
				'cognition':['showseeinto'],
				'conversion':['showconversiontype'],
				'defect':['showdefect'],
				'dynamicpowers':['showvariablestat'],
				'enemyattack':['showenemy'],
				'enemydefense':['showenemy'],
				'extraarms':['showextraarms'],
				'features':['showvariablestat'],
				'immunity':['showimmunityrole'],
				'immutable':['showvariablestat'],
				'meleeattack':['showmeleeclass'],
				'meleedefense':['showmeleeclass'],
				'metamorphosis':['showvariablestat'],
				'mimic':['showattrsrc'],
				'nullify':['showattrsrc','showvariablestat'],
				'powerflux':['showvariablestat'],
				'powervariation':['showvariablestat'],
				'rangedattack':['showrangedclass'],
				'rangeddefense':['showdefenseclass'],
				'regeneration':['showcollectiontype'],
				'skill':['showskillgroup'],
				'supersense':['showsupersense'],
				'transmute':['showvariablestat'],
				'unaffected':['showunaffected','showattrsrc'],
				'uniqueattribute':['showuniqueattributecost'],
				'weapon':['showdamagetype','showweaponclass']
			};
			const settings_array = settingsObj[attribute] || [];
			const result = 
				_.map(settings, setting => {
					const set = settings_array.indexOf(setting) !== -1 ? 1 : 0;
					setObj[`${source}_${setting}`] = set;
					return `${setting} = ${set}`;
				});
			clog(debug, timer, 'result:', result,'exposeAttrSettingsOnAttributeChange()');
		}
		
		function exposeAttrSettingsOnCustomizationChange(debug, timer, eventInfo, source, customization, setObj) {
			const rank = parseInt(eventInfo.newValue);
			const attribute = getIsObject(customization) ? 
				removeWhiteSpace(customization.name) :
				'default';
			const set = rank ? 1 : 0;
			let result = '';
			switch (attribute) {
				case 'ammo': result = 'showammo'; break;
				case 'attrsrc': result = 'showattrsrc'; break;
				case 'broadcategory': result ='showbroadcategory'; break;
				case 'charges': result = 'showcharges'; break;
				case 'continuing': result = 'showcontinuing'; break;
				//case 'deplete': result = 'showendurance'; break;
				case 'drain': result = 'showdrain'; break;
				case 'enemy': result = 'showenemy'; break;
				case 'focuseddamage': result = 'showweaponclass'; break;
				case 'intensity': result ='showintensity'; break;
				case 'objects': result = 'showobject'; break;
				case 'specialized': result = 'showdamagetype'; break;
				case 'specific': result = 'showdamagecategory'; break;
				case 'targeted': result = 'showenemy'; break;
				case 'targeteddamage': result = 'showenemy'; break;
				case 'uniquephenomena': result = 'showuniquephenomena'; break;
				case 'unpredictable': result = 'showvariablestat'; break;
			}
			clog(debug, timer, 'result =', result, 'exposeAttrSettingsOnCustomizationChange()');
			clog(debug, timer, 'set =', set);
			setObj[`${source}_${result}`] = set;
		}
		
		function setAvailableDamageTypes(debug, timer, value, rowID, setObj) {
			const isWeapon = value[`repeating_attr_${rowID}_attribute`] == 'weapon' ? true : false;
			if (!isWeapon) return;
			const customizations = setObj[`repeating_attr_${rowID}_customizations`] || 
				value[`repeating_attr_${rowID}_customizations`] || [];
			const isInsidious = getCustomizationExists('insidious', customizations);
			const isPsychic = getCustomizationExists('psychic', customizations);
			setObj[`repeating_attr_${rowID}_normaldamage`] = 0;
			setObj[`repeating_attr_${rowID}_insidiousdamage`] = 0;
			setObj[`repeating_attr_${rowID}_psychicdamage`] = 0;
			if (isInsidious && !isPsychic) {
				setObj[`repeating_attr_${rowID}_insidiousdamage`] = 1;
			} else if (isPsychic) {
				setObj[`repeating_attr_${rowID}_psychicdamage`] = 1;
			} else {
				setObj[`repeating_attr_${rowID}_normaldamage`] = 1;
			}
			clog(debug, timer, 'isInsidious =', isInsidious, 'setAvailableDamageTypes()');
			clog(debug, timer, 'isPsychic =', isPsychic);
		}
		
		function setProtection(isActive, debug, timer, value, rowID, sourceAttr, attribute, setObj) {
			const name = 
				isActive ? value[`repeating_attr_${rowID}_name`] : '';
			const elevel = 
				parseInt(value[`repeating_attr_${rowID}_effectivelevel`]) || 0;
			const attr = removeWhiteSpace(attribute);
			const rating5_attributes = 
				['armor','shield','absorption'];
			const rating10_attributes = 
				['forcefield','mindshield','conversion'];
			const rating = 
				rating5_attributes.indexOf(attr) !== -1 && isActive ? elevel * 5 : 
				rating10_attributes.indexOf(attr) !== -1 && isActive ? elevel * 10 : 
				0;
			//const rating = (/(armor|shield|absorption)/i.test(attr) && isActive) ? elevel * 5 : 
			//	(/(forcefield|mindshield|conversion)/i.test(attr) && isActive) ? elevel * 10 : 0;
			const layer = attr == `armor` ? 
				parseInt(value[`repeating_attr_${rowID}_armorlayer`]) || 1 : '';
			const type = (attr == `absorption` || attr == `conversion`) ? 
				parseInt(value[`repeating_attr_${rowID}_collectiontype`]) || 0 : '';
			const attrstate = 
				parseInt(value[`protection_${attr}${layer}${type}_state`]) || 0;
			const source = 
				value[`protection_${attr}${layer}${type}_source`] || '';
			const state = isActive ? 1 : 0;
			if (type == 2) {
				clog(debug, timer, 'conversion_energy offers no protection, exiting', '', 'setProtection()');
				return;
			}
			clog(debug, timer, 'attribute =', attr, 'setProtection()');
			clog(debug, timer, 'name =', name);
			clog(debug, timer, 'rating =', rating);
			clog(debug, timer, 'layer =', layer);
			clog(debug, timer, 'source =', source);
			if (isActive && attrstate == 1) {
				setObj[`repeating_attr_${source}_activate`] = 0;
				clog(debug, timer, 'attrstate =', attrstate);
			}
			if (attr == `armor`) {
				const specialized = (isActive) ? getCustomizationValue(debug, timer, value, rowID, 'rank', "specialized") : 0,
					gap = (isActive) ? getCustomizationValue(debug, timer, value, rowID, 'rank', "gap") : 0,
					damagetype = (isActive) ? value[`repeating_attr_${rowID}_damagetype`] : "";
				setObj[`protection_${attr}${layer}_specialized`] = specialized;
				setObj[`protection_${attr}${layer}_gap`] = gap;
				if (damagetype !== undefined) setObj[`protection_${attr}${layer}_damagetype`] = damagetype;
				clog(debug, timer, 'specialized =', specialized);
				clog(debug, timer, 'damagetype =', damagetype);
				clog(debug, timer, 'gap =', gap);
			}
			if (attr == `forcefield`) {
				const impacting = (isActive) ? getCustomizationValue(debug, timer, value, rowID, 'rank', "impacting") : 0;
				setObj[`protection_${attr}_impacting`] = impacting;
				clog(debug, timer, 'impacting =', impacting);
			}
			if (attr == `absorption`) {
				const synergistic = (isActive) ? getCustomizationValue(debug, timer, value, rowID, 'rank', "synergistic") : 0,
					capped = (isActive) ? getCustomizationValue(debug, timer, value, rowID, 'rank', "capped") : 0;
				setObj[`protection_${attr}${type}_synergistic`] = synergistic;
				setObj[`protection_${attr}${type}_capped`] = capped;
				clog(debug, timer, 'synergistic =', synergistic);
				clog(debug, timer, 'capped =', capped);
			}
			if (attr == `conversion` && type == 1) {
				const escalate = (isActive) ? getCustomizationValue(debug, timer, value, rowID, 'rank', "escalate") : 0;
				setObj[`protection_${attr}_escalate`] = escalate;
				clog(debug, timer, 'escalate =', escalate);
			}
			setObj[`protection_${attr}${layer}${type}_state`] = state;
			setObj[`protection_${attr}${layer}${type}_name`] = name;
			setObj[`protection_${attr}${layer}${type}_source`] = rowID;
			setObj[`protection_${attr}${layer}${type}_ar`] = rating;
		}
		
		function setAugmented(isActive, debug, timer, value, attrdb, rowID, setObj) {
			const stat = value[`repeating_attr_${rowID}_augmentedstat`] || ""; //body, mind, soul
			const base = parseInt(value[`static_stat_base_${stat}`]) || 0;
			const augmented = _.chain(attrdb.augmented)
				.map( a => {
					const augStat = 
						a.focus === stat && a.rowID === rowID && isActive ?
							a.level :
						a.focus === stat && a.rowID !== rowID ?
							a.level :
						0;
					return augStat;
				})
				.reduce((memo, num) => { return memo + num; }, 0)
				.value();
			const result = base + augmented;
			writeValues(debug, timer, value, `stat_total_${stat}`, result, setObj);
			clog(debug, timer, 'stat =', stat, 'setAugmented()');
			clog(debug, timer, 'base = ', base);
			clog(debug, timer, 'augmented = ', augmented);
			clog(debug, timer, 'result = ', result);
		}
		
		function setExtraArms(isActive, debug, timer, extraarmIDs, value, rowID, sourceAttr, setObj, isTelekinesis = false) {
			const extraarms = isTelekinesis ? 2 :
				parseInt(value[`repeating_attr_${rowID}_extraarms`]) || 0;
			const label = value[`repeating_attr_${rowID}_name`];
			if (isActive) {
				var armIDs = [];
				for (let i = 0; i < extraarms; i++) {
					const armID = generateRowID();
					//setObj[`repeating_extraarm_${armID}_label`] = label;
					//setObj[`repeating_extraarm_${armID}_type`] = 1;
					//setObj[`repeating_extraarm_${armID}_state`] = 0;
					writeValues(debug, timer, value, `repeating_extraarm_${armID}_label`, label, setObj);
					writeValues(debug, timer, value, `repeating_extraarm_${armID}_type`, 1, setObj);
					writeValues(debug, timer, value, `repeating_extraarm_${armID}_state`, 0, setObj);
					armIDs[i] = armID;
				}
				setObj[`repeating_attr_${rowID}_source`] = armIDs.join();
				const lowerarmIDs = _.map(armIDs, id => {
					return id.toLowerCase();
				});
				_.each(lowerarmIDs, id => {
					extraarmIDs.push(id);
				})
			} else {
				let sources = value[`repeating_attr_${rowID}_source`].toLowerCase().split(',');
				const armpositions = _.chain(sources)
					.map((id, i) => {
						i+=1;
						const test = extraarmIDs.indexOf(id);
						const armpos = test !== -1 ? i : '';
						return armpos;
					})
					.compact()
					.map(pos => {
						pos--;
						return pos;
					})
					.value();
				sources = value[`repeating_attr_${rowID}_source`].split(',');
				const armIDs = _.map(armpositions, pos => {
					return sources[pos];
				});
				clog(debug, timer, 'armIDs:', armIDs);
				_.each(armIDs, id => {
					removeRepeatingRow(`repeating_extraarm_${id.toLowerCase()}`);
				});
				sources = _.chain(sources)
					.map((source, i) => {
						const result = armpositions.indexOf(i) !== -1 ? '' : source;
						return result;
					})
					.compact()
					.value();
				clog(debug, timer, 'sources:', sources);
				const write = test => test.indexOf(',') !== -1 ? 
					setObj[`repeating_attr_${rowID}_source`] = test.join() :
					setObj[`repeating_attr_${rowID}_source`] = test;
				write(sources);
			}
			clog(debug, timer, 'extraarms =', extraarms, 'setExtraArms()]');
			clog(debug, timer, 'label = ', label);
		}
		
		function getPerceptionRollBase(debug, timer, value, attrdb, setObj) {
			const perception = parseInt(setObj.stat_total_per) || 
				parseInt(value.stat_total_per) || 0;
			const heightenedawareness = 
				getSumOfActiveAttrLevels(attrdb, 'heightenedawareness') || 0;
			const result = perception + heightenedawareness;
			clog(debug, timer, 'result =', result, 'getPerceptionRollBase()');
			return result;
		}
		
		function getHeightenedSenses(debug, timer, attrdb) {
			var result = [0, 0, 0, 0, 0];
			var defectArray = [0, 0, 0, 0, 0];
			const defectdb = attrdb.defect;
			_.each(attrdb.heightenedsenses, (o) => {
				const ranks = _.pluck(o.senses, 'rank');
				_.map(ranks, (rank, i) => {
					result[i] = result[i] + rank;
					result[i] = result[i] > 2 ? 2 : result[i] < -2 ? -2 : result[i];
					return result[i];
				});
			});
			_.each(defectdb, o => {
				if (o.name == 'sensoryimpairment') {
					const sense = o.sense == 'sight' ? 0 :
						o.sense == 'hearing' ? 1 :
						o.sense == 'touch' ? 2 :
						o.sense == 'smell' ? 3 :
						o.sense == 'taste' ? 4 :
						false;
					const rank = o.rank === undefined ? 0 : o.rank;
					defectArray[sense] = defectArray[sense] == 3 ? defectArray[sense] :
						rank == 3 ? defectArray[sense] = rank :
						defectArray[sense] + rank > 2 ? defectArray[sense] = 2 :
						defectArray[sense] = defectArray[sense] + rank;
				}
			});
			result = defectArray.map((defect,i) => {
				if(defect == 3){
					return -3;
				}else{
					return result[i] - defect;
				}
			});
			clog(debug, timer, 'result:', result, 'getHeightenedSenses()]');
			clog(debug, timer, 'defectArray:', defectArray);
			return result;
		}
		
		function setHeightenedSenses(debug, timer, attrdb, setObj) {
			const senseRanks = getHeightenedSenses(debug, timer, attrdb);
			_.each(sense_array, (sense, i) => {
				setObj[`enhanced${sense}tab`] = senseRanks[i];
			});
			clog(debug, timer, 'senseRanks:', senseRanks, 'setHeightenedSenses()');
		}
		
		function getIsTargetedActive(debug, timer, value, attrdb, rowID, setObj) {
			clog(debug, timer, 'rowID =', rowID, 'getIsTargetedActive()');
			const isTargeted = getIsTargeted(debug, timer, value, rowID, setObj);
			if (!isTargeted) return '';
			const activeID = (parseInt(value[`repeating_attr_${rowID}_activate`]) || 0) === 1 ?
				rowID : '';
			clog(debug, timer, 'activeID =', activeID);
			clog(debug, timer, 'activate =', value[`repeating_attr_${rowID}_activate`]);
			/*
			const attribute = removeWhiteSpace(value[`repeating_attr_${rowID}_attribute`]);
			clog(debug, timer, 'attribute =', attribute, 'getIsTargetedActive()');
			const activedb = attrdb[`${attribute}`];
			const isActive = activedb !== undefined ? 
				_.chain(activedb).pluck('source').find(s => { 
					if (s === rowID) return true; 
				}).value() : undefined;
			const activeID = isActive !== undefined ? rowID : '';
			clog(debug, timer, 'activeID =', activeID);
			/*
			let activeID = "";
			_.each(attrIDs, (attrID) => {
				const attrname = removeWhiteSpace(value[`repeating_attr_${attrID}_attribute`]);
				const active = parseInt(value[`repeating_attr_${attrID}_activate`]);
				if (attrname == attribute && active && getIsTargeted(debug, timer, value, attrID, setObj)) {
					activeID = attrID;
				}
			});
			*/
			return activeID;
		}
		
		function getIsTargeted(debug, timer, value, rowID, setObj) {
			const attribute = removeWhiteSpace(value[`repeating_attr_${rowID}_attribute`]);
			const customizations = setObj[`repeating_attr_${rowID}_customizations`] ||
				value[`repeating_attr_${rowID}_customizations`] || [];
			let isTargeted = false;
			if (attribute == "massivedamage") {
				_.each(customizations, (customization) => {
					if (customization.name == 'targeteddamage' && customization.rank > 0) {
						isTargeted = true;
					}
				});
			} else if (attribute == "enemyattack" || attribute == "enemydefense") {
				isTargeted = true;
			} else if (attribute == 'combattechnique') {
				const rushObj = _.find(customizations, c => {
					if (c.name == 'rushattack' && c.rank > 0) return true;
				});
				isTargeted = getIsObject(rushObj) ? true : false;
			}
			clog(debug, timer, 'isTargeted =', isTargeted, 'getIsTargeted()');
			return isTargeted;
		}
		
		function getTargetedLevel(attrdb, attribute) {
			var result = 0;
			_.find(attrdb[`${attribute}`], (o) => {
				if (attribute == "massivedamage") {
					if (o.targeted) result = o.level;
				} else if (attribute == "enemyattack" || attribute == "enemydefense") {
					result = o.level;
				}
			});
			return result;
		}
		
		function setTargeted(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj) {
			const isRushAttack = attribute == "combattechnique" ?
				getSumOfActiveSubAttrRanks(attrdb, 'combattechnique', 'rushattack') : 0;
			if (attribute == "massivedamage" || attribute == "enemyattack" ||
				attribute == "enemydefense" || isRushAttack) {
				const targeted = isRushAttack ? isRushAttack :
					getTargetedLevel(attrdb, attribute);
				const result = (isActive) ? targeted : 0;
				const enable = (result > 0) ? 1 : 0;
				const activeID = getIsTargetedActive(debug, timer, value, attrdb, rowID, setObj);
				attribute = isRushAttack ? 'rushattack' : attribute;
				/*
				if (activeID != "") {
					setActiveAttribute(0, debug, timer, value, activeID, sourceAttr, setObj, attribute);
					setObj[`repeating_attr_${activeID}_activate`] = 0;
				}
				*/
				clog(debug, timer, 'attribute =', attribute, 'setTargeted()');
				clog(debug, timer, 'targeted =', targeted);
				clog(debug, timer, 'result =', result);
				clog(debug, timer, 'enable =', enable);
				setObj[`enable_${attribute}`] = enable;
			} else { 
				if (attribute == "combattechnique") {
					setObj.enable_rushattack = 0;
					setObj.static_button_targeted_rushdamage = 0;
				}
			}
			setCombatRoll(debug, timer, value, attrdb, rowID, sourceAttr, setObj);
		}
		
		function setExtraActions(debug, timer, attrdb, attribute, setObj) {
			//const action_type_regex = new RegEx(/extra/g);
			//const type = attribute.replace(action_type_regex, '');
			const type = attribute.substring(5, attribute.length);
			let result = (type == 'actions') ? 1 : 0;
			_.each(attrdb[`extra${type}`], (v) => {
				result += parseInt(v.level);
			});
			setObj[`${type}`] = result;
			clog(debug, timer, `${type}`, result, 'setExtraActions()');
		}
		
		function getSumOfActiveSubAttrRanks(attrdb, attribute, subattr) {
			var result = 0;
			_.each(attrdb[`${attribute}`], (o) => {
				_.find(o.customizations, (i) => {
					if (i.name == subattr) {
						result = result + i.rank;
						return true;
					}
				});
			});
			return result;
		}
		
		function getActiveIdPosition(attrdb, attribute, activeID) {
			let result = 0;
			_.find(attrdb[`${attribute}`], (o, i) => { 
				if (o.source == activeID) {
					result = i;
					return true;
				}
			});
			return result;
		}
		
		function setDefectdb(isActive, debug, timer, attrdb, value, rowID, setObj){
			var defectdb = attrdb.defect;
			const defect = removeWhiteSpace(value[`repeating_attr_${rowID}_defect`]);
			if (isActive) {
				const rank = parseInt(value[`repeating_attr_${rowID}_rank`]) || 0;
				let result = { name: defect, rank: rank, source: rowID };
				switch(defect){
					case 'sensoryimpairment':
						const sense = { sense: value[`repeating_attr_${rowID}_sense`] };
						Object.assign(result, sense);
					break;
					case 'shortcoming':
						const aspect = { aspect: value[`repeating_attr_${rowID}_defectaspect`]};
						Object.assign(result, aspect);
					break;
				}
				const position = _.isEmpty(defectdb) ? 0 : defectdb.length;
				defectdb[position] = result;
			} else {
				defectdb = defectdb.filter(o => o.source !== rowID);
				attrdb.defect = defectdb;
			}
			clog(debug, timer, 'defectdb:', defectdb, 'setDefectdb()');
		}
		/*
		function getAttributeSettingByCustomization(debug, timer, value, rowID, customizations) {
			const attribute_settings_by_customization_obj = {
				'ammo':'ammo',
				'attrsrc':'attrsrc',
				'broadcategory':'broadcategory',
				'charges':'charges',
				'continuing':'continuing',
				'deplete':'endurance',
				'drain':'drain',
				'enemy':'enemy',
				'focuseddamage':'weaponclass',
				'intensity':'intensity',
				'objects':'object',
				'specialized':'damagetype',
				'specific':'damagecategory',
				'targeted':'enemy`',
				'targeteddamage':'enemy',
				'uniquephenomena':'uniquephenomena',
				'unpredictable':'variablestat'
			};
			_.each(customizations, c => {
				if (attribute_settings_by_customization_array.indexOf(c.name) !== -1) {
					const setting = value[`repeating_attr_${rowID}_${attribute_settings_by_customization_obj[c.name]}`];
					c[c.name] = setting;			
				}
			});
			clog(debug, timer, 'customizations:', customizations, 'getAttributeSettingByCustomization()');
		}
		*/
		function setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj) {
			const name = value[`repeating_attr_${rowID}_name`] || "";
			const level = parseInt(value[`repeating_attr_${rowID}_effectivelevel`]) || 0;
			const customizations = value[`repeating_attr_${rowID}_customizations`] || [];
			//getAttributeSettingByCustomization(debug, timer, value, rowID, customizations);
			let result = {};
			let stat = 0;
			let focused = 0;
			let defense = 0;
			let targeted = 0;
			let damagetype = '';
			switch (attribute) {
				case 'augmented':
					stat = value[`repeating_attr_${rowID}_augmentedstat`] || "";
					result = { name: name, attribute: attribute, level: level, focus: stat, source: rowID, customizations: customizations };
				break;
				case `combattechnique`:
					result = { name: name, attribute: attribute, source: rowID, customizations: customizations };// subattrs: getSubAttrs(debug, customizations, attribute), source: rowID };
				break;
				case `enemyattack`:
				case `enemydefense`:
					result = { name: name, attribute: attribute, level: level, targeted: 1, source: rowID, customizations: customizations };
				break;
				case `attackmastery`:
				case `defensemastery`:
				case `extraactions`:
				case `extradefenses`:
				case `heightenedawareness`:
				case `socialmastery`:
				case `superstrength`:
				case `tough`:
				case `unassailable`:
					result = { name: name, attribute: attribute, level: level, source: rowID, customizations: customizations };
				break;
				case `meleeattack`:
				case `rangedattack`:
				case `meleedefense`:
					focused = value[`repeating_attr_${rowID}_weaponclass`] || "";
					result = { name: name, attribute: attribute, level: level, focus: focused, source: rowID, customizations: customizations };
				break;
				case `rangeddefense`:
					defense = value[`repeating_attr_${rowID}_defenseclass`] || "";
					result = { name: name, attribute: attribute, level: level, focus: defense, source: rowID, customizations: customizations };
				break;
				case `massivedamage`:
					targeted = getCustomizationValue(debug, timer, value, rowID, 'rank', "targeteddamage") || 0;
					focused = value[`repeating_attr_${rowID}_weaponclass`] || "";
					result = { name: name, attribute: attribute, level: level, targeted: targeted, focus: focused, source: rowID, customizations: customizations };
				break;
				case `heightenedsenses`:
					result = {
						name: name, 
						attribute: attribute, 
						senses: [
							{
								name: 'sight',
								rank: getCustomizationValue(debug, timer, value, rowID, 'rank', 'heightenedsight')
							},
							{
								name: 'hearing',
								rank: getCustomizationValue(debug, timer, value, rowID, 'rank', 'heightenedhearing')
							},
							{
								name: 'touch',
								rank: getCustomizationValue(debug, timer, value, rowID, 'rank', 'heightenedtouch')
							},
							{
								name: 'smell',
								rank: getCustomizationValue(debug, timer, value, rowID, 'rank', 'heightenedsmell')
							},
							{
								name: 'taste',
								rank: getCustomizationValue(debug, timer, value, rowID, 'rank', 'heightenedtaste')
							}
						],
						source: rowID, 
						customizations: customizations
					};
				break;
				case `shield`:
					result = { name: name, attribute: attribute, level: level, source: rowID, customizations: customizations };
				break;
				case `telekinesis`:
				case `swarm`:
				case `weapon`:
					focused = attribute == 'swarm' || attribute == 'telekinesis' ?
						'unarmed' :
						value[`repeating_attr_${rowID}_weaponclass`] || "";
					damagetype = attribute == 'swarm' ? 
						'penetrating' :
						attribute == 'telekinesis' ?
						'blunt' :
						value[`repeating_attr_${rowID}_damagetype`];
					result = { name: name, attribute: attribute, level: level, focus: focused, damagetype: damagetype, source: rowID, customizations: customizations };
				break;
				case 'unaffected':
		
				break;
				default: result = { name: name, attribute: attribute, level: level, source: rowID, customizations: customizations };
			}
			if (isActive) {
				attrdb[`${attribute}`].push(result);
				/*
				if (getIsTargeted(debug, timer, value, rowID, setObj)) {
					const activeID = getIsTargetedActive(debug, timer, value, attrdb, rowID, setObj);
					if (activeID != "") {
						attrdb[`${attribute}`].splice(getActiveIdPosition(attrdb, attribute, activeID), 1);
					}
				}
				*/
			} else {
				attrdb[`${attribute}`].find((attr, i) => {
					if (attr.source == rowID) {
						delete attrdb[`${attribute}`][i]; return true;
					}
				});
				attrdb[`${attribute}`] = attrdb[`${attribute}`].filter(() => { return true });
			}
			clog(debug, timer, 'attrdb:', attrdb, 'setAttrdb()');
		}
		
		function getIsMelee(debug, timer, wpnclass) {
			const melee_types_array = ['exotic','hafted','hilted','polearm','unarmed'];
			const result = melee_types_array.indexOf(wpnclass) !== -1 ? 1 : 0;
			//const result = (/(exotic|hafted|hilted|polearm|unarmed)/i.test(wpnclass)) ? 1 : 0;
			clog(debug, timer, 'result =', result, 'getIsMelee()');
			return result;
		}
		/*
		function getAttackMod(debug, timer, value, attrIDs, wpnclass, sourceAttr) {
			var result = 0,
				ismelee = getIsMelee(debug, timer, wpnclass);
			_.each(attrIDs, (rowID) => {
				let wpnclassType = (ismelee) ? "maclass" : "raclass",
					match = getCustomizationValue(debug, timer, value, rowID, 'rank', `${wpnclassType}`);
				if (wpnclass == match) {
					let active = parseInt(value[`repeating_attr_${rowID}_activate`]);
					if (active) result = result + parseInt(value[`repeating_attr_${rowID}_level`]);
				}
			});
			clog(debug, timer, 'result =', result, 'getAttackMod()');
			return result;
		}
		*/
		function getSumOfActiveAttrLevels(attrdb, attribute, focus = '') {
			var result = 0;
			_.each(attrdb[`${attribute}`], (o) => {
				if (o.targeted == undefined) {
					if (focus == o.focus || o.focus == undefined) {
						result = result + o.level;
					}
				}
			});
			return result;
		}
		
		function setArms(debug, timer, value, rowID, setObj, name, isActive, hand) {
			const extraarmIDs = value.extraarmIDs;
			clog(debug, timer, 'hand =', hand, 'setArms()');
			const handsource = getHandSource(debug, timer, extraarmIDs, hand);
			const source = setObj[`repeating_attr_${rowID}_source`];
			if (isActive) {
				setObj[`${handsource}_name`] = name;
				writeValues(debug, timer, value, `${handsource}_source`, rowID, setObj);
				if (source === undefined || source === '') {
					writeValues(debug, timer, value, `repeating_attr_${rowID}_source`, hand, setObj);
				} else {
					const twohanded = `${source},${hand}`;
					writeValues(debug, timer, value, `repeating_attr_${rowID}_source`, twohanded, setObj);
				}
			} else {
				writeValues(debug, timer, value, `${handsource}_name`, '', setObj);
				writeValues(debug, timer, value, `${handsource}_source`, '', setObj);
				writeValues(debug, timer, value, `repeating_attr_${rowID}_source`, '', setObj);
			}
		}
		
		function updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, source, sourceAttr, setObj){
			clog(debug, timer, 'source =', source, 'updateWeaponStates()');
			const handsource = getHandSource(debug, timer, extraarmIDs, source);
			const state = parseInt(value[`${handsource}_state`]) || 0;
			clog(debug, timer, 'state =', state);
			if(state > 0) {
				//setWeaponStates(debug, timer, extraarmIDs, value, handsource, setObj);	
				setActiveWeapon(debug, timer, value, handsource, setObj);
				setCombatRoll(debug, timer, value, attrdb, value[`${source}_source`], sourceAttr, setObj);
			}
			clearWeaponStates(debug, timer, extraarmIDs, value, setObj);
		}
		
		function setWeapon(isActive, debug, timer, value, attrIDs, extraarmIDs, rowID, sourceAttr, setObj, attrdb, attribute) {
			const name = value[`repeating_attr_${rowID}_name`] || "";
			clog(debug, timer, 'name =', name, 'setWeapon()');
			const hands = 
				attribute === 'telekinesis' || attribute === 'swarm' ? 0 :
				getCustomizationValue(debug, timer, value, rowID, 'rank', 'hands') ? 2 :
				getCustomizationValue(debug, timer, value, rowID, 'rank', 'nohands') ? 0 : 1;
			clog(debug, timer, 'hands =', hands);
			const mainsource = value.mainhand_source || "";
			const offsource = value.offhand_source || "";
			switch (hands) {
				case 0: //no hands
					if (isActive) {
						const extraarmID = generateRowID();
						setArms(debug, timer, value, rowID, setObj, name, true, extraarmID);
						extraarmIDs.push(extraarmID.toLowerCase());
						writeValues(debug, timer, value, `repeating_extraarm_${extraarmID}_state`, 0, setObj);
						writeValues(debug, timer, value, `repeating_extraarm_${extraarmID}_type`, 0, setObj);
						writeValues(debug, timer, value, `repeating_extraarm_${extraarmID}_source`, rowID, setObj);
						writeValues(debug, timer, value, `repeating_extraarm_${extraarmID}_name`, name, setObj);
						writeValues(debug, timer, value, `repeating_extraarm_${extraarmID}_label`, capital(attribute), setObj);
						updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, extraarmID, sourceAttr, setObj);
					} else {
						let source = 
							setObj[`repeating_attr_${rowID}_source`] || 
							value[`repeating_attr_${rowID}_source`] || 
							"";
						let result = source !== "" ? source.toLowerCase() : source;
						if (result.indexOf(',') !== -1) {
							source = source.split(',');
							result = result.split(',');
							const mountid = _.intersection(result, extraarmIDs);
							source = source.splice(source.indexOf(mountid), 1).toString();
							writeValues(debug, timer, value, `repeating_attr_${rowID}_source`, source, setObj);
							result = mountid.toString();
						}
						removeRepeatingRow(`repeating_extraarm_${result}`);
						extraarmIDs.splice(extraarmIDs.indexOf(result), 1);
						value.extraarmIDs = extraarmIDs;
					}
				break;
				case 1: //single handed
					if (isActive) {
						const extrahands = _.chain(extraarmIDs)
							.map(id => {
								const availableHand =
									parseInt(value[`repeating_extraarm_${id}_type`]) === 0 ? '' :
									value[`repeating_extraarm_${id}_source`].length > 0 ? '' :
									id;
								return availableHand;
							})
							.compact()
							.value();
						if (mainsource == "" && attribute != 'shield') {
							//arm mainhand
							setArms(debug, timer, value, rowID, setObj, name, true, "mainhand");
							updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "mainhand", sourceAttr, setObj);
						} else if (offsource == "") {
							//enable dualwield
							setArms(debug, timer, value, rowID, setObj, name, true, "offhand");
							updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "offhand", sourceAttr, setObj);
						} else if (extrahands.length > 0) {
							//enable dualwield w/extraarm
							const id = extrahands[0];
							//arm extraarm
							setArms(debug, timer, value, rowID, setObj, name, true, id);
							updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, id, sourceAttr, setObj);
						} else if (mainsource == offsource) {
							//determine if two-handed and arm mainhand, unarm two-handed or offhand
							disableWeapon(debug, timer, attrIDs, value, mainsource, attrdb, setObj);
							if (attribute == `shield`) {
								setArms(debug, timer, value, rowID, setObj, name, false, "mainhand");
								setArms(debug, timer, value, rowID, setObj, name, true, "offhand");
								updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "offhand", sourceAttr, setObj);
							} else {
								setArms(debug, timer, value, rowID, setObj, name, false, "offhand");
								setArms(debug, timer, value, rowID, setObj, name, true, "mainhand");
								updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "mainhand", sourceAttr, setObj);
							}
						} else {
							//arm mainhand
							if (attribute == `shield`) {
								disableWeapon(debug, timer, attrIDs, value, offsource, attrdb, setObj);
								setArms(debug, timer, value, rowID, setObj, name, true, "offhand");
								updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "offhand", sourceAttr, setObj);
							} else {
								disableWeapon(debug, timer, attrIDs, value, mainsource, attrdb, setObj);
								setArms(debug, timer, value, rowID, setObj, name, true, "mainhand");
								updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "mainhand", sourceAttr, setObj);
							}
						}
					} else {
						let source = setObj[`repeating_attr_${rowID}_source`] || 
							value[`repeating_attr_${rowID}_source`] || '';
						if (source.indexOf(',') > 0) {
							const twohanded = source.split(',');
							setArms(debug, timer, value, rowID, setObj, name, false, twohanded[0]);
							setArms(debug, timer, value, rowID, setObj, name, false, twohanded[1]);
							updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, twohanded[0], sourceAttr, setObj);
						} else {
							setArms(debug, timer, value, rowID, setObj, name, false, source);
							updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, source, sourceAttr, setObj);
						}
					}
				break;
				case 2: //two-handed
					clog(debug, timer, 'two-handed', '');
					if (isActive) {
						const extrahands = _.chain(extraarmIDs)
							.map(id => {
								const availableHand =
									parseInt(value[`repeating_extraarm_${id}_type`]) === 0 ? '' :
									!isFalsey(value[`repeating_extraarm_${id}_source`]) ? '' :
									id;
								return availableHand;
							})
							.compact()
							.value();
						if (mainsource == "" && offsource == "") {
							//arm two-handed
							setArms(debug, timer, value, rowID, setObj, name, true, "mainhand");
							setArms(debug, timer, value, rowID, setObj, name, true, "offhand");
							updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "mainhand", sourceAttr, setObj);
						} else if (extrahands.length > 1) {
							//are there two or more empty exraarms?
							var twohands = _.first(extrahands, 2);
							_.each(twohands, (hand) => {
								setArms(debug, timer, value, rowID, setObj, name, true, hand);
								updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, hand, sourceAttr, setObj);
							});
						} else if (mainsource == offsource) {
							//already using two-handed weapon
							disableWeapon(debug, timer, attrIDs, value, mainsource, attrdb, setObj);
							setArms(debug, timer, value, rowID, setObj, name, true, "mainhand");
							setArms(debug, timer, value, rowID, setObj, name, true, "offhand");
							updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "mainhand", sourceAttr, setObj);
						} else {
							//arm main&off hands, unarm main&off hands
							if (mainsource != "") disableWeapon(debug, timer, attrIDs, value, mainsource, attrdb, setObj);
							if (offsource != "") disableWeapon(debug, timer, attrIDs, value, offsource, attrdb, setObj);
							setArms(debug, timer, value, rowID, setObj, name, true, "mainhand");
							setArms(debug, timer, value, rowID, setObj, name, true, "offhand");
							updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "mainhand", sourceAttr, setObj);
						}
					} else {
						let source = setObj[`repeating_attr_${rowID}_source`] || 
							value[`repeating_attr_${rowID}_source`] || '';
						if (hands_array.indexOf(source) !== -1) {
							setArms(debug, timer, value, rowID, setObj, name, false, "mainhand");
							setArms(debug, timer, value, rowID, setObj, name, false, "offhand");
							updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, "mainhand", sourceAttr, setObj);
						} else {
							if (source.indexOf(',') !== -1) source = source.split(',');
							_.each(source, (extraarm, i) => {
								if (extraarm === source[i]) {
									setArms(debug, timer, value, rowID, setObj, name, false, extraarm);
									updateWeaponStates(debug, timer, attrdb, extraarmIDs, value, extraarm, sourceAttr, setObj);
								}
							});
						}
					}
				break;
			}
		}
		
		function disableWeapon(debug, timer, attrIDs, value, source, attrdb, setObj) {
			setAttrGroupPoolSpentByActivation(debug, timer, false, attrIDs, value, source, setObj);
			setObj[`repeating_attr_${source}_activate`] = 0;
			attrdb.weapon.find((attr, i) => {
				if (attr.source == source) { delete attrdb.weapon[i]; return true; }
			});
			attrdb.weapon = attrdb.weapon.filter(() => { return true });
			clog(debug, timer, 'attrdb.weapon:', attrdb.weapon,'disableWeapon()');
		}
		
		function setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level) {
			const target = (attribute == 'supersense') ? `repeating_senses` : `repeating_active`;
			clog(debug, timer, 'isActive =', isActive, 'setActiveAttribute()');
			if (isActive) {
				const activeID = generateRowID();
				const name = value[`repeating_attr_${rowID}_name`] || "";
				const characteristic = value[`repeating_attr_${rowID}_characteristic`] || "";
				let source = setObj[`repeating_attr_${rowID}_source`] || value[`repeating_attr_${rowID}_source`] || '';
				source = (source.length > 0) ? source + ',' + activeID : activeID;
				clog(debug, timer, 'activeID =', activeID);
				clog(debug, timer, 'name =', name);
				clog(debug, timer, 'characteristic =', characteristic);
				clog(debug, timer, 'source =', source);
				setObj[`repeating_attr_${rowID}_source`] = source;
				setObj[`${target}_${activeID}_name`] = `${name} (${attribute})`;
				setObj[`${target}_${activeID}_characteristic`] = characteristic;
				setObj[`${target}_${activeID}_description`] = buildActiveAttrTooltip(debug, timer, attrdb, attribute, rowID);
				if (attribute == 'telepathy' && level > 3) {
					setRollable(debug, timer, value, rowID, activeID, setObj, attribute);
				} else if (attribute != 'telepathy' && attribute != 'supersense') {
					setRollable(debug, timer, value, rowID, activeID, setObj, attribute);
				}
			} else {
				const source = setObj[`repeating_attr_${rowID}_source`] || value[`repeating_attr_${rowID}_source`] || "";
				setObj[`repeating_attr_${rowID}_source`] = "";
				if(source.length>0) {
					const rowString = `${target}_${source.toLowerCase()}`;
					clog(debug, timer, 'rowString =', rowString);
					removeRepeatingRow(rowString);
				}
			}
		}
		
		function setRollable(debug, timer, value, rowID, activeID, setObj, attribute) {
			const isRollable = rollable_attributes_regex.test(attribute);
			const rollable = (isRollable) ? 1 : 0;
			const attrstat = value[`repeating_attr_${rowID}_stat`] || '';
			const base = isRollable ? `@{stat_total_${attrstat}}` : '';
			const target = isRollable ? targetable_attributes_regex.test(attribute) ? 
				' {{target_name=@{target|charactername}}}' : '' : '';
			const rollmod = 0;
			const rollstring = isRollable ? 
				`&{template:besmDefault} {{rolls=1}} {{title=Attribute Roll}} {{attrroll=1}} ` +
				`{{character_name=@{charactername}}} {{pronoun=@{pronoun}}} {{attribute=${attribute}}} ` +
				`{{base=${base}}} {{total=[[[[?{Roll is|Normal, ${setDice(rollmod)}` +
				`|Minor Edge, ${setDice(rollmod, 1)}|Minor Obstacle, ${setDice(rollmod, -1)}` +
				`|Major Edge, ${setDice(rollmod, 2)}|Major Obstacle, ${setDice(rollmod, -2)}}]]+[[${base}]]]]}} ` +
				`{{roll=$[[0]]}}${target}` : '';
			setObj[`repeating_active_${activeID}_rollable`] = rollable;
			setObj[`repeating_active_${activeID}_rollvalue`] = rollstring;
			clog(debug, timer, 'isRollable =', isRollable,'setRollable()');
			clog(debug, timer, 'rollstring =', rollstring);
		}
		
		function setAttrEffects(debug, timer, isActive, value, attrdb, extraarmIDs, attrIDs, skillIDs, sectionName, rowID, sourceAttr, setObj) {
			const attribute = removeWhiteSpace(value[`repeating_attr_${rowID}_attribute`]);
			const level = parseInt(value[`repeating_attr_${rowID}_effectivelevel`]) || 0;
			switch (attribute) {
				case "absorption":
				case "armor": 
				case "forcefield":
				case "mindshield":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setProtection(isActive, debug, timer, value, rowID, sourceAttr, attribute, setObj);
				break;
				case "attackmastery":
				case "defensemastery":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setDynamicRollValue(debug, timer, {}, value, attrdb, rowID, sourceAttr, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "augmented":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setAugmented(isActive, debug, timer, value, attrdb, rowID, setObj);
					updateSkillRolls(debug, timer, value, skillIDs, sourceAttr, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "combattechnique":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj); 
					setTargeted(isActive, timer, debug, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					if (value.static_roll_type_selection == 'initiative') {
						setDynamicRollValue(debug, timer, false, value, attrdb, rowID, sourceAttr, setObj);
					}
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "conversion":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setProtection(isActive, debug, timer, value, rowID, sourceAttr, attribute, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "defect":
					setDefectdb(isActive, debug, timer, attrdb, value, rowID, setObj);	
					setDefectEffect(debug, timer, attrdb, value, rowID, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "enemyattack":
				case "enemydefense":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setTargeted(isActive, timer, debug, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "energized":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setDerivedValue(debug, timer, attrdb, value, setObj, 'energy');
				break;
				case "extraactions":
				case "extradefenses":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setExtraActions(debug, timer, attrdb, attribute, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "extraarms":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setExtraArms(isActive, debug, timer, extraarmIDs, value, rowID, sourceAttr, setObj);
				break;
				case "heightenedawareness":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "heightenedsenses":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setHeightenedSenses(debug, timer, attrdb, setObj);
				break;
				case "massivedamage":
				case "meleeattack":
				case "meleedefense":
				case "rangedattack":
				case "rangeddefense":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setTargeted(isActive, timer, debug, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "powerflux":
				case "powervariation":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setPoolMax(isActive, debug, timer, value, attrIDs, sectionName, rowID, setObj);
					convertAttrGroupCost(isActive, debug, timer, value, sectionName, attrIDs, rowID, setObj);
					setPoolActive(isActive, value, sectionName, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "shield":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setProtection(isActive, debug, timer, value, rowID, sourceAttr, attribute, setObj);
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setWeapon(isActive, debug, timer, value, attrIDs, extraarmIDs, rowID, sourceAttr, setObj, attrdb, attribute);
				break;
				case "skill": 
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setSkillGroup(isActive, timer, debug, value, rowID, setObj, level);
					setSkillGroupMaxByLevelChange(isActive, timer, debug, value, rowID, setObj);
				break;
				case "socialmastery":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setDerivedValue(debug, timer, attrdb, value, setObj, 'social');
				break;
				case "specialmovement":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setTotalMovement(debug, timer, value, attrdb, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "socialmastery":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "superstrength":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setTotalLift(debug, timer, attrdb, value, setObj);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "swarm":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setSwarmCritters(isActive, debug, timer, value, attrdb, rowID, setObj);
					setWeapon(isActive, debug, timer, value, attrIDs, extraarmIDs, rowID, sourceAttr, setObj, attrdb, attribute);
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "telekinesis":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					if (level > 1) {
						//setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
						setWeapon(isActive, debug, timer, value, attrIDs, extraarmIDs, rowID, sourceAttr, setObj, attrdb, attribute);
					}
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
				break;
				case "tough":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setDerivedValue(debug, timer, attrdb, value, setObj, 'health');
				break;
				case "unassailable":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setDerivedValue(debug, timer, attrdb, value, setObj, 'sanity');
				break;
				case "weapon":
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);
					setWeapon(isActive, debug, timer, value, attrIDs, extraarmIDs, rowID, sourceAttr, setObj, attrdb, attribute);
				break;
				default:
					setAttrdb(isActive, debug, timer, value, attrdb, attrIDs, rowID, sourceAttr, attribute, setObj);	
					setActiveAttribute(isActive, debug, timer, value, rowID, attrdb, setObj, attribute, level);
			}
			clog(debug, timer, 'attribute =', attribute, 'setAttrEffects()');
			setObj.attrdb = JSON.stringify(attrdb);
		}
		
		function setSwarmCritters(isActive, debug, timer, value, attrdb, rowID, setObj){
			const debugtext = '[setSwarmCritters()]';
			const body = parseInt(value.stat_total_body) || 0;
			const soul = parseInt(value.stat_total_soul) || 0;
			const health = (body+soul)*5;
			const wounds = parseInt(value.static_stat_total_wounds) || 0;
			const level = parseInt(value[`repeating_attr_${rowID}_effectivelevel`]) || 0;
			const critters = isActive ? health * level : 0;
			let swarmobj = _.find(attrdb.swarm, o => {
				if(o.source == rowID) return true;
			});
			if(isActive){
				setObj.stat_total_health = critters;
				setObj.static_stat_total_wounds = wounds * level;
				const writecritters = getIsObject(swarmobj) ?
					swarmobj.critters = critters :
					false;
			}else{
				setObj.stat_total_health = health;
				setObj.static_stat_total_wounds = Math.round(wounds/level);
			}
			clog(debug, timer, 'health =', setObj.stat_total_health, 'setSwarmCritters()');
			clog(debug, timer, 'wounds =', setObj.static_stat_total_wounds);
		}
		
		function getAllAspectStat(majorstat) {
			const body_major_stats_array = ['str','agi','dex','con'];
			const mind_major_stats_array = ['int','rea','per','cre'];
			const soul_major_stats_array = ['wil','cha','awa','com'];
			const result = 
				body_major_stats_array.indexOf(majorstat) !== -1 ? 'body' :
				mind_major_stats_array.indexOf(majorstat) !== -1 ? 'mind' :
				soul_major_stats_array.indexOf(majorstat) !== -1 ? 'soul' :
				'';
			/*
			const result = 
				/(str|agi|dex|con)/i.test(minorstat) ? 'body' :
				/(int|rea|per|cre)/i.test(minorstat) ? 'mind' :
				/(wil|cha|awa|com)/i.test(minorstat) ? 'soul' :
				'';
			*/
			return result;
		}
		
		function setDefectEffect(debug, timer, attrdb, value, rowID, setObj) {
			const defectdb = attrdb.defect;
			const defect = removeWhiteSpace(value[`repeating_attr_${rowID}_defect`]);
			switch(defect){
				case "sensoryimpairment":
					setHeightenedSenses(debug, timer, attrdb, setObj);
				break;
				case "shortcoming":
					const aspect = value[`repeating_attr_${rowID}_defectaspect`];
					setStatAspectLevel(debug, timer, attrdb, value, defectdb, aspect, setObj);
					if(aspect.length > 3) {
						const statbase = getStatBase(value, aspect); 
						setStatAspectLevels(debug, timer, attrdb, value, aspect, statbase, setObj);
					}
					setStatAspectView(debug, timer, attrdb, value, setObj);
				break;
				default: return;
			}
		}
		
		function setPoolActive(isActive, value, sectionName, setObj){
			const groupid = getGroupID(value, sectionName);
			setObj[`static_${sectionName}group_${groupid}_active`] = isActive;
		}
		
		function setPoolMax(isActive, debug, timer, value, attrIDs, sectionName, rowID, setObj){
			const groupid = getGroupID(value, sectionName);
			const groupType = value[`static_${sectionName}group_${groupid}_type`];
			const groupCost = _.chain(attrIDs)
				.map(id=>{
					id = id.toLowerCase();
					const group = parseInt(value[`repeating_attr_${id}_group`]) || 0;
					const activated = parseInt(setObj[`repeating_attr_${id}_activate`]) ||
						parseInt(value[`repeating_attr_${id}_activate`]) || 0;
					const attribute = value[`repeating_attr_${id}_attribute`];
					const isWeapon = attribute === 'weapon' ? true : false;
					const isAltmunition = isWeapon && 
						getCustomizationExists('altmunition', value[`repeating_attr_${id}_customizations`]) ?
						2 : 1;
					const totalcost = (parseInt(value[`repeating_attr_${id}_totalcost`]) || 0) * isAltmunition;
					const appliedCost = group == groupid ? 
						id == rowID ? 0 : 
						///flux/i.test(groupType) ? activated ? totalcost : 0 :
						groupType.toLowerCase().indexOf('flux') !== -1 ? activated ? totalcost : 0 :
						totalcost : 0;
					return appliedCost;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			const max = //isActive ? /flux/i.test(groupType) ? 
				isActive && groupType.toLowerCase().indexOf('flux') !== -1 ?
					(parseInt(value[`repeating_${sectionName}_${rowID}_effectivelevel`]) || 0) * 5 : 
				///variation/i.test(groupType) ? groupCost : 0 : 0;
				isActive && groupType.toLowerCase().indexOf('variation') !== -1 ?
					groupCost : 0;
			//setObj[`static_${sectionName}group_${groupid}_groupmax`] = max;
			writeValues(debug, timer, value, `static_${sectionName}group_${groupid}_groupmax`, max, setObj);
		}
		
		function convertAttrGroupCost(isActive, debug, timer, value, sectionName, attrIDs, rowID, setObj){
			const groupid = getGroupID(value, sectionName);
			const groupType = value[`static_${sectionName}group_${groupid}_type`];
			const dynamicGroupCost = parseInt(value[`repeating_${sectionName}_${rowID}_totalcost`]) || 0;
			const aggregateAttrCost = _.chain(attrIDs)
				.map(id=>{
					const group = parseInt(value[`repeating_${sectionName}_${id}_group`]) || 0;
					const activated = parseInt(setObj[`repeating_${sectionName}_${id}_activate`]) ||
						parseInt(value[`repeating_${sectionName}_${id}_activate`]) || 0;
					const totalcost = parseInt(value[`repeating_${sectionName}_${id}_totalcost`]) || 0;
					const appliedCost = //group == groupid ? 
						///flux/i.test(groupType) ? 
						group == groupid && groupType.toLowerCase().indexOf('flux') !== -1 ?
							activated ? 
								totalcost : 0 :
						///variation/i.test(groupType) ? 
						group == groupid && groupType.toLowerCase().indexOf('variation') !== -1 ?
							totalcost : 0;
					return appliedCost;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			clog(debug, timer, 'groupType =', groupType, 'convertAttrGroupCost()');
			if(isActive){
				const groupcost = 
					///flux/i.test(groupType) ? 
					groupType.toLowerCase().indexOf('flux') !== -1 ?
						dynamicGroupCost : 
					groupType.toLowerCase().indexOf('variation') !== -1 ?
					///variation/i.test(groupType) ? 
						aggregateAttrCost : 0;
				const spent = 
					groupType.toLowerCase().indexOf('flux') !== -1 ?	
						aggregateAttrCost - dynamicGroupCost :
					groupType.toLowerCase().indexOf('variation') !== -1 ?
						getPowerVariationPoolCost(debug, timer, isActive, attrIDs, value, rowID, groupid, setObj) :
					0;
				clog(debug, timer, 'spent =', spent);
				clog(debug, timer, 'groupcost =', groupcost);
				setObj[`static_${sectionName}group_${groupid}_spent`] = spent;
				setObj[`static_${sectionName}group_${groupid}_groupcost`] = groupcost;
				
			}else{
				clog(debug, timer, 'spent =', 0);
				clog(debug, timer, 'groupcost =', aggregateAttrCost);
				setObj[`static_${sectionName}group_${groupid}_spent`] = 0;
				setObj[`static_${sectionName}group_${groupid}_groupcost`] = aggregateAttrCost;
			}
		}
		
		function setSkillGroup(isActive, timer, debug, value, rowID, setObj, level) {
			const group = getCharacteristicSpecializationByAttr(debug, timer, value, rowID, 'skill');
			const groupmax = (isActive) ? level * 10 : 0;
			const source = (isActive) ? rowID : "";
			clog(debug, timer, 'groupmax =', groupmax, 'setSkillGroup()');
			clog(debug, timer, 'source =', source);
			setObj[`static_skillgroup_${group}_groupmax`] = groupmax;
			setObj[`static_skillgroup_${group}_source`] = source;
		}
		
		function setSkillGroupMaxByLevelChange(isActive, timer, debug, value, rowID, setObj){
			const isSkillAttr = attribute => attribute=='skill' ? true: false;
			if(isSkillAttr(value[`repeating_attr_${rowID}_attribute`])==false) return;
			const groupid = parseInt(value[`repeating_attr_${rowID}_skillgroup`]) || 0;
			const skillpointmax = isActive ? 
				(parseInt(value[`repeating_attr_${rowID}_effectivelevel`]) || 0) * 10 : 0;
			setObj[`static_skillgroup_${groupid}_groupmax`] = skillpointmax;
			clog(debug, timer, 'groupid =', groupid, 'setSkillGroupMaxByLevelChange()');
			clog(debug, timer, 'skillpointmax =', skillpointmax);
		}
		
		function getIsSheetworker(sourceType) {
			const result = sourceType == `sheetworker` ? true : false;
			return result;
		}
		/*
		function getIsPlayer(sourceType) {
			const result = (sourceType == `player`) ? true : false;
			return result;
		}
		*//*
		function getGroupValue(value, sectionName, groupID, sourceAttr, setObj) {
			let result = setObj[`static_${sectionName}group_${groupID}_${sourceAttr}`] || value[`static_${sectionName}group_${groupID}_${sourceAttr}`];
			result = (Number.isInteger(parseInt(result))) ? parseInt(result) : result;
			return result;
		}
		*/
		function getAttrValue(value, source, sourceAttr, setObj) {
			const attribute = setObj[`${source}_${sourceAttr}`] || value[`${source}_${sourceAttr}`];
			const result = (Number.isInteger(parseInt(attribute))) ? parseInt(attribute) : attribute;
			return result;
		}
		/*
		function showAttrValues(value, source, sourceAttr, setObj) {
			const attrs = [
				"attrdefecttoggle",
				"attribute",
				"bonus",
				"characteristic",
				"costperlevel",
				"customizations",
				"damagetype",
				"display",
				"effect",
				"effectivelevel",
				"endurance",
				"enhancementassignments",
				"activate",
				"fluxenable",
				"group",
				"isflux",
				"level",
				"limiterassignments",
				"name",
				"new",
				"options",
				"rollable",
				"skill",
				"stat",
				"totalcost",
				"visible"
			];
			var result = [];
			_.each(attrs, (attr) => {
				let attrValue = getAttrValue(value, source, attr, setObj),
					tempObj = { "name": `${attr}`, "value": attrValue };
				result[result.length] = tempObj;
			});
		}
		*/
		function getCustomizationExists(customization, customizations) {
			const result = _.isArray(customizations) ?
				getIsObject(customizations.find(o => o.name === customization)) :
				false;
			return result;
		}
		
		function getCustomizationValue(debug, timer, value, rowID, type, customization) {
			// type = 'rank' || 'name';
			const customizations = value[`repeating_attr_${rowID}_customizations`] || [];
			const match = customizations.find((o) => {
				if (o.name === customization) return true;
			});
			const result = match === undefined ? 0 : 
				type === 'rank'	? parseInt(match[`${type}`]) :
				match[`${type}`];
			clog(debug, timer, `${customization} ${type} =`, result, 'getCustomizationValue()');
			return result;
		}
		
		function setCustomization(debug, timer, eventInfo, value, rowID, customization, setObj) {
			const rank = parseInt(eventInfo.newValue);
			let customizations = 
				value[`repeating_attr_${rowID}_customizations`] || [];
			if (!customizations.length) {//create array with first entry
				customizations[0] = 
					{ "name": customization.name, "rank": rank, "type": customization.type };
			} else {
				const result = customizations.find((o, i) => {
					if (o.name === customization.name) {
						if (rank > 0) {//update existing element
							customizations[i] = 
								{ "name": customization.name, "rank": rank, "type": customization.type };
						} else {//remove existing element
							customizations.splice(i, 1);
						}
						return true;
					}
				});
				if (result === undefined) {//add new
					customizations[customizations.length] = 
						{ "name": customization.name, "rank": rank, "type": customization.type };
				}
			}
			clog(debug, timer, 'customizations:', customizations, 'setCustomization()');
			writeValues(debug, timer, value, `repeating_attr_${rowID}_customizations`, customizations, setObj);
			//setObj[`repeating_attr_${rowID}_customizations`] = customizations;
		}
		
		function setUnaffectedWeapons(debug, timer, eventInfo, value, rowID, customization, setObj) {
			const attribute = getIsObject(customization) ? customization.name : 'default';
			if (attribute != 'allweapons') return;
			const rank = parseInt(eventInfo.newValue);
			const unaffectedattributes = value[`repeating_attr_${rowID}_unaffectedattributes`] || [];
			const hasWeapon = unaffectedattributes.length ? 
				unaffectedattributes.indexOf('Weapon') !== -1 ?
					true : false :
				false;
			const showWeapons = hasWeapon ?
				rank ? 
					setObj[`repeating_attr_${rowID}_showunaffectedweapon`] = 0 :
					setObj[`repeating_attr_${rowID}_showunaffectedweapon`] = 1 :
				false;
			clog(debug, timer, 'showWeapons =', showWeapons, 'setUnaffectedWeapons()');
		}
		
		function setUnaffectedAttributes(debug, timer, eventInfo, value, rowID, setObj) {
			const attribute = eventInfo.htmlAttributes.value;
			const state = parseInt(setObj[`repeating_attr_${rowID}_${removeWhiteSpace(attribute)}state`]);
			const unaffectedattributes = value[`repeating_attr_${rowID}_unaffectedattributes`] || [];
			const isAllWeapons = getCustomizationValue(debug, timer, value, rowID, 'rank', 'allweapons') > 0 ?
				true : false;
			const setUnaffectedAttribute = state ?
				unaffectedattributes.push(capital(attribute)) :
				unaffectedattributes.splice(unaffectedattributes.indexOf(capital(attribute)), 1);
			const showWeapons = attribute == 'weapon' ? state && !isAllWeapons ?
				setObj[`repeating_attr_${rowID}_showunaffectedweapon`] = 1 :
				setObj[`repeating_attr_${rowID}_showunaffectedweapon`] = 0 :
				false;
			clog(debug, timer, 'unaffectedattributes:', unaffectedattributes, 'setUnaffectedAttributes()');
			setObj[`repeating_attr_${rowID}_unaffectedattributes`] = unaffectedattributes;
		}
		
		function setAltmunitionCost(debug, timer, customization, attrIDs, attrdb, value, rowID, sourceAttr, setObj) {
			if (customization.name !== 'altmunition') return;
			setAttrCost(debug, timer, value, rowID, setObj);
			setAttrGroupCost(debug, timer, attrIDs, attrdb, value, rowID, sourceAttr, setObj, true);
		}
		
		function getCustomizationTypeTotal(debug, timer, customizations, type) {
			const result = _.chain(customizations)
				.map(c => {
					const typematch = type => c.type == type ? c.rank : 0;
					return typematch(type);
				})
				.reduce((memo, num) => { return memo + num; }, 0)
				.value();
			clog(debug, timer, `${type}`, result, 'getCustomizationTypeTotal()');
			return result;
		}
		
		function setEffectiveLevelByCustomization(debug, timer, value, rowID, setObj) {
			const customizations = setObj[`repeating_attr_${rowID}_customizations`] || [];
			const enhancements = getCustomizationTypeTotal(debug, timer, customizations, 'enhancement');
			const limiters = getCustomizationTypeTotal(debug, timer, customizations, 'limiter');
			const level = parseInt(value[`repeating_attr_${rowID}_level`]) || 0;
			const effectivelevel = level + limiters - enhancements;
			clog(debug, timer, 'effectivelevel =', effectivelevel, 'setEffectiveLevelByCustomization()');
			setObj[`repeating_attr_${rowID}_effectivelevel`] = effectivelevel;
		}
		
		function setDamageType(debug, timer, source, sourceAttr, setObj) {
			//const hasDamageType = /(weapon|armor)/i.test(`${sourceAttr}`);
			const weapon_or_armor_array = ['weapon','armor'];
			const hasDamageType = weapon_or_armor_array.indexOf(sourceAttr) !== -1 ? 
				true : false;
			const setDamageType = (hasDamageType) ? 0 : 1;
			setObj[`${source}_damagetypeenable`] = setDamageType;
			clog(debug, timer, 'setDamageType', setDamageType,'setDamageType()');
		}
		
		function getCV(debug, timer, value, attrdb, setObj, type, focus = 'unarmed') {
			clog(debug, timer, 'focus =', focus, 'getCV()');
			const mastery = 
				(type == 'acv') ? getSumOfActiveAttrLevels(attrdb, 'attackmastery') :
				(type == 'dcv') ? getSumOfActiveAttrLevels(attrdb, 'defensemastery') : 
				0;
			clog(debug, timer, 'mastery =', mastery);
			const isMelee = 
				getIsMelee(debug, timer, focus);
			clog(debug, timer, 'isMelee =', isMelee);
			const specialty = 
				(isMelee && type == 'acv') ? getSumOfActiveAttrLevels(attrdb, 'meleeattack', focus) * 2 :
				(isMelee && type == 'dcv') ? getSumOfActiveAttrLevels(attrdb, 'meleedefense', focus) * 2 :
				(!isMelee && type == 'acv') ? getSumOfActiveAttrLevels(attrdb, 'rangedattack', focus) * 2 :
				(!isMelee && type == 'dcv') ? getSumOfActiveAttrLevels(attrdb, 'rangeddefense', focus) * 2 : 
				0;
			clog(debug, timer, 'specialty =', specialty);
			const state = 
				(type == 'acv') ? 
				isNaN(parseInt(setObj.static_button_targeted_attack)) ?
				parseInt(value.static_button_targeted_attack) || 0 :
				parseInt(setObj.static_button_targeted_attack) :
				(type == 'dcv') ? 
				isNaN(parseInt(setObj.static_button_targeted_defense)) ?
				parseInt(value.static_button_targeted_defense) || 0 :
				parseInt(setObj.static_button_targeted_defense) :
				0;
			clog(debug, timer, 'state =', state);
			const enemy = 
				(type == 'acv' && state) ? 
					getTargetedLevel(attrdb, 'enemyattack') * 2 :
				(type == 'dcv' && state) ? 
					getTargetedLevel(attrdb, 'enemydefense') * 2 : 
				0;
			clog(debug, timer, 'enemy =', enemy);
			/*
			const targeted = 
				(type == 'acv') ? 
					(invertState && sourceAttr == 'attack') ? 
						(state > 0) ? 
							0 : enemy : 
						(state > 0) ? 
							enemy : 0 :
				(type == 'dcv') ? (invertState && sourceAttr == 'defense') ? (state > 0) ? 
					0 : enemy : (state > 0) ? enemy : 0 : 
				0;
			*/
			const cv = 
				Math.round((parseInt(setObj.stat_total_body) + parseInt(setObj.stat_total_mind) +
					parseInt(setObj.stat_total_soul)) / 3) || 
				Math.round(((parseInt(value.stat_total_body) || 0) + (parseInt(value.stat_total_mind) || 0) + 
					(parseInt(value.stat_total_soul) || 0)) / 3) || 
				0;
			clog(debug, timer, 'cv =', cv);
			const result = 
				cv + enemy + specialty + mastery;
			clog(debug, timer, 'result =', result);
			return result;
		}
		
		function setDice(mod, eo = 0) {
			const total = mod + eo,
				hl = (total > 0) ? 'kh2' : (total < 0) ? 'kl2' : '',
				dice = (total > 1 || total < -1) ? 4 : (total == 1 || total == -1) ? 3 : 2,
				result = `${dice}d6${hl}`;
			return result;
		}
		
		function setActiveWeapon(debug, timer, value, handsource, setObj) {
			const state = parseInt(setObj[`${handsource}_state`]) || 0;
			const source = state !== 0 ? value[`${handsource}_source`] : '';
			clog(debug, timer, 'source =', source, 'setActiveWeapon()');
			if (source !== undefined) {
				//setObj.previous_weapon = setObj.active_weapon || value.active_weapon;
				//setObj.active_weapon = result;
				writeValues(debug, timer, value, 'previous_weapon', setObj.active_weapon || value.active_weapon, setObj);
				writeValues(debug, timer, value, 'active_weapon', source, setObj);
			}
		}
		
		function getIsGrappling(maneuver) {
			const grappling_maneuvers_array = ['bite','disarm','grab','lock','pin','throw'];
			return grappling_maneuvers_array.indexOf(maneuver) !== -1 ? true : false;
		}
		
		function setRange(debug, timer, attrdb, customization, selection, setObj) {
			const result = getRange(debug, timer, attrdb, customization, selection);
			setObj.weapon_range_distance = result;
			clog(debug, timer, 'result =', result, 'setRange()');
		}
		
		function getRangeRollmod(debug, timer, selection) {
			const result = selection == 3 ? -2 :
				selection == 2 ? -1 :
				0;
			clog(debug, timer, 'result =', result, 'getRangeRollmod()');
			return result;
		}
		
		function getRangeDistance(debug, timer, selection) {
			const selectobj = {
				1:0.2,
				2:0.5,
				3:1
			};
			const result = selectobj[selection] || 0;
			clog(debug, timer, 'result =', result, 'getRangeDistance()');
			return result;
		}
		
		function getRange(debug, timer, attrdb, customization, selection, isweapon = true) {
			const rank = parseInt(customization.rank);
			const extended = isweapon ?
				getSumOfActiveSubAttrRanks(attrdb, 'combattechnique', 'extendedrange') > 0 ?
				1 : 0 : 0;
			const rangeobj = {
				1:3,
				2:10,
				3:100,
				4:1000,
				5:10000,
				6:100000,
				7:1000000,
				8:10000000,
				9:100000000,
				10:1000000000
			};
			const baserange = rank > 10 ?
				1000000000 * (10 * (rank - 10)) :
				rangeobj[rank] || 0;
			const actualrange = 
				`${Math.round((baserange * (extended + 1)) * getRangeDistance(debug, timer, selection))}`;
			const length = actualrange.length;
			const result = 
				length > 6 ? 
				`${parseInt(actualrange)/1000000}M km` :
				length > 3 ? 
				`${parseInt(actualrange)/1000} km` :
				`${actualrange} m`;
			clog(debug, timer, 'result =', result, 'getRange()');
			return result;
		}
		
		function getDuration(debug, timer, rank) {
			const durationobj = {
				1:'10 minutes (weapons 2 rounds)',
				2:'1 hour (weapons 5 rounds)',
				3:'1 day (weapons 10 rounds)',
				4:'1 week (weapons 1 minute)',
				5:'1 month (weapons 1 hour)',
				6:'1 season (weapons 1 day)',
				7:'1 year (weapons 1 week)',
				8:'10 years (weapons 1 month)',
				9:'100 years (weapons 1 year)',
				10:'Permanent or 1000 years (weapons 10 years)'
			};
			const getUnits = units => (10 * (rank - 10)) * units;
			const result = rank > 10 ?
				`${getUnits(1000)} years (weapons ${getUnits(10)} years)` :
				durationobj[rank] || 0;
			clog(debug, timer, 'result =', result, 'getDuration()');
			return result;
		}
		
		function getTargets(debug, timer, rank) {
			const mod = get1or2andHalfor5(rank);
			const targets = Math.floor(mod * (10 ^ Math.floor(rank / 3)));
			const result = `Affect up to ${targets} Targets at once`;
			clog(debug, timer, 'result =', result, 'getDuration()');
			return result;
		}
		
		function getAmmoMax(debug, timer, rank) {
			const result = 
				rank == 4 ? 0 : 
				rank == 3 ? 1 : 
				6 / rank;
			clog(debug, timer, 'result =', result, 'getAmmoMax()');
			return result;
		}
		
		function setWeaponReload(debug, timer, attrdb, value, setObj) {
			const rowID = value.active_weapon;
			const capacity = parseInt(value[`repeating_attr_${rowID}_capacity`]) || 0;
			let ammostate = parseInt(value.weapon_ammo_reloads) || 0;
			const reloadcapacity = ammostate > 0 ? capacity : 0;
			const reloadammo = ammostate > 0 ? ammostate -= 1 : 0;
			clog(debug, timer, 'active_weapon =', rowID, 'setWeaponReload()');
			writeValues(debug, timer, value, 'weapon_ammo_reloads', reloadammo, setObj);
			writeValues(debug, timer, value, 'weapon_ammo_capacity', reloadcapacity, setObj);
		}
		
		function setWeaponAmmo(debug, timer, attrdb, value, handsource, setObj) {
			const activeHasAmmo = getCustomizationValue(debug, timer, value, setObj.active_weapon, 'rank', 'ammo') ? true : false;
			const previousHasAmmo = getCustomizationValue(debug, timer, value, value.previous_weapon, 'rank', 'ammo') ? true : false;
			if (!activeHasAmmo && !previousHasAmmo) return;
			const state = setObj[`${handsource}_state`];
			const rowID = value[`${handsource}_source`];
			const type = value[`repeating_attr_${rowID}_attribute`];
			const ammostate = parseInt(value.weapon_ammo_reloads) || 0;
			const capacitystate = parseInt(value.weapon_ammo_capacity) || 0;
			clog(debug, timer, 'ammostate =', ammostate, 'setWeaponAmmo()');
			clog(debug, timer, 'capacitystate =', capacitystate);
			if (previousHasAmmo && rowID !== value.previous_weapon && !isFalsey(value.previous_weapon)) {
				clog(debug, timer, 'weapon change, save ammo state', '');
				writeValues(debug, timer, value, `repeating_attr_${value.previous_weapon}_ammostate`, ammostate, setObj);
				writeValues(debug, timer, value, `repeating_attr_${value.previous_weapon}_capacitystate`, capacitystate, setObj);	
			}
			if (type === 'telekinesis' || type === 'swarm') return;
			if (activeHasAmmo && state) {//weapon armed, load ammo state
				clog(debug, timer, 'weapon armed, load ammo state', '');
				const weapon = _.find(attrdb[`${type}`], w => {
					if (w.source == rowID) return true;
				});
				if (!getIsObject(weapon)) return;
				const customization = _.find(weapon.customizations, c => {
					if (c.name == 'ammo') return true;
				});
				if (!getIsObject(customization)) return;
				const ammo = parseInt(customization.rank) === 4 ? 0 :
					isNaN(parseInt(value[`repeating_attr_${rowID}_ammostate`])) ?
						getAmmoMax(debug, timer, customization.rank) : 
						parseInt(value[`repeating_attr_${rowID}_ammostate`]) || 0;
				const capacity = isNaN(parseInt(value[`repeating_attr_${rowID}_capacitystate`])) ? 
					parseInt(customization.rank) === 4 ?
						parseInt(value[`repeating_attr_${rowID}_capacity`]) || 0 :
						0 : parseInt(value[`repeating_attr_${rowID}_capacitystate`]) || 0;
				writeValues(debug, timer, value, 'weapon_ammo_reloads', ammo, setObj);
				writeValues(debug, timer, value, 'weapon_ammo_capacity', capacity, setObj);
			} else if (previousHasAmmo && !state && rowID === value.previous_weapon) {//} if (rowID.length === 20 && !state) {//weapon unarmed, save ammo state
				clog(debug, timer, 'weapon unarmed, save ammo state', '');
				writeValues(debug, timer, value, `repeating_attr_${rowID}_ammostate`, ammostate, setObj);
				writeValues(debug, timer, value, `repeating_attr_${rowID}_capacitystate`, capacitystate, setObj);
			}	
		}
		
		function setActiveWeaponUI(debug, timer, attrdb, value, setObj) {
			//set defaults
			setObj.weapon_range = 0;
			setObj.weapon_ammo_autofire = 0;
			setObj.weapon_ammo = 0;
			setObj.weapon_autofire = 0;
			const weapon = setObj.active_weapon;
			if (!weapon) return;
			const type = value[`repeating_attr_${weapon}_attribute`];
			if (weapon == '') return;
			const weapondb = attrdb[`${type}`].find(o => {
				if (o.source == weapon) return true;
			});
			//set default overrides
			_.each(weapondb.customizations, customization => {
				switch(customization.name){
					case 'ammo':
						setObj.weapon_ammo_autofire = 1;
						setObj.weapon_ammo = 1;
					break;
					case 'autofire':
						setObj.weapon_ammo_autofire = 1;
						setObj.weapon_autofire = 1
					break;
					case 'range':
						const selection = customization.rank > 2 ?
							parseInt(value.static_weapon_range_selection) ||
							1 :
							1;
						setObj.weapon_range = customization.rank > 0 ? 1 : 0;
						setRange(debug, timer, attrdb, customization, selection, setObj);
					break;
				}
			});
		}
		
		function adjustSkillGenreCosts(debug, timer, value, skillIDs, setObj) {
			_.each(skillIDs, id => {
				setSkillCostByRankChange(debug, timer, skillIDs, value, id, setObj);
			});
		}
		
		function getStatByAttr(debug, timer, defectdb, attribute) {
			const attrs_stat_obj = {
				'absorption':['body','con'],
				'alternate form':['body','con'],
				'alternate identity':['body','dex'],
				'change state':['body','str'],
				'cognition':['mind','per'],
				'connected':['soul','awa'],
				'control environment':['soul','wil'],
				'conversion':['body','con'],
				'data access':['mind','rea'],
				'dimension walk':['soul','wil'],
				'elasticity':['body','agi'],
				'exorcism':['soul','com'],
				'extra defenses':['mind','per'],
				'flight':['body','agi'],
				'force field':['body','str'],
				'ground speed':['body','agi'],
				'healing':['soul','wil'],
				'heightened awareness':['mind','per'],
				'heightened senses':['mind','per'],
				'illusion':['mind','cre'],
				'immovable':['body','str'],
				'immunity':['body','con'],
				'immutable':['body','con'],
				'inspire':['soul','cha'],
				'jumping':['body','agi'],
				'metamorphosis':['soul','wil'],
				'mimic':['mind','per'],
				'mind control':['mind','int'],
				'mind shield':['mind','int'],
				'minions':['soul','cha'],
				'mulligan':['soul','com'],
				'nullify':['soul','wil'],
				'plant control':['mind','cre'],
				'portal':['soul','wil'],
				'projection':['mind','cre'],
				'regeneration':['body','con'],
				'reincarnation':['soul','com'],
				'resilient':['body','con'],
				'sensory block':['mind','per'],
				'shield':['body','str'],
				'sixth sense':['soul','awa'],
				'size change':['body','con'],
				'spaceflight':['body','agi'],
				'special movement':['body','agi'],
				'summon creatures':['mind','int'],
				'supersense':['mind','per'],
				'superspeed':['body','agi'],
				'superstrength':['body','str'],
				'swarm':['mind','per'],
				'telekinesis':['mind','int'],
				'telepathy':['mind','int'],
				'teleport':['mind','per'],
				'transfer':['soul','wil'],
				'transmute':['soul','wil'],
				'tunnelling':['body','agi'],
				'unaffected':['body','con'],
				'undetectable':['body','con'],
				'water speed':['body','agi']
			};
			const isUsingMajorAspects = getIsUsingMajorAspects (debug, timer, defectdb) ? 1 : 0;
			const stat = attrs_stat_obj[`${attribute}`] || [];
			const result = stat.length > 0 ? stat[isUsingMajorAspects] : '';
			return result;
		}
		
		function getIsUsingMajorAspects (debug, timer, defectdb) {	
			const isMajorAspect = _.chain(defectdb)
				.map(defect => {
					const rank = defect.name == 'shortcoming' ?
						parseInt(defect.rank) : 0;	
					return rank;
				})
				.reduce((memo, num)=>{ return memo + num; }, 0)
				.value();
			const result = isMajorAspect > 0 ? true : false;
			clog(debug, timer, 'result =', result, 'getIsUsingMajorAspects()');
			return result;
		}
		
		function getAttrStandardEnhancements(debug, timer, attribute) {
			const standard_enhancements_obj = {
				'controlenvironment':['area','duration','range'],
				'dimensionwalk':['area'],
				'dynamicpowers':['area','duration','range','targets'],
				'exorcism':['area','range','targets'],
				'forcefield':['area','duration','range'],
				'healing':['area','range','targets'],
				'illusion':['area','duration','range','targets'],
				'merge':['duration'],
				'metamorphosis':['area','duration','range','targets'],
				'mimic':['duration','range'],
				'mindcontrol':['area','duration','range','targets'],
				'nullify':['area','duration','range','targets'],
				'plantcontrol':['duration'],
				'portal':['area','duration','range','targets'],
				'powerflux':['area','duration','range','targets'],
				'powervariation':['area','duration','range','targets'],
				'projection':['area','duration','range'],
				'sensoryblock':['area','duration','range'],
				'sixthsense':['area'],
				'sizechange':['duration'],
				'summoncreatures':['duration'],
				'telekinesis':['area','range'],
				'telepathy':['area','range','targets'],
				'teleport':['area','range','targets'],
				'transfer':['duration','range'],
				'transmute':['duration','range','targets'],
				'uniqueattribute':['area','duration','range','targets'],
				'unknownpower':['area','duration','range','targets'],
				'weapon':['area','duration','range'],
				'default':[]
			};
			const result = standard_enhancements_obj[attribute] || 
				standard_enhancements_obj['default'];
			clog(debug, timer, 'result =', result, 'getAttrStandardEnhancements()');
			return result;
		}
		
		function getMultivalueCustomizationTooltipDescription(debug, timer, customization, rank) {
			const standard_limiter_descriptions_obj = {
				'activation':[
					'Spend one round preparing the Attribute before it is used',
					'Spend one minute preparing the Attribute before it is used',
					'Spend one hour preparing the Attribute before it is used'
				],
				'assisted':[
					'A single assistant is required for the Attribute to function',
					'A small group of assistants (2-10) are required for the Attribute to function',
					'A large group of assistants (11-100) are required for the Attribute to function'
				],
				'backlash':[
					'The Backlash occurs if the character fails their roll by an significant margin (6 or more)',
					'The Backlash occurs if the character fails their roll by a moderate margin (3 or more)',
					'The Backlash occurs if the character fails their roll'
				],
				'charges':[
					'Only use the Attribute four to six times a day (or session)',
					'Only use the Attribute two or three times a day (or session)',
					'Only use the Attribute once a day (or session)'
				],
				'concentration':[
					'Requires slight concentration. The character can still perform ' +
					'other general actions but cannot perform any combat related actions ' +
					'or use other Attributes that also require Concentration',
					'Requires intense concentration. The character can move at slow ' +
					'speeds and talk with others while using the Attribute but cannot ' +
					'perform any complex actions (including combat) or use any other Attribute',
					'Requires full concentration. The character cannot do anything ' +
					'else while using the Attribute and must remain still to devote their ' +
					'full attention to the Attribute'
				],
				'consumable':[
					'Focus is easy to replace',
					'Focus is hard to replace',
					'Focus is very difficult to replace'
				],
				'creaturetype':[
					'Animals are summoned through supernatural means.',
					'Can summon a variety of weak creatures from other dimensions or planes of existence.'
				],
				'delay':[
					'Delay of a few minutes before it takes full effect',
					'Delay of a few hours before it takes full effect',
					'Delay of a few days before it takes full effect'
				],
				'dependant':[
					'Dependent Attribute does not take effect until one other Attribute is activated',
					'Dependent Attribute does not take effect until two other Attributes are activated',
					'Dependent Attribute does not take effect until three other Attribute are activated'
				],
				'deplete':[
					'Attributes with immediate effects burn 10 Energy Points for each ' +
					'use (or attempted use); ongoing Attributes burn 10 Energy Point ' +
					'each minute of use',
					'Attributes with immediate effects burn 20 Energy Points for each ' +
					'use (or attempted use); ongoing Attributes burn 5 Energy Point ' +
					'each round of use',
					'Attributes with immediate effects burn 30 Energy Points for each ' +
					'use (or attempted use); ongoing Attributes burn 20 Energy Point ' +
					'each round of use'
				],
				'detectable':[
					'Detectable using 1-2 methods',
					'Detectable using 3-5 methods',
					'Detectable using 6-10 methods'
				],
				'emotional':[
					'Use requires significant Emotional investment',
					'Use requires strong Emotional investment',
					'Use requires extreme Emotional investment'
				],
				'environmental':[
					'Adventures often take place in or near the specific environment',
					'Adventures occasionally take place in or near the specific environment',
					'Adventures rarely take place in or near the specific environment'
				],
				'equipment':[
					'Equipment is easily portable, such as a smartphone, wagon, or spell book',
					'Equipment is awkward to move, such as a statue, portable altar, or large furniture',
					'Equipment is static, such as workshop, laboratory, or shrine'
				],
				'forms':[
					'Can transform the subject into one of a range of different but related forms.',
					'Can transform the subject into any form.'
				],
				'group':[
					'Control is restricted to a broad plant group, such as trees, grasses, weeds, bushes, flowers, mosses, vegetables, ferns, vines, seaweed, etc.',
					'Control is restricted to a specific type of plant, such as oak trees, wheat, dandelions, raspberry bushes, club moss, carrots, etc.'
				],
				'imbue':[
					'Imbue 4-5 people',
					'Imbue 2-3 people',
					'Imbue 1 person'
				],
				'influence':[
					'Significant influence within the organization.',
					'Important and diverse role within the organization.'
				],
				'irreversible':[
					'It takes several hours of work or special circumstances to enable ' +
					'the character to transform back to an earlier form',
					'It takes several hours of work or special circumstances to enable ' +
					'the character to transform back to an earlier form, and requires ' +
					'expensive or rare replacement components, ingredients, or prerequisites',
					'It takes several days of work or special circumstances to enable ' +
					'the character to transform back to an earlier form, and requires ' +
					'expensive or rare replacement components, ingredients, or prerequisites'
				],
				'localized':[
					'Affects a large part of the body (torso, both legs or arms, etc.)',
					'Affects a small part of the body (one leg or arm, abdomen, chest, head, etc.)',
					'Affects a tiny part of the body (one hand or foot, face, groin, knee, etc.)'
				],
				'maximum':[
					'The character’s Attribute is at Level 3-4 and always functions at ' +
					'its Maximum effectiveness',
					'The character’s Attribute is at Level 2 and always functions at ' +
					'its Maximum effectiveness',
					'The character’s Attribute is at Level 5+ and always functions at ' +
					'its Maximum effectiveness'
				],
				'object':[
					'The Item’s Attribute still provides moderate benefit to the character',
					'The Item’s Attribute still provides slight benefit to the character',
					'The Item’s Attribute hardly provides any benefit to the character'
				],
				'permanent':[
					'Permanent Attribute is a slight inconvenience',
					'Permanent Attribute is a minor inconvenience',
					'Permanent Attribute is a moderate inconvenience'
				],
				'recovery':[
					'For every 1 minute the character uses the Attribute, the Recovery ' +
					'time is 1 minute before the Attribute functions again. The ' +
					'Attribute can be used for a maximum of 12 hours.',
					'For every 1 minute the character uses the Attribute, the Recovery ' +
					'time is 10 minutes before the Attribute functions again. The ' +
					'Attribute can be used for a maximum of 4 hours.',
					'For every 1 minute the character uses the Attribute, the Recovery ' +
					'time is 1 hour before the Attribute functions again. The ' +
					'Attribute can be used for a maximum of 1 hour.'
				],
				'semipermanent':[
					'a minor inconvenience to the character; can be turned off at a ' +
					'cost of 1 Energy Points/minute',
					'a moderate inconvenience to the character; can be turned off at a ' +
					'cost of 10 Energy Points/minute',
					'a major inconvenience to the character; can be turned off at a ' +
					'cost of 10 Energy Points/round'
				],
				'unique':[
					'imposes minor restrictions on the Attribute',
					'imposes moderate restrictions on the Attribute',
					'imposes major restrictions on the Attribute'
				],
				'unpredictable':[
					'must make a successful average Stat roll (TN 12) to use the Attribute',
					'must make a successful difficult Stat roll (TN 15) to use the Attribute',
					'must make a successful challenging Stat roll (TN 18) to use the Attribute'
				]
			};
			const standard_limiter_descriptions_array = 
				standard_limiter_descriptions_obj[customization] || [];
			const result = rank > 0 ?
				standard_limiter_descriptions_array[rank - 1] : '';
			clog(debug, timer, 'result =', result, 'getMultivalueCustomizationTooltipDescription()');
			return result;
		}
		
		function getSingleDescriptionTooltipText(debug, timer, customization) {
			const tooltipDescriptionObj = {
				'blackout':'Opponent suffers minor obstacle to their Shock check vs Stun attacks.',
				'blindfighting':'Can fight hand-to-hand in poor light or absolute darkness, or against an invisible opponent, just as effectively as under normal conditions.',
				'blindshooting':'Can attack with ranged weapons in poor light or absolute darkness, or against an invisible opponent, just as effectively as under normal conditions.',
				'brutal':'Natural unarmed attacks gain a weapon level equal to this technique’s rank. (automatically factored in to unarmed attacks)',
				'concealment':'An uncanny ability to conceal hand-held objects about your person.',
				'criticalstrike':'Attack rolls exceeding a defense roll by a margin of 12 will inflict triple damage, or by 18 for quadruple damage. If an attack roll produces double sixes but does not exceed the defense roll by a margin of at least 12 then the attack still inflicts double damage.',
				'deadeye':'Attacks made against fast-moving targets reduce their obstacles by one level (minor becomes none, major becomes minor).',
				'defelction':'With a successful defense roll, the character can deflect a ranged attack away harmlessly instead of dodging or blocking.',
				'enhancedknockback':'Add double Attack Combat Value, in meters, to the knockback distance of a successful hit.',
				'extendedrange':'Can use ranged weapons at twice their normal range. (automatically factored in to ranged attacks)',
				'farshot':'Ranged attacks penalized for distance are reduced by one category (minor obstacle becomes none, major obstacle becomes minor).',
				'hardboiled':'Each rank assignment increases Shock Value by 10, up to one-half Health Points. (automatically factored in to Shock Value)',
				'judgeopponent':'Ability to judge opponent’s approximate combat prowess and health status.',
				'lethalblow':'Unarmed attacks do normal damage instead of stun.',
				'lightningreflexes':'Provides minor or major edge to initiative rolls. (automatically factored into initiative rolls)',
				'multipletargets':'Obstacles applied from attacking multiple targets are reduced by one category (minor obstacle becomes none, major obstacle becomes minor).',
				'portablearmory':'Weapons and accessories are always available, requiring no special shortage, and can make simple field modifications in a single round.',
				'preciseaim':'Obstacles applied from called shots or otherwise ‘trick maneuvers’ are reduced by one category (minor obstacle becomes none, major obstacle becomes minor).',
				'rushattack':'In melee combat, ability to use momentum by rushing, leaping, or diving at an opponent.  DM is increased by 1 on successful attack.  Failed rush attack results in minor obstacle for all defense rolls until next initiative the following round. (activated manually under Armed Weapon)',
				'steadyhand':'Obstacles applied to attack rolls while moving or performing complex stunts are reduced by one category (minor obstacle becomes none, major obstacle becomes minor).',
				'reflection':'After a successful Deflection defense roll, a Reflection attack roll may be attempted toward any target within range.  Reflection attempts consume the next action.',
				'tournamentencyclopedia':'Ability to recall statistics, strengths, and weaknesses of opponents participating in a tournament or conflict.',
				'twoweapons':'Obstacles applied to attack rolls while dual wielding are reduced by one category (minor obstacle becomes none, major obstacle becomes minor).  Defending while dual wielding is treated as having 1 level of Extra Defense, defense rolls are made with a minor obstacle.',
				'weaponsencyclopedia':'Ability to recall statistics, strength, and weaknesses of all known commercially available weapons.',
				'balance':'Never loses balance, even when running on a narrow rope or beam.',
				'catlike':'Only take half damage (round down) from most falls and always lands on feet.',
				'fast':'Body (Agility) Stat is doubled for each rank when calculating running speed.',
				'lightfooted':'Can skim over sand, snow, or ice at full speed.',
				'slithering':'Can slither along the ground at normal walking/running speeds; able to move quickly while maintaining a very low profile.',
				'swinging':'Can swing through forests and cities using vines, ropes, webbing, arms, etc.',
				'untrackable':'Never leave footprints or tracks when walking or running.',
				'wallbouncing':'Can move at regular walking speed without touching the ground by bounding back and forth between nearby vertical surfaces (walls).',
				'wallcrawling':'Can cling to walls or ceilings as though they were on the ground or floor.',
				'waterwalking':'Can walk or run over water as if on land.',
				'zendirection':'Will always move in the right direction.',
				'allattributes':'Can transfer any and all selected Attributes of the appropriate Level simultaneously.',
				'allweapons':'Unaffected by any source-related Weapon Attributes, regardless of the assigned Enhancements.',
				'blind':'Can translocate to unknown (and slightly less specific) destinations.',
				'capped':'Health or Energy Point total can never exceed their normal maximum value through the Absorption of damage.',
				'difficulttostop':'Reincarnation can only be stopped with tremendous difficulty as best determined by the campaign scope.',
				'escalate':'Damage that has been blocked by Armor or Forcefield Attributes can be converted into temporary Character Points.',
				'glide':'Can only become airborne if launched from a high place or from a fastmoving vehicle; can only gain speed by diving and only gain altitude by riding thermals.',
				'multipleattributes':'Counteract all source-related Attributes simultaneously (instead of just one) at the appropriate Level.',
				'nonadjacent':'Undetectable at distances exceeding a few metres; can be perceived as normal or with a minor or major obstacle of those nearby.',
				'powers':'Mimic all Attributes/Stats simultaneously at the appropriate Levels. Abilities from more than one character can be mimicked, though each targetted character must be touched (and potentially resisted) individually.',
				'proportionaldamage':'Damage to individual items is applied to the new item when combining; damage is distributed to individual items when seperating.',
				'quickchange':'Change states nearly instantaneously and may attempt to do so as part of a defence roll against an incoming attack.',
				'resize':'Can change the size of the object up or down by 1 Rank for each Level of the Transmute Attribute.',
				'gaseous':'Can Transmute gases into solid objects and vice versa. The maximum Size Rank of objects created out of large quantities of air or other gas is equal to Transmute Level.',
				'roadbound':'Requires a reasonably smooth surface on which to travel, such as a road or other graded surface; can only travel at very slow speeds on rough terrain.',
				'skim':'Limited to skimming no more than a metre or two off the ground or water.',
				'maintain':'A smooth surface or running start is required for landing and take off, and must maintain a minimum speed once airborne to avoid crashing.',
				'spread':'Requires plenty of free space to fly, such as in order to flap wings for lift.',
				'synergistic':'Damage can both be absorbed by this Attribute and converted by the character’s Conversion Attribute at the same time.'
			};
			const result = tooltipDescriptionObj[customization] || '';
			clog(debug, timer, 'result =', result, 'getSingleDescriptionTooltipText()');
			return result;
		}
		
		function getResilientTooltopDescription(debug, timer, customization, rank) {
			const resilient_description_prefix_obj = {
				'acidic':'Acidic Environments',
				'cold':'Cold Environment',
				'electric':'Electric Environment',
				'heat':'Hot Environment',
				'radiation':'Radioactive Environment',
				'toxin':'Toxic Environment'
			};
			const resilient_description_suffix_array = [
				'resilient','complete'
			];
			const result = rank > 0 ?
				`${resilient_description_prefix_obj[customization] ||
				capital(customization)}: ` +
				`${resilient_description_suffix_array[rank - 1]}` : 
				'';
			clog(debug, timer, 'result =', result, 'getResilientTooltopDescription()');
			return result;
		}
		
		function getAttributeSettingTooltipDescription(debug, timer, attrobj, name) {
			const customization = _.find(attrobj.customizations, c => {
				if (c.name === name) return true;
			});
			const result = customization[name];
			clog(debug, timer, 'result =', result, 'getAttributeSettingTooltipDescription()');
			return result;
		}
		
		function getCustomizationsTooltipString(debug, timer, timer, attrobj, attrdb) {
			const base_values_obj = {
				'area':'Area: individual\n\n',
				'duration':'Duration: instant\n\n',
				'range':'Range: self or touch\n\n',
				'targets':'Targets: self or 1 target\n\n'
			};
			const standard_enhancements_array = 
				getAttrStandardEnhancements(debug, timer, attrobj.attribute);
			const customizationsObj = standard_enhancements_array.length > 0 ?
				standard_enhancements_array.reduce((o, key) => 
				({ ...o, [key]: base_values_obj[key]}), {}) : 
				{};
			const resilient_customizations_array = ['acidic','aging','asphyxiation','cold','compression','deadening','decompression','disease','electric','heat','psychosomatic','radiation','rest','sustenance','toxin'];
			const controlenvironment_customizations_array = ['arid','clouds','cold','darkness','gaseous','heat','humidity','light','liquid','smell','sound','storms','vacuum'];
			const binary_customizations_array = ['allattributes','allweapons','blind','capped','difficulttostop','escalate','gaseous','glide','maintain','multipleattributes','nonadjacent','powers','proportionaldamage','quickchange','resize','roadbound','skim','specificattribute','spread','synergistic'];
			const multivalue_customizations_array = ['creaturetype','forms','group','influence'];
			let customizations_array = [];
			_.each(attrobj.customizations, c => {
				const getRankString = rank => rank ? 
					c.name == 'area' || c.name == 'range' ? 
						getRange(debug, timer, attrdb, c, 3, false) : 
					c.name == 'duration' ?
						getDuration(debug, timer, rank) :
					c.name == 'targets' ?
						getTargets(debug, timer, rank) :
					controlenvironment_customizations_array.indexOf(c.name) !== -1 &&
					attrobj.attribute == 'controlenvironment' || 
					undetectable_methods_array.indexOf(c.name) !== -1 &&
					attrobj.attribute == 'undetectable' || 
					sixthsense_phenomena_array.indexOf(c.name) !== -1 && 
					attrobj.attribute == 'sixthsense' ?
						(c.name === 'attrsrc' || c.name === 'uniquephenomena') ?
						customizations_array.push(getAttributeSettingTooltipDescription(debug, timer, attrobj, c.name)) :
						customizations_array.push(c.name) :
					resilient_customizations_array.indexOf(c.name) !== -1 && 
					attrobj.attribute == 'resilient' ?
						getResilientTooltopDescription(debug, timer, c.name, rank) :
					combattechniques_array.indexOf(c.name) !== -1 ||
					special_movements_array.indexOf(c.name) !== -1 ||
					binary_customizations_array.indexOf(c.name) !== -1 ?
						getSingleDescriptionTooltipText(debug, timer, c.name) :
					standard_limiters_array.indexOf(c.name) !== -1 ||
					multivalue_customizations_array.indexOf(c.name) !== -1 ?
						getMultivalueCustomizationTooltipDescription(debug, timer, c.name, rank) :
					attribute_settings_by_customization_array.indexOf(c.name) !== -1 ?
						getAttributeSettingTooltipDescription(debug, timer, attrobj, c.name) :
					rank :
				'';
				attrobj.attribute == 'controlenvironment' || 
				attrobj.attribute == 'undetectable' || 
				attrobj.attribute == 'sixthsense' ? 
					getRankString(c.rank) :
				attrobj.attribute == 'resilient' ? 
					customizationsObj[`${c.name}`] = `${getRankString(c.rank)}\n\n`:
				customizationsObj[`${c.name}`] = `${capital(c.name)}: ${getRankString(c.rank)}\n\n`;
			});
			const prefix = attrobj.attribute == 'controlenvironment' ? 
				'Contolled Environments:' :
			attrobj.attribute == 'undetectable' ?
				'Senses and Techniques:' :
			attrobj.attribute == 'sixthsense' ?
				'Detectable Phenomena:' :
			'';
			attrobj.attribute == 'controlenvironment' || attrobj.attribute == 'undetectable' || attrobj.attribute == 'sixthsense' ? 
				customizationsObj['attreffects'] = `${prefix} ${customizations_array.join(', ')}\n\n` :
			'';
			const result = _.values(customizationsObj).join("");
			clog(debug, timer, 'result =', result, 'getCustomizationsTooltipString()');
			return result;
		}
		
		function buildActiveAttrTooltip(debug, timer, attrdb, attribute, rowID) {
			const defectdb = attrdb.defect;
			const stat = getStatByAttr(debug, timer, defectdb, attribute);
			const attrobj = _.find(attrdb[`${attribute}`], attr => {
				if (attr.source == rowID) return true;
			}) || {};
			const customizations = getCustomizationsTooltipString(debug, timer, timer, attrobj, attrdb);
			const result = stat.length > 0 ? `Stat: ${capital(stat)}\n\n${customizations}` : customizations;
			clog(debug, timer, 'result =', result, 'buildActiveAttrTooltip()');
			return result;
		}
		
		function buildProtectionsString(debug, timer, value, maneuver='') {
			const shockvalue = parseInt(value.stat_total_shock) || 0;
			const forcefield = parseInt(value.protection_forcefield_ar) || 0;
			const shield = parseInt(value.protection_shield_ar) || 0;
			const armor1 = parseInt(value.protection_armor1_ar) || 0;
			const armor2 = parseInt(value.protection_armor2_ar) || 0;
			const armor3 = parseInt(value.protection_armor3_ar) || 0;
			const mindshield = parseInt(value.protection_mindshield_ar) || 0;
			const absorption1 = parseInt(value.protection_absorption1_ar) || 0;
			const absorption2 = parseInt(value.protection_absorption2_ar) || 0;
			const conversion = parseInt(value.protection_conversion_ar) || 0;
			let result = '';
			if(forcefield > 0) result = `${result}{{forcefield=${forcefield}}} `;
			if(shield > 0 && maneuver == 'doesnothing') result = `${result}{{shield=${shield}}} `;
			if(armor1 > 0) result = `${result}{{armor1=${armor1}}} `;
			if(armor2 > 0) result = `${result}{{armor2=${armor2}}} `;
			if(armor3 > 0) result = `${result}{{armor3=${armor3}}} `;
			if(mindshield > 0) result = `${result}{{mindshield=${mindshield}}} `;
			if(absorption1 > 0) result = `${result}{{absorption1=${absorption1}}} `;
			if(absorption2 > 0) result = `${result}{{absorption2=${absorption2}}} `;
			if(conversion > 0) result = `${result}{{conversion=${conversion}}} `;
			result = `${result}{{shockvalue=${shockvalue}}}`;
			clog(debug, timer, 'result =', result, 'buildProtectionsString()');
			return result;
		}
		
		function setCombatRoll(debug, timer, value, attrdb, rowID, sourceAttr, setObj, invertState = false) {
			const activeweapon = setObj.active_weapon === undefined ? 
				rowID || value.active_weapon : setObj.active_weapon;
			const type = value[`repeating_attr_${activeweapon}_attribute`];
			const weapon = 
				_.find(attrdb[`${type}`], o => { if (o.source == activeweapon) return o; });
			const isWeapon = 
				getIsObject(weapon);
			const isTelekinesis =
				getIsObject(_.find(attrdb.telekinesis, o => { if (o.source == activeweapon) return o; }));
			const isSwarm = 
				getIsObject(_.find(attrdb.swarm, o => { if (o.source == activeweapon) return o; }));
			const targetedmdState = 
				parseInt(value.static_button_targeted_damage) || 0;
			const targetedmdLevel = 
				getTargetedLevel(attrdb, 'massivedamage') || 0;
			const targetedmd = 
				//invertState && sourceAttr == 'damage' ?
				//targetedmdState > 0 ? 0 : targetedmdLevel :
				targetedmdState ? targetedmdLevel : 0;
			const rushattackState =
				isNaN(parseInt(setObj.static_button_targeted_rushdamage)) ?
				parseInt(value.static_button_targeted_rushdamage) || 0 :
				parseInt(setObj.static_button_targeted_rushdamage);
			const rushattackLevel = 
				//getRushAttack(debug, attrdb);
				getSumOfActiveSubAttrRanks(attrdb, 'combattechnique', 'rushattack');
			const rushattack = rushattackState ? rushattackLevel : 0;
			const name = 
				isWeapon ? weapon.name : 'Unarmed';
			const level = 
				isWeapon ? weapon.level :
				getSumOfActiveSubAttrRanks(attrdb, 'combattechnique', 'brutal') || 0;
			const weaponclass = 
				isWeapon ? weapon.focus : 'unarmed';
			const damagetype = 
				isWeapon ? weapon.damagetype : 'blunt';
			const isMelee = 
				type == 'shield' ? true :
				getIsMelee(debug, timer, weaponclass);
			const muscle = 
				isMelee > 0 ? 1 :
				_.find(weapon.customizations, o => { if (o.name == 'muscle') return 1; }) || 0;
			const massivedamage = 
				getSumOfActiveAttrLevels(attrdb, 'massivedamage', weaponclass) || 0;
			const superstrength = 
				getSumOfActiveAttrLevels(attrdb, 'superstrength') || 0;
			const maneuverSelected =_.isString(setObj.static_weapon_maneuver_name) ? 
				setObj.static_weapon_maneuver_name : 
				value.static_weapon_maneuver_name;
			if (maneuverSelected === undefined) return;
			const maneuverTitleCase = capital(maneuverSelected);
			const maneuver = removeWhiteSpace(maneuverSelected);
			const acv = 
				attack_maneuvers_regex.test(maneuver) ? 
				isSwarm ?  parseInt(weapon.level) + 4 :
				getCV(debug, timer, value, attrdb, setObj, 'acv', weaponclass) : 0;
			const dcv = 
				defense_maneuvers_regex.test(maneuver) ? 
				isSwarm ? 0 :
				getCV(debug, timer, value, attrdb, setObj, 'dcv', weaponclass) : 0;
			let damage = isSwarm ?
				Math.round(weapon.critters/10) :
				isTelekinesis ?
				(((level - 2) + massivedamage + targetedmd) * 5) + acv :
				((level + (superstrength * muscle) + massivedamage + targetedmd + rushattack) * 5) + acv;
			let edge = 
				(isWeapon) ? _.find(weapon.customizations, c => { 
					if (c.name == 'accurate' || c.name == 'parry') return true; 
				}) ||  { rank: 0 } : { rank: 0 };
			let obstacle = 
				(isWeapon) ? _.find(weapon.customizations, c => { 
					if (c.name == 'inaccurate') return true; 
				}) || { rank: 0 } : { rank: 0 };
			let rollmod = 
				edge.rank + obstacle.rank;
			damage = 
				non_damaging_attack_regex.test(maneuver) ? 0 : damage;		
			rollmod = 
				minor_obstacle_maneuvers_regex.test(maneuver) ? rollmod - 1 :
				major_obstacle_maneuvers_regex.test(maneuver) ? rollmod - 2 :
				maneuver == 'disarm' && isMelee ? rollmod - 1 :
				maneuver == 'disarm' ? rollmod - 2 :
				rollmod;
			const weakpoint = 
				maneuver == 'weakpoint' ? 
				`{{weakpoint=[[ [[?{Weak Point is|Large, ${setDice(rollmod, -2)}` +
				`|Small, ${setDice(rollmod, -1)}|Tiny, ${setDice(rollmod, -1)}}]] ]] }}` : 
				'';
			var result = `&{template:besmDefault} {{ismelee=${isMelee}}} ` +
				`{{character_name=@{charactername}}} {{pronoun=@{pronoun}}} ` +
				`{{maneuver=${maneuverTitleCase}}} {{weapon_name=${name}}}`;
			if (acv > 0) {
				result = `${result} {{title=Attack}} {{attack=1}} {{target_name=@{target|charactername}}} ` +
					`{{acv=${acv}}} {{damage_type=${damagetype}}} {{damage2=${Math.round(damage * 0.25)}}} ` +
					`{{damage3=${Math.round(damage * 0.35)}}} {{damage4=${Math.round(damage * 0.45)}}} ` +
					`{{damage5=${Math.round(damage * 0.55)}}} {{damage6=${Math.round(damage * 0.65)}}} ` +
					`{{damage7=${Math.round(damage * 0.75)}}} {{damage8=${Math.round(damage * 0.9)}}} ` +
					`{{damage9=${Math.round(damage * 1.05)}}} {{damage10=${Math.round(damage * 1.2)}}} ` +
					`{{damage11=${Math.round(damage * 1.35)}}} {{damage12=${Math.round(damage * 1.5)}}}`;
				if (isWeapon > 0){
					_.each(weapon.customizations, customization => {
						switch (customization.name) {
							case 'area':
								const radius = get1or3(customization.rank, 3) * (10 ** (Math.ceil((customization.rank) / 2)));
								result = `${result} {{${customization.name}=${customization.rank}}} {{radius=${radius}}}`;
							break;
							case 'autofire':
								const firemode = parseInt(setObj[`static_weapon_autofire_selection`]) || 
									parseInt(value[`static_weapon_autofire_selection`]) || 1;
								const numhits = firemode == 1 ?
									`{{hits2=1}} {{hits3=1}} {{hits4=1}} {{hits5=1}} {{hits6=1}} {{hits7=1}} {{hits8=1}} {{hits9=1}} {{hits10=1}} {{hits11=1}} {{hits12=1}}` :
									firemode == 3 ?
									`{{hits2=1}} {{hits3=1}} {{hits4=1}} {{hits5=1}} {{hits6=2}} {{hits7=2}} {{hits8=2}} {{hits9=2}} {{hits10=3}} {{hits11=3}} {{hits12=3}}` :
									firemode == 6 ?
									`{{hits2=1}} {{hits3=1}} {{hits4=1}} {{hits5=2}} {{hits6=2}} {{hits7=2}} {{hits8=3}} {{hits9=3}} {{hits10=4}} {{hits11=5}} {{hits12=6}}` :
									'';
								result = `${result} {{${customization.name}=${customization.rank}}} {{rof=${firemode}}} ${numhits}`;
							break;
							case 'backblast':
								const bystander = customization.rank > 1 ? 'User and bystanders' :
									customization.rank > 0 ? 'Bystanders only' : '';
								result = `${result} {{bystander=${bystander}}} {{${customization.name}=${customization.rank}}} {{continuing2=${Math.round((damage * 0.25)/5)}}} {{continuing3=${Math.round((damage * 0.35)/5)}}} {{continuing4=${Math.round((damage * 0.45)/5)}}} {{continuing5=${Math.round((damage * 0.55)/5)}}} {{continuing6=${Math.round((damage * 0.65)/5)}}} {{continuing7=${Math.round((damage * 0.75)/5)}}} {{continuing8=${Math.round((damage * 0.9)/5)}}} {{continuing9=${Math.round((damage * 1.05)/5)}}} {{continuing10=${Math.round((damage * 1.2)/5)}}} {{continuing11=${Math.round((damage * 1.35)/5)}}} {{continuing12=${Math.round((damage * 1.5)/5)}}}`;
							break;
							case 'blight':
								const blightrank = customization.rank > 2 ? 18 :
									customization.rank > 1 ? 15 :
									customization.rank > 0 ? 12 : 0;
								result = `${result} {{${customization.name}=${blightrank}}}`;
							break;
							case 'continuing':
								result = `${result} {{${customization.name}=${customization.rank}}} {{continuing2=${Math.round((damage * 0.25)/5)}}} {{continuing3=${Math.round((damage * 0.35)/5)}}} {{continuing4=${Math.round((damage * 0.45)/5)}}} {{continuing5=${Math.round((damage * 0.55)/5)}}} {{continuing6=${Math.round((damage * 0.65)/5)}}} {{continuing7=${Math.round((damage * 0.75)/5)}}} {{continuing8=${Math.round((damage * 0.9)/5)}}} {{continuing9=${Math.round((damage * 1.05)/5)}}} {{continuing10=${Math.round((damage * 1.2)/5)}}} {{continuing11=${Math.round((damage * 1.35)/5)}}} {{continuing12=${Math.round((damage * 1.5)/5)}}}`;
							break;
							case 'drain':
								const draintype = value[`repeating_attr_${rowID}_draintype`] || '';
								result = `${result} {{${customization.name}=${customization.rank}}} {{draintype=${draintype}}}`;
							break;
							case 'duration':
								const timeobj = {
									1:"2 rounds",
									2:"5 rounds",
									3:"10 rounds",
									4:"1 minute",
									5:"1 hour",
									6:"1 day",
									10:"Permanent"
								};
								const time = timeobj[customization.rank] || "0";
								result = `${result} {{${customization.name}=${customization.rank}}} {{time=${time}}}`;
							break;
							case 'enervation':
								result = `${result} {{${customization.name}=${customization.rank * 5}}}`;
							break;
							case 'flareaudible':
							case 'flarescent':
							case 'flaretactile':
							case 'flaretaste':
							case 'flarevisual':
								const sense = customization.name.replace(/flare/g, '');
								const obstacle = customization.rank > 2 ? 'Major' :
									customization.rank > 1 ? 'Minor' : 'No';
								result = `${result} {{flare=${customization.rank}}} {{sense=${sense}}} {{obstacle=${obstacle}}}`;
							break;
							case `flexible`: 
								rollmod = (getIsGrappling(maneuver)) ? rollmod - customization.rank : rollmod;
								result = `${result} {{${customization.name}=${customization.rank}}}`;
							break;
							case `homing`: 
								rollmod = rollmod + customization.rank; 
								result = `${result} {{${customization.name}=${customization.rank}}}`;
							break;
							case `indirect`: 
								rollmod = rollmod - 1;
								result = `${result} {{${customization.name}=${customization.rank}}}`;
							break;
							case 'incapacitating':
							case 'irritant':
								const hasobstacle = customization.rank > 2 ? 'major' :
									customization.rank > 1 ? 'minor' : 'none';
								result = `${result} {{${customization.name}=${customization.rank}}} {{obstacle=${hasobstacle}}}`;
							break;
							case 'incurable':
								const recovery = customization.rank > 2 ? 'special' :
								customization.rank > 1 ? 'slow' : 'normal';
								result = `${result} {{${customization.name}=${customization.rank}}} {{recovery=${recovery}}}`;
							break;
							case 'knockback':
								const kb = 1 << customization.rank -1;
								result = `${result} {{${customization.name}=${customization.rank}}} {{kb=${kb}}}`;
							break;
							case 'nonpenetrating':
								const wontpenetrate = parseInt(customization.rank * 10);
								result = `${result} {{${customization.name}=${customization.rank}}} {{wontpenetrate=${wontpenetrate}}}`;
							break;
							case 'penetrating':
							case 'piercing':
								const penname = customization.name == 'penetrating' ? 'Armor' :
									customization.name == 'piercing' ? 'Forcefield' : '';
								const pen = customization.rank * 10;
								const pentype = capital(customization.name);
								result = `${result} {{penname=${penname}}} {{pentype=${pentype}}} {{pen=${pen}}}`;
							break;
							case 'quake':
								const fissureobj = {
									1:"2",
									2:"5",
									3:"10",
									4:"30",
									5:"100",
									6:"300"
								};
								const fissure = fissureobj[customization.rank] || "0";
								result = `${result} {{${customization.name}=${customization.rank}}} {{fissure=${fissure}}}`;
							break;
							case 'range':
								const selection = customization.rank > 2 ?
									parseInt(setObj.static_weapon_range_selection) || 
									parseInt(value.static_weapon_range_selection) ||
									1 :
									1;
								setRange(debug, timer, attrdb, customization, selection, setObj);
								const range = setObj.weapon_range_distance;
								rollmod = rollmod + getRangeRollmod(debug, timer, selection);
								result = `${result} {{${customization.name}=${customization.rank}}} {{range=${range}}}`;
							break;
							case 'stoppable':
								const stopdamage = (parseInt(value[`repeating_attr_${rowID}_level`]) || 0) * 10;
								const timetostop = customization.rank > 3 ? '1 hour' :
									customization.rank > 2 ? '1 minute' :
									customization.rank > 1 ? '5 rounds' :
									customization.rank > 0 ? '1 round' : '';
								result = `${result} {{${customization.name}=${customization.rank}}} {{timetostop=${timetostop}}} {{stopdamage=${stopdamage}}}`;
							break;
							case 'tangle':
								result = `${result} {{${customization.name}=${customization.rank * 5}}}`;
							break;
							case 'exclusive':
							case 'targeted':
								const hasenemy = value[`repeating_attr_${rowID}_enemy`] || '';
								result = `${result} {{${customization.name}=${customization.rank}}} {{hasenemy=${hasenemy}}}`;
							break;
							case 'toxic':
								const escapable = customization.rank > 1 ? 'Escapable' :
									customization.rank > 0 ? 'Non-escapable' : '';
								result = `${result} {{${customization.name}=${customization.rank}}} {{escapable=${escapable}}}`;
							break;
							case 'unreliable':
								const failure = customization.rank > 1 ? `${customization.rank + 1} or less` :
									customization.rank > 0 ? '2' : '';
								result = `${result} {{${customization.name}=${customization.rank}}} {{failure=${failure}}}`;
							break;
							case 'vampiric':
								const stolenhealth = customization.rank > 2 ? 'Increase' :
									customization.rank > 0 ? 'Restore' : '';
								result = `${result} {{${customization.name}=${customization.rank}}} {{stolenhealth=${stolenhealth}}}`;
							break;
							case 'contact':
							case 'contagious':
							case 'fieldless':
							case 'helper':
							case 'inconspicuous':
							case 'insidious':
							case 'multidimensional':
							case 'nostun':
							case 'psychic':
							case 'reach':
							case 'selective':
							case 'spreading':
							case 'stunonly':
								result = `${result} {{${customization.name}=${customization.rank}}}`;
						}
					});
				}
				result = `${result} {{total=[[[[?{Roll is|Normal, ${setDice(rollmod)}` +
					`|Minor Edge, ${setDice(rollmod, 1)}|Minor Obstacle, ${setDice(rollmod, -1)}` +
					`|Major Edge, ${setDice(rollmod, 2)}|Major Obstacle, ${setDice(rollmod, -2)}}]]+` +
					`[[${acv}]]]]}} {{roll=$[[0]]}}`;
			} else if (dcv > 0) {
				if (maneuver == 'defendother') result = `${result} {{target_name=@{target|charactername}}}`;
				result = `${result} {{dcv=${dcv}}} {{title=Defend}} {{defense=1}} ` +
					`{{total=[[[[?{Roll is|Normal, ${setDice(rollmod)}` +
					`|Minor Edge, ${setDice(rollmod, 1)}|Minor Obstacle, ${setDice(rollmod, -1)}` +
					`|Major Edge, ${setDice(rollmod, 2)}|Major Obstacle, ${setDice(rollmod, -2)}}]]+` +
					`[[${dcv}]]]]}} {{roll=$[[0]]}} ${buildProtectionsString(debug, timer, value, maneuver)}`;
			} else {
				result = `&{template:besmDefault} {{character_name=@{charactername}}} ` +
					`{{maneuver=does nothing}} {{doesnothing=1}} {{title=Does Nothing}} ` +
					`${buildProtectionsString(debug, timer, value, maneuver)}`;
			}
			clog(debug, timer, 'result =', result, 'setCombatRoll()');
			setObj.maneuverroll = result;
		}
		/*
		function setSizeTemplate(value, sizetempateIDs, rowID, setObj) {
				_.each(sizetempateIDs, templateID => { 
					if (templateID!=rowID) setObj[`repeating_sizetemplate_${templateID}_selection`] = 0;
				});
				setObj.size = value[`repeating_sizetemplate_${rowID}_label`];
				setObj.height = value[`repeating_sizetemplate_${rowID}_height`];
				setObj.mass = value[`repeating_sizetemplate_${rowID}_mass`];
				setObj.size_lift = value[`repeating_sizetemplate_${rowID}_lift`];
				setObj.size_strdmg = value[`repeating_sizetemplate_${rowID}_strdmg`];
				setObj.size_ar = value[`repeating_sizetemplate_${rowID}_ar`];
				setObj.size_extradmg = value[`repeating_sizetemplate_${rowID}_extradmg`];
				setObj.size_rnghitdef = value[`repeating_sizetemplate_${rowID}_rnghitdef`];
				setObj.size_rngspd = value[`repeating_sizetemplate_${rowID}_rngspd`];
		}
		*/
		function writeHiddenDamageAttributes(sheetdb) {
			var damage = [];
			for (let i = 2; i == 12; i++) {
				damage[damage.length] = `damage${i}`;
			}
			_.each(damage, (obj) => {
				sheetdb[`${obj}`] = 0;
			});
		}
		
		function recordAmmoState(debug, timer, value, setObj) {
			clog(debug, timer, '', '', 'recordAmmoState()');
			writeValues(debug, timer, value, `repeating_attr_${value.active_weapon}_ammostate`, value.weapon_ammo_reloads, setObj);
			writeValues(debug, timer, value, `repeating_attr_${value.active_weapon}_capacitystate`, value.weapon_ammo_capacity, setObj);
		}
		
		function disableActiveWeapon(debug, timer, value, rowID, setObj) {
			clog(debug, timer, '', '', 'disableActiveWeapon()');
			const attribute = value[`repeating_attr_${rowID}_attribute`];
			if (attribute !== 'weapon') return;
			const activeweapon = value.active_weapon || '';
			if (activeweapon.length !== 0) recordAmmoState(debug, timer, value, setObj);
			setObj.weapon_range = 0;
			setObj.weapon_ammo_autofire = 0;
			setObj.weapon_ammo = 0;
			setObj.weapon_autofire = 0;
			const state = parseInt(setObj[`repeating_attr_${rowID}_activate`]) || 
				parseInt(value[`repeating_attr_${rowID}_activate`]) || 0;
			clog(debug, timer, 'state =', state);
			clog(debug, timer, 'activeweapon =', activeweapon);
			if (!state) return;
			if (activeweapon === rowID) {
				setObj.active_weapon = '';
			}
		}
		
		function setButtonState(debug, timer, value, source, rowID, sourceAttr, setObj) {
			const theme = parseInt(value.theme) || 1;
			const attribute = sourceAttr;
			const setstate = value[`${source}_${attribute}`] || 0;
			const state = setstate == 0 ? 1 : 0;
			const counterstate = state == 0 ? 1 : 0;
			const counterdefense = 
				rowID=='personal' ? 'movement': 
				rowID=='movement' ? 'personal': 
				'';
			//setObj[`${source}_${attribute}`] = state;
			clog(debug, timer, 'attribute =', attribute, 'setButtonState()');
			writeValues(debug, timer, value, `${source}_${attribute}`, state, setObj)
			setObj[`${source}_activatetheme`] = theme;
			//writeValues(debug, timer, value, `${source}_activatetheme`, theme, setObj)
			if(counterdefense.length>0) {
				setObj[`static_button_${counterdefense}_defense`] = counterstate;
				//writeValues(debug, timer, value, `static_button_${counterdefense}_defense`, counterstate, setObj)
				clog(debug, timer, `${counterdefense} =`, counterstate);
			}
			return state;
		}
		
		function buildHandsArray(debug, timer, extraarmIDs){
			const extrahands = _.map(extraarmIDs, id => {
				return `repeating_extraarm_${id}`;
			});
			const result = hands_array.concat(extrahands);
			clog(debug, timer, 'result:', result, 'buildHandsArray()');
			return result;
		}
		
		function getHandSource(debug, timer, extraarmIDs, rowID){
			if (rowID === undefined) return false;
			rowID = rowID.toLowerCase();
			const handsource = /(mainhand|offhand)/i.test(rowID) ? rowID : 
				extraarmIDs !== undefined ? extraarmIDs.indexOf(rowID) !== -1 ?
					`repeating_extraarm_${rowID}` : '' : '';
			clog(debug, timer, 'handsource =', handsource, 'getHandSource()');
			const handscheck = handsource !== '' ? handsource.indexOf(',') > 0 ? 
				handsource.split(',') : handsource : false;
			clog(debug, timer, 'handscheck =', handscheck);
			const result = handscheck !== false ? _.isArray(handscheck) ? 
				handscheck[0] : handscheck : false;
			clog(debug, timer, 'result =', result);
			return result;
		}
		
		function clearWeaponStates(debug, timer, extraarmIDs, value, setObj) {
			const handsArray = buildHandsArray(debug, timer, extraarmIDs);
			_.each(handsArray, hand => {
				writeValues(debug, timer, value, `${hand}_state`, 0, setObj);
			});
		}
		
		function setWeaponStates(debug, timer, extraarmIDs, value, handsource, setObj) {
			clog(debug, timer, 'handsource =', handsource, 'setWeaponStates()');
			const armedID = 
				setObj[`${handsource}_source`] ||
				value[`${handsource}_source`];
			clog(debug, timer, 'armedID =', armedID);
			//const handSources = value[`repeating_attr_${armedID}_source`] !== undefined ?
			//	value[`repeating_attr_${armedID}_source`].indexOf(',') !== -1 ?
			//		value[`repeating_attr_${armedID}_source`].split(',') :
			//		value[`repeating_attr_${armedID}_source`] : '';
			//const isTwoHanded = _.isArray(handSources);
			const handsArray = buildHandsArray(debug, timer, extraarmIDs);
			clog(debug, timer, 'handsArray =', handsArray);
			const handsStateArray = 
				_.map(handsArray, hand => {
					const source = setObj[`${hand}_source`] || value[`${hand}_source`];
					clog(debug, timer, 'hand[source] =', `${hand}[${source}]`);
					const state = parseInt(setObj[`${hand}_state`]) || parseInt(value[`${hand}_state`]) || 0;
					clog(debug, timer, 'state =', state);
					//const isActive = //isNaN(parseInt(setObj[`repeating_attr_${source}_activate`])) ?
						//parseInt(value[`repeating_attr_${source}_activate`]) || 0 :
					//	parseInt(setObj[`repeating_attr_${source}_activate`]) || 0;
					//clog(debug, timer, 'isActive =', isActive);
					//const sourceHandPosition = handSources.indexOf(hand);
					const isExtraArm = extraarmIDs.indexOf(hand) !== -1 ? true : false;
					const extraArmType = parseInt(value[`${hand}_type`]) || false;
					const isWeaponMount = isExtraArm && extraArmType === 0 ? true : false;
					const handstate = source == armedID ?
						//isTwoHanded ?
						//	parseInt(setObj[`${handSources[0]}_state`]) || parseInt(value[`${handSources[0]}_state`]) === 0 ? 1 : 0 :
						state === 0 ? 1 : 0 : 0;
					return handstate;
				});
			clog(debug, timer, 'handsStateArray:', handsStateArray);
			_.each(handsArray, (hand, i) => {
				clog(debug, timer, 'hand[state]', `${hand}[${handsStateArray[i]}]`);
				//setObj[`${hand}_state`] = handsStateArray[i];
				writeValues(debug, timer, value, `${hand}_state`, handsStateArray[i], setObj);
			});
		}
		
		function getIsCustomization(debug, timer, sourceAttr) {
			const result = 
				sourceAttr.indexOf('enhancement') !== -1 || 
				sourceAttr.indexOf('limiter') !== -1 ?
					true : false;
			clog(debug, timer, 'result =', result,'getIsCustomization()');
			return result;
		}
		
		function getCustomizationType(debug, timer, sourceAttr) {
			const result = 
				sourceAttr.indexOf('enhancement') !== -1 ? 'enhancement' :
				sourceAttr.indexOf('limiter') !== -1 ? 'limiter' : '';
			clog(debug, timer, 'result =', result,'getCustomizationType()');
			return result;
		}
		
		function getCustomizationName(debug, timer, sourceAttr, type) {
			const result = sourceAttr.replace(type, '');
			clog(debug, timer, 'result =', result,'getCustomizationName()');
			return result;
		}
		
		function setDepleteRules(debug, timer, value, attrIDs, setObj) {
			const state = (parseInt(value.static_rules_deplete_alt) || 0) == 1 ?
				1 : 0;
			if (_.isArray(attrIDs)) {
				_.each(attrIDs, id => {
					setObj[`repeating_attr_${id}_altdeplete`] = state;
				});
			} else {
				setObj[`repeating_attr_${attrIDs}_altdeplete`] = state;
			}
			clog(debug, timer, 'state =', state, 'setDepleteRules()');
		}
		
		function setDepleteResurvation(debug, timer, attrdb, value, rowID, setObj) {
			const depleteRank = getCustomizationValue(debug, timer, value, rowID, 'rank', 'deplete');
			const useDepleteAltRules = (parseInt(value.static_rules_deplete_alt) || 0);
			if (!depleteRank && !useDepleteAltRules) return;
			const totalDepete = _.chain(all_attributes_array)
				.map( a => {
					if (_.isEmpty(attrdb[a])) return 0;
					const isInstantaneousAttr = 
						instantaneous_attributes_array.indexOf(a) !== -1 ? 2 : 1;
					const attr_deplete = _.chain(attrdb[a]).map( o => {
						const deplete = _.find(o.customizations, c => {
							if (c.name === 'deplete') return true;
						});
						if (deplete === undefined) return 0;
						const reservedEP = (deplete.rank * 5) * isInstantaneousAttr;
						return reservedEP;
					}).reduce((memo,stat)=>{ return memo + stat; }).value() || 0;
					return attr_deplete;
				}).reduce((memo,stat)=>{ return memo + stat; }).value();
			setDerivedValue(debug, timer, attrdb, value, setObj, 'energy');
			const result = setObj.stat_total_energy - totalDepete;
			writeValues(debug, timer, value, 'stat_total_energy', result, setObj);
			clog(debug, timer, 'result =', result, 'setDepleteResurvation()');
			setDamageLevelByDamageTaken(debug, timer, value, setObj, 'fatigue');
		}
		
		function getStatStateArray(debug, timer, value, setObj, type, source = '') {
			const stats = type.major == 1 ? major_stats_array : allaspects_stats_array;
			const skill = source.length > 0 ? `${source}_` : '';
			let result = [];
			_.each(stats, (stat) => {
				const lowerstat = stat.toLowerCase();
				result[result.length] =
					isNaN(parseInt(setObj[`${skill}${lowerstat}state`])) ?
						parseInt(value[`${skill}${lowerstat}state`]) || 0 :
						parseInt(setObj[`${skill}${lowerstat}state`]) || 0;
			});
			clog(debug, timer, 'stats:', stats, 'getStatStateArray()]');
			clog(debug, timer, 'result =', result);
			return result;
		}
		
		function getStatValuesArray(value, type) {
			const stats = type.major == 1 ? major_stats_array: allaspects_stats_array;
			let result = [];
			_.each(stats, (stat) => {
				result[result.length] = parseInt(value[`stat_total_${stat.toLowerCase()}`]) || 0;
			});
			return result;
		}
		
		function getStateDenominator(states) {
			var result = 0;
			_.each(states, (state) => { result = result + state; });
			return result;
		}
		
		function getActivatedStatsBase(debug, timer, states, values, denominator) {
			const statsActivated = _.map(values, (v, i) => { return v * states[i]; });
			const statsSum = statsActivated.reduce((a, b) => a + b, 0);
			const result = (denominator > 0) ? Math.round(statsSum / denominator) : 0;
			clog(debug, timer, 'statsActivated =', statsActivated, 'getActivatedStatsBase()');
			clog(debug, timer, 'statsSum', statsSum);
			clog(debug, timer, 'result =', result);
			return result;
		}
		
		function clearStatStates(type, setObj) {
			//type = major or minor
			const stattype = (type.major==1) ? major_stats_array : allaspects_stats_array;
			_.each(stattype, (stat) => { setObj[`${stat.toLowerCase()}state`] = 0; });
		}
		
		function getStatRollBase(debug, timer, value, sourceAttr, setObj, type, source = '') {
			const statStates = getStatStateArray(debug, timer, value, setObj, type, source);
			const statValues = getStatValuesArray(value, type);
			const denominator = getStateDenominator(statStates);
			const base = getActivatedStatsBase(debug, timer, statStates, statValues, denominator);
			clog(debug, timer, 'base =', base, 'getStatRollBase()');
			return base;
		}
		
		function getRollString(debug, timer, category, type, title, base, rollmod=0, initiative=false){
			const turntracker = initiative ? '&{tracker}': '';
			const rollstring = `&{template:besmDefault} {{${category}=1}} {{${type}=1}} ` +
			`{{title=${title}}} {{character_name=@{charactername}}} {{pronoun=@{pronoun}}} ` +
			`{{base=${base}}} {{total=[[[[?{Roll is|Normal, ${setDice(rollmod)}` +
			`|Minor Edge, ${setDice(rollmod, 1)}|Minor Obstacle, ${setDice(rollmod, -1)}` +
			`|Major Edge, ${setDice(rollmod, 2)}|Major Obstacle, ${setDice(rollmod, -2)}}]]` +
			`+[[${base}]] ${turntracker}]]}} {{roll=$[[0]]}}`;
			clog(debug, timer, 'rollstring =', rollstring, 'getRollString()');
			return rollstring;
		}
		
		function setSkillRoll(debug, timer, value, source, rowID, sourceAttr, level, setObj, type) {
			const base = getStatRollBase(debug, timer, value, sourceAttr, setObj, type, source);
			const roll = getRollString(debug, timer, 'rolls', 'skillroll', 'Skill Roll', base + level);
			setObj[`repeating_skill_${rowID}_skillrollvalue`] = roll;
		}
		
		function setStatRoll(debug, timer, value, sourceAttr, setObj, type) {
			const base = getStatRollBase(debug, timer, value, sourceAttr, setObj, type);
			const roll = getRollString(debug, timer, 'rolls', 'statroll', 'Stat Roll', base);
			const clearstatselections = setObj.static_stat_type_set != undefined ? 
				clearStatStates(getStatType(value), setObj) :
				false;
			setObj.dynamic_roll_base = base;
			setObj.dynamic_roll_value = roll;
			clog(debug, timer, 'roll =', roll, 'setStatRoll()');
		}
		
		function updateCache(debug, timer, eventInfo, value) {
			clog(debug, timer, 'eventInfo.sourceAttribute =', eventInfo.sourceAttribute, 'updateCache()');
			const result = eventInfo.newValue !== undefined ? 
				value[eventInfo.sourceAttribute] = eventInfo.newValue :
				isNaN(eventInfo.previousValue) ? 
					value[eventInfo.sourceAttribute] = "" :
					value[eventInfo.sourceAttribute] = 0;
			clog(debug, timer, 'result =', result);
			clog(debug, timer, `value[${eventInfo.sourceAttribute}] =`, value[eventInfo.sourceAttribute]);
		}
		
		function updateSkillRolls(debug, timer, value, skillIDs, sourceAttr, setObj) {
			const type = getStatType(value);
			_.each(skillIDs, id => {
				const source = `repeating_skill_${id}`;
				const level = parseInt(value[`${source}_level`]) || 0;
				setSkillRoll(debug, timer, value, source, id, sourceAttr, level, setObj, type);
			})
		}
		
		function recordSheetChanges(timer, eventInfo, value, setObj) {
			const sheet_change_array = ['show_debug_messages','weapon_ammo_reloads','weapon_ammo_capacity','theme'];
			const recordChange = sheet_change_array.indexOf(eventInfo.sourceAttribute) !== -1 ?
				true : false;
			if (recordChange) {
				setObj[`${eventInfo.sourceAttribute}`] = eventInfo.newValue;
				clog(3, timer, 'setObj:', setObj, 'Changes To Sheet Values');
				value = {...value, ...setObj};
				setObj.sheetdb = JSON.stringify(value);
				setAttrs(setObj,{silent:true});
			}
			return recordChange;
		}
		
		function buildStatButtonStatesArray() {
			/*
			let result = [];
			const majorAndMinorArray = allaspects_stats_array.concat(major_stats_array);
			_.each(majorAndMinorArray, (stat) => {
				result[result.length] = `${stat.toLowerCase()}state`;
			});
			*/
			const result = _.map(allaspects_stats_array.concat(major_stats_array), stat => {
					return `${stat.toLowerCase()}state`;
				});
			return result;
		}
		
		function buildUnaffectedButtonStatesArray() {
			const result = _.map(unaffected_attrs_array, m => {
				return `${m}state`;
			});
			return result;
		}
		
		function setSkillStatButtonState(debug, timer, value, match, sourceAttr, setObj) {
			const skillStatButtonState = button => 
				allaspects_stats_array.indexOf(button) !== -1 ||
				major_stats_array.indexOf(button) !== -1 ?
					(parseInt(value[`${match}state`]) || 0) > 0 ?
						setObj[`${match}state`] = 0 : 
						setObj[`${match}state`] = 1 : 
				false;
			if (skillStatButtonState(sourceAttr) === false) return;
			clog(debug, timer, 'state =', setObj[`${match}state`], 'setSkillStatButtonState()');
		}
		
		function setStatButtonStatsAndRolls(debug, timer, eventInfo, value, rowID, sourceAttr, setObj) {
			const source = sourceAttr == "unaffected" ?//rowID == 'stat' || rowID == 'type' ? sourceAttr : 
				`repeating_attr_${rowID}_${removeWhiteSpace(eventInfo.htmlAttributes.value)}` :
				sourceAttr;
			const setButtonState = button => button == 'stat' || button == 'type' || 
				button.length == 20 ?
				(parseInt(value[`${source}state`]) || 0) > 0 ?
					setObj[`${source}state`] = 0 :
					setObj[`${source}state`] = 1 :
				false;
			if (setButtonState(rowID) === false) return;
			clog(debug, timer, 'setButtonState =', setObj[`${source}state`], 'setStatButtonStatsAndRolls()');
			const type = getStatType(value);
			const isMajorAspectStat = button => allaspects_stats_array.indexOf(button) >= 0 ?
				setStatRoll(debug, timer, value, sourceAttr, setObj, type) : 
				major_stats_array.indexOf(button) >= 0 ?
					setStatRoll(debug, timer, value, sourceAttr, setObj, type) : 
					false;
			isMajorAspectStat(sourceAttr);
		}
		
		function setSkillCostBySpecilizationChange(debug, timer, skillIDs, eventInfo, value, sectionName, rowID, setObj){
			const specilizations = value[`repeating_skill_${rowID}_specializations`];
			const specilizationscost = specilizations === "" ? 0 :
				(specilizations.match(/,/g) || []).length;
			const skillname = value[`repeating_skill_${rowID}_name`];
			const skillcost = getSkillCost(debug, timer, value, skillname);
			const skillrank = parseInt(value[`repeating_skill_${rowID}_level`]) || 0;
			const totalcost = (skillcost * skillrank) + specilizationscost;
			const groupid = getGroupID(value, 'skill');
			const spent = getAggregateSkillGroupCost(debug, timer, skillIDs, value, rowID, groupid, setObj);
			setObj[`static_skillgroup_${groupid}_spent`] = spent + totalcost;
			setObj[`repeating_skill_${rowID}_totalcost`] = totalcost;
		}
		
		function setSkillGroupCost(value, sectionName, cost, setObj){
			const groupID = getGroupID(value, sectionName);
			const groupcost = parseInt(value[`static_skillgroup_${groupID}_groupcost`]) || 0;
			setObj[`static_skillgroup_${groupID}_groupcost`] = groupcost + cost;
		}
		/*
		function createSkill(debug, timer, value, skillmap, rowID, setObj){
			const json = JSON.parse(global_templates_skills_json);
			const skills = json.template;
			const skillmatch = 
				_.find(skillmap, s => {
					if (s[rowID] !== undefined) return true;
				});
			const skill = 
				_.find(skills, s => {
					if (s.name === skillmatch[rowID]) return true;
				});
			const group = getGroupID(value, 'skill');
			const name = skill.name;
			const game_genre = parseInt(value.static_options_selection_gamegenre) || 0;
			const cost = skill.cost[game_genre];
			const specializations = skill.specializations;
			const statallaspect = skill.statallaspect;
			const statmajor = skill.statmajor;
			const statarray = statallaspect.concat(statmajor);
			const skillID = generateRowID();
			const type = getStatType(value);
			_.each(statarray,stat=>{
				writeValues(debug, timer, value, `repeating_skill_${skillID}_${stat}state`, 1 , setObj);
			});
			const stats = type.major==1 ? statmajor: statallaspect;
			const sum = _.chain(stats)
				.map(stat=>{
					return parseInt(value[`stat_total_${stat}`]) || 0;
				})
				.reduce((memo,stat)=>{
					return memo + stat;
				})
				.value();
			const base = Math.round(sum / stats.length);
			const roll = `&{template:besmDefault} {{rolls=1}} {{skillroll=1}} {{title=Skill Roll}} {{character_name=@{charactername}}} {{pronoun=@{pronoun}}} {{skill=${name}}} {{level=0}} {{base=${base}}} {{total=[[ [[?{Roll is|Normal, 2d6|Minor Edge, 3d6kh2|Minor Obstacle, 3d6kl2|Major Edge, 4d6kh2|Major Obstacle, 4d6kl2}]] + [[${base}]] ]]}} {{roll=$[[0]]}}`;
			const skill_attributes = ['group','name','skillspecilizations','majorstats','minorstats','stat','skillrollvalue'];
			const skill_attributes_values = [group, name, specializations, type.major, type.minor, getSkillStatsDisplay(stats), roll];
			_.each(skill_attributes, (a,i) => {
				writeValues(debug, timer, value, `repeating_skill_${skillID}_${a}`, skill_attributes_values[i], setObj);
			});
			value.skillIDs = value.skillIDs.push(skillID.toLowerCase());
			setObj.skillmanagement = 0;
		}
		*/
		function setSkill(debug, timer, eventInfo, value, rowID, setObj) {
			const json = JSON.parse(global_templates_skills_json);    
			const skills = json.template;
			const temp = {};
			clog(debug, timer, '', temp, 'setSkill()');
			temp.level = parseInt(value[`repeating_skill_${rowID}_level`]) || 0;
			if (temp.level !== 0) {
				writeValues(debug, timer, value, `repeating_skill_${rowID}_name`, eventInfo.previousValue, setObj);
				return;
			}
			if (eventInfo.newValue === undefined) {   
				temp.clear_skill_attributes = ['skillspecilizations','majorstats','minorstats','stat','skillrollvalue'];
				_.each(temp.clear_skill_attributes, (a,i) => {
					writeValues(debug, timer, value, `repeating_skill_${rowID}_${a}`, '', setObj);
				});
				return;
			}
			temp.name = capital(eventInfo.newValue);
			temp.group = getGroupID(value, 'skill');
			temp.skill = 
				_.find(skills, s => {
					if (s.name === temp.name) return true;
				});
			temp.game_genre = parseInt(value.static_options_selection_gamegenre) || 0;
			temp.cost = temp.skill.cost[temp.game_genre];
			temp.statarray = temp.skill.statallaspect.concat(temp.skill.statmajor);
			temp.type = getStatType(value);
			_.each(temp.statarray,stat=>{
				writeValues(debug, timer, value, `repeating_skill_${rowID}_${stat}state`, 1 , setObj);
			});
			temp.disabledStats = _.chain(all_stats_array)
				.map(s => {
					if(temp.statarray.indexOf(s) === -1) return s;
				})
				.compact().value();
			_.each(temp.disabledStats, s => {
				writeValues(debug, timer, value, `repeating_skill_${rowID}_${s}state`, 0 , setObj);
			});
			temp.stats = temp.type.major==1 ? temp.skill.statmajor: temp.skill.statallaspect;
			temp.sum = _.chain(temp.stats)
				.map(stat=>{
					return parseInt(value[`stat_total_${stat}`]) || 0;
				})
				.reduce((memo,stat)=>{
					return memo + stat;
				})
				.value();
			temp.base = Math.round(temp.sum / temp.stats.length);
			temp.roll = `&{template:besmDefault} {{rolls=1}} {{skillroll=1}} ` +
				`{{title=Skill Roll}} {{character_name=@{charactername}}} ` +
				`{{pronoun=@{pronoun}}} {{skill=${temp.name}}} {{level=0}} ` +
				`{{base=${temp.base}}} {{total=[[ [[?{Roll is|Normal, 2d6|` +
				`Minor Edge, 3d6kh2|Minor Obstacle, 3d6kl2|Major Edge, 4d6kh2|` +
				`Major Obstacle, 4d6kl2}]] + [[${temp.base}]] ]]}} {{roll=$[[0]]}}`;
			temp.skill_attributes = ['group','skillspecilizations','majorstats','minorstats','stat','skillrollvalue'];
			temp.skill_attributes_values = [temp.group, temp.skill.specializations, temp.type.major, temp.type.minor, getSkillStatsDisplay(temp.stats), temp.roll];
			_.each(temp.skill_attributes, (a,i) => {
				writeValues(debug, timer, value, `repeating_skill_${rowID}_${a}`, temp.skill_attributes_values[i], setObj);
			});
			value.skillIDs = value.skillIDs.push(rowID);
			setObj.skillmanagement = 0;
		}
		
		function buildSkillTemplateValuesArray(skilltemplateIDs){
			if (skilltemplateIDs !== undefined) {
				const result = _.chain(skilltemplateIDs)
					.map(rowID => {
						return [
							`repeating_skilltemplate_${rowID}_label`, 
							`repeating_skilltemplate_${rowID}_cost`, 
							`repeating_skilltemplate_${rowID}_specializations`, 
							`repeating_skilltemplate_${rowID}_statallaspect`, 
							`repeating_skilltemplate_${rowID}_statmajor`
						];
					})
					.flatten()
					.value();
				
				return result;
			} else {
				return [];
			}
		}
		
		function createAttrdbJSON(setObj) {
			const attrdb = {};
			const attributes = _.map(all_attributes_array, attr => { 
				return removeWhiteSpace(attr); 
			});
			_.each(attributes, (attribute) => {
				attrdb[`${attribute}`] = [];
			});
			setObj.attrdb = JSON.stringify(attrdb);
		}
		
		function persistCache(value, attrdb, attrIDs, skillIDs, extraarmIDs, skillmap) {
			//value.attrdb = attrdb;
			value.attrIDs = attrIDs;
			value.skillIDs = skillIDs;
			value.extraarmIDs = extraarmIDs;
			value.skillmap = skillmap;
		}
		
		function registerRemoved(){
			const eventsToRegister = [
				'repeating_attr',
				'repeating_skill',
				'repeating_defect'
			];
			const eventString = eventsToRegister.join(" remove:");
			return eventString;
		}
		
		function registerEvents() {
			const eventsToRegister = [
				"theme",
				"static_template_size_selection",
				"static_rules_deplete_alt",
				"weapon_ammo_reloads",
				"weapon_ammo_capacity",
				"static_options_selection_gamegenre",
				"show_debug_messages",
				"static_weapon_autofire_selection",
				"static_weapon_range_selection",
				"static_weapon_maneuver_name",
				"static_stat_type_set",
				"static_roll_type_selection",
				"static_stat_temp_health",
				"static_stat_temp_energy",
				"static_stat_total_wounds",
				"static_stat_total_fatigue",
				"static_stat_total_maddness",
				"static_stat_total_shame",
				"repeating_attr",
				"repeating_skill",
				//"repeating_sizetemplate",
				"static_stat_base_body",
				"static_stat_base_mind",
				"static_stat_base_soul",
				"mainhand_state",
				"offhand_state",
				"static_attrgroup_selected_tab",
				"static_skillgroup_selected_tab",
				"static_attrgroup_1_groupmax",
				"static_attrgroup_2_groupmax",
				"static_attrgroup_3_groupmax",
				"static_attrgroup_4_groupmax",
				"static_attrgroup_5_groupmax",
				"static_attrgroup_6_groupmax",
				"static_attrgroup_7_groupmax",
				"static_attrgroup_8_groupmax",
				"static_attrgroup_9_groupmax",
				"static_attrgroup_10_groupmax"
			],
				eventString = eventsToRegister.join(" change:");
			return eventString;
		};
		
		function getStatButtons() {
			let result = _.chain([allaspects_stats_array, major_stats_array, conditions_array])
					.flatten()
					.map((stat) => { return `static_button_stat_${stat.toLowerCase()}` })
					.value();
			return result;
		}
		
		function getSkillStatButtons() {
			let result = _.chain([allaspects_stats_array, major_stats_array])
					.flatten()
					.map((stat) => { return `${stat.toLowerCase()}` })
					.value();
			return result;
		}
		
		function registerActions() {
			const statButtons = getStatButtons().concat(getSkillStatButtons()),
				buttonsToRegister = [
					"repeating_attr:setlock",
					"repeating_attr:activate",
					"repeating_attr:options",
					"repeating_attr:unaffected",
					"repeating_skilltemplate:addskill",
					"repeating_extraarm:armedstate",
					"repeating_skill",
					"static_button_ammo_reload",
					"static_button_targeted_rushdamage",
					"static_button_targeted_damage",
					"static_button_targeted_attack",
					"static_button_targeted_defense",
					"static_button_movement_defense",
					"static_button_personal_defense",
					"static_button_mainhand_armedstate",
					"static_button_offhand_armedstate"
				].concat(statButtons),
				buttonString = `clicked:${buttonsToRegister.join(" clicked:")}`;
			return buttonString;
		}
		
		const events = `change:${registerEvents()} clicked:${registerActions()} remove:${registerRemoved()}`;
		const buttons = [
			"attrgroup1",
			"attrgroup2",
			"attrgroup3",
			"attrgroup4",
			"attrgroup5",
			"attrgroup6",
			"attrgroup7",
			"attrgroup8",
			"attrgroup9",
			"attrgroup10",
			"skillgroup1",
			"skillgroup2",
			"skillgroup3",
			"skillgroup4",
			"skillgroup5",
		];
		
		const sizeTemplateVariables = _.map(size_template_keys_array, key => {
			return `static_template_size_${key}`;
		});
		
		on("sheet:opened", () => {
		
			const timer = {
				start:Date.now(),
				elapsed:0,
				cache:0
			};
			clog(3, timer, '', '', 'Sheet Open', 'start');
			clog(3, timer, 'Collect all rowIDs', '', 'getSectionIDs()');
			getSectionIDs('attr', attrIDs => {
				clog(3, timer, `Fetched attribute IDs (${attrIDs.length} total)`, '');
			getSectionIDs('skill', skillIDs => {
				clog(3, timer, `Fetched skill IDs (${skillIDs.length} total)`, '');
			getSectionIDs('extraarm', extraarmIDs => {
				clog(3, timer, `Fetched extra arm IDs (${extraarmIDs.length} total)`, '');
			getSectionIDs('skilltemplate', skilltempIDs => {
				clog(3, timer, `Fetched skill template IDs (${skilltempIDs.length} total)`, '');
			getSectionIDs('sizetemplate', sizetemplateIDs => {
				clog(3, timer, `Fetched size template IDs (${sizetemplateIDs.length} total)`, '');
				const skilltemp_names_array = _.map(skilltempIDs, id => {
					return `repeating_skilltemplate_${id}_label`;
				});
				let getAttrsString = [];
		
				getAttrsString = getAttrsString.concat(buildReapeatingAttrValuesArray(attrIDs));
				getAttrsString = getAttrsString.concat(buildReapeatingSkillValuesArray(skillIDs));
				getAttrsString = getAttrsString.concat(skilltemp_names_array);
				//getAttrsString = getAttrsString.concat(buildSizeTemplateValuesArray(rowID));
				getAttrsString = getAttrsString.concat(combat_stats_array);
				getAttrsString = getAttrsString.concat(buildConditionStateArray());
				getAttrsString = getAttrsString.concat(buildAttrGroupValuesArray());
				getAttrsString = getAttrsString.concat(buildSkillGroupValuesArray());
				getAttrsString = getAttrsString.concat(buildProtectionValuesArray());
				getAttrsString = getAttrsString.concat(buildRepeatingExtraArmValuesArray(extraarmIDs));
				getAttrsString = getAttrsString.concat(stats_array);
				getAttrsString = getAttrsString.concat(rolls_array);
				getAttrsString = getAttrsString.concat(sizeTemplateVariables);
				getAttrsString = getAttrsString.concat([
					'show_debug_messages',
					'theme', 
					'static_weapon_maneuver_name', 
					'active_weapon', 
					'static_attrgroup_selected_tab', 
					'static_skillgroup_selected_tab',
					'version',
					'global_version',
					'static_options_selection_gamegenre',
					'previous_weapon',
					'static_rules_deplete_alt'
				]);
				getAttrsString = getAttrsString.concat(size_template_values_array);
				getAttrsString = getAttrsString.concat(buildStatButtonStatesArray());
				const getValues = getAttrsString.concat(on_sheet_open_array);
				clog(3, timer, `Ready to read all attributes (${getValues.length} total)`, '', 'getAttrs()');
				getAttrs(getValues, (value) => {
					clog(3, timer, 'All attribute values received:', value);
					const setObj = {};
					const sheetdb = {};
					sheetdb.attrIDs = attrIDs;
					sheetdb.skillIDs = skillIDs;
					sheetdb.extraarmIDs = extraarmIDs;
		
					_.each(getAttrsString, o => {
						//if(value[o] !== undefined) sheetdb[o] = value[o];
						if(!isFalsey(value[o])) sheetdb[o] = value[o];
					});
					clog(3, timer, 'value:', value);
		
					if (value.global_initialized != 1) {
						//buildSizeUI(global_templates_size_names, setObj);
						//setDefaultSize(sheetdb, setObj);
						buildSkillsUI(value, setObj, sheetdb);
						writeHiddenDamageAttributes(sheetdb);
						createAttrdbJSON(setObj);
						setObj.global_initialized = 1;
						setObj.stat_total_body = '0';
						setObj.stat_total_mind = '0';
						setObj.stat_total_soul = '0';
						doUpgrade(value, sheetdb, attrIDs, setObj.attrdb, sizetemplateIDs, setObj);
					}else{
						const attrdb = JSON.parse(value.attrdb);
						const skillmap = _.chain(skilltempIDs)
						.map( id => {
								return { [id]: value[`repeating_skilltemplate_${id}_label`] };
							})
							.compact()
							.value();
						sheetdb.skillmap = skillmap;
						doUpgrade(value, sheetdb, attrIDs, attrdb, sizetemplateIDs, setObj);
					}
					setObj.sheetdb = JSON.stringify(sheetdb);
					clog(3, timer, 'Ready to write setObj to cache:', setObj, 'setAttrs()');
					setAttrs(setObj,{silent:true});
					clog(3, timer, 'Write complete', '');
				});
			});
			});
			});
			});
			});
		});
		
		on("clicked:attrgroup1 clicked:attrgroup2 clicked:attrgroup3 clicked:attrgroup4 clicked:attrgroup5 clicked:attrgroup6 clicked:attrgroup7 clicked:attrgroup8 clicked:attrgroup9 clicked:attrgroup10 clicked:skillgroup1 clicked:skillgroup2 clicked:skillgroup3 clicked:skillgroup4 clicked:skillgroup5", (eventInfo) => {
			const button = eventInfo.triggerName.substring(8, eventInfo.triggerName.length);
			const section = button.replace(/[0-9]/g, "");
			const setObj = {};
			setObj[`static_${section}_selected_tab`] = button;
			setAttrs(setObj);
			return;
		});
		
		on(events, (eventInfo) => {
			
			const timer = {
				start:Date.now(),
				elapsed:0,
				cache:0
			};
			clog(3, timer, '', '', 'Sheet Worker Begin', 'start');
		
			const setObj = {};
			const get_attrs_array = [
				'show_debug_messages',
				'attrdb',
				'sheetdb'
			];
		
			getAttrs(get_attrs_array, (v) => {
				let value = JSON.parse(v.sheetdb);
				if (recordSheetChanges(timer, eventInfo, value, setObj)) return;
				const debug = parseInt(value[`show_debug_messages`]) || 0;
				const attrdb = JSON.parse(v.attrdb);
				let attrIDs = value.attrIDs;
				let skillIDs = value.skillIDs;
				let extraarmIDs = value.extraarmIDs;
				const skillmap = value.skillmap;
				const isRemoved = eventInfo.triggerName.indexOf('remove') !== -1 ? true : false;
				!isRemoved ? updateCache(debug, timer, eventInfo, value) : false;
		
				const removedInfo = isRemoved ? eventInfo.removedInfo : {};
				eventInfo.sourceAttribute = isRemoved ? `${eventInfo.sourceAttribute}_removed` : 
					eventInfo.sourceAttribute;
				
				if(eventInfo.sourceAttribute === undefined){
					eventInfo.sourceAttribute = eventInfo.triggerName.substring(8, eventInfo.triggerName.length);
				}
		
				if(eventInfo.triggerName.indexOf('repeating_skill_') !== -1 && eventInfo.htmlAttributes !== undefined){
					const button = eventInfo.htmlAttributes.name.substring(3,eventInfo.htmlAttributes.name.length);
					eventInfo.sourceAttribute = `${eventInfo.sourceAttribute}${button}`;
				}
		
				setPreviousValue(eventInfo);
				
				clog(debug, timer, 'eventInfo:', eventInfo, 'Event Listener', 'info');
				clog(debug, timer, 'value:', value, 'getAttrs()', 'info');
		
				eventInfo.sourceAttribute.replace(/^((.+?)_(.+?)_(.+?))_(.+)/, (match, source, sourceType, sectionName, rowID, sourceAttr) => {
		
					const originalCaseRowID = rowID;
					source = source.toLowerCase();
					match = match.toLowerCase();
					rowID = rowID.toLowerCase();
		
					const steering =
						`match = ${match}\n` +
						`source = ${source}\n` +
						`sourceType = ${sourceType}\n` +
						`sectionName = ${sectionName}\n` +
						`rowID = ${rowID}\n` +
						`sourceAttr = ${sourceAttr}`;
					clog(debug, timer, steering, '', 'sourceAttribute Breakout', 'info');
		
					//---> Main Script <---//
					if(isRemoved){
						if(getWasActive(removedInfo, originalCaseRowID)){
							restoreActiveAttribute(removedInfo);
						}else{
							switch(sectionName){
								case 'attr':
									cleanupCosts(debug, timer, attrIDs, attrdb, value, sectionName, rowID, setObj);
									cleanupGroupType(debug, timer, removedInfo, attrIDs, attrdb, value, rowID, setObj);
								break;
								case 'skill':
									cleanupSkillCosts(debug, timer, skillIDs, value, rowID, setObj);
								break;
							}
							cleanupSheetdb(debug, timer, removedInfo, value);
							cleanupAttrIDs(attrIDs, rowID);
							persistCache(value, attrdb, attrIDs, skillIDs, extraarmIDs, skillmap);
							clog(debug, timer, 'setObj:', setObj, 'Changes To Sheet Values', 'info');
							value = {...value, ...setObj};
							setObj.sheetdb = JSON.stringify(value);
							setAttrs(setObj,{silent:true});
							clog(debug, timer, 'Changes written to sheet', '', 'setAttrs()', 'info');
						}
						return;
					} else if (sourceType==`repeating`) {
		
						const isCustomization = getIsCustomization(debug, timer, sourceAttr);
						const customizationType = isCustomization ? 
							getCustomizationType(debug, timer, sourceAttr) : undefined;
						const customization = isCustomization ?
							{
								name:`${getCustomizationName(debug, timer, sourceAttr, customizationType)}`, 
								type:`${customizationType}`
							} :
							undefined;
						sourceAttr = isCustomization ? 'customization' : sourceAttr;
		
						switch (sectionName) {
							case `attr`:
								//const isNew = parseInt(value[`${source}_new`]) === 0 ? false : true;
								const group = parseInt(value[`${source}_group`]) || 0;
								const isNew = group !== 0 ? false : true;
								clog(debug, timer, `isNew =`, isNew, 'Attribute is new?');
								if(isNew) {
									setGroupMembership(debug, timer, value, setObj, source, sectionName);
									attrIDs.indexOf(rowID) === -1 ? attrIDs.push(rowID) : false;
									setDepleteRules(debug, timer, value, rowID, setObj);
								}
								if(getIsSheetworker(eventInfo.sourceType)) return;
								switch (sourceAttr) {
									case `attribute`:
										if (resetOnLocked(debug, timer, eventInfo, value, match, rowID, setObj)) return;
										if (resetOnLevelNotZero(debug, timer, eventInfo, value, match, rowID, setObj)) return;
										if (resetOnAlreadyDynamicGroup(debug, timer, eventInfo, value, sectionName, match, source, rowID, setObj)) return;
										setGroupType(debug, timer, attrIDs, attrdb, eventInfo, value, sectionName, rowID, setObj);
										exposeAttrSettingsOnAttributeChange(debug, timer, value, match, source, setObj);
										//setAttrCostPerLevel(debug, timer, value, rowID, setObj);
										setAttrStat(debug, timer, value, rowID, setObj, 'major');
										setAttrDuration(debug, timer, value, rowID, setObj);
										setAttrRange(debug, timer, value, rowID, setObj);
										setAttrArea(debug, timer, value, rowID, setObj);
										setAttrCustomizations(debug, timer, value, rowID, setObj);
										setDamageType(debug, timer, source, sourceAttr, setObj);
									break;
									case `level`:
										if (resetOnNoAttr(debug, timer, timer, eventInfo, value, match, rowID, setObj)) return;
										setLevelElevation(eventInfo, source, `levelelevation`, setObj);
										//setAttrCostByLevelChange(debug, timer, attrdb, eventInfo, value, attrIDs, sectionName, rowID, sourceAttr, setObj);
										setAttrCost(debug, timer, value, rowID, setObj);
										setAttrGroupCost(debug, timer, attrIDs, attrdb, value, rowID, sourceAttr, setObj);
										setEffectiveLevelByLevelChange(debug, timer, eventInfo, value, sectionName, rowID, sourceAttr, setObj);
										setAttrCharacteristic(debug, timer, value, rowID, setObj);
									break;
									case `activate`:
										if (!getIsLocked(debug, timer, value, rowID, sourceAttr)) return;
										if (getFluxGroupIsNotActive(debug, timer, value, rowID)) return;
										const isActive = setButtonState(debug, timer, value, source, rowID, sourceAttr, setObj);
										setAttrEffects(debug, timer, isActive, value, attrdb, extraarmIDs, attrIDs, skillIDs, sectionName, rowID, sourceAttr, setObj);
										const handsource = getHandSource(debug, timer, extraarmIDs, value[`repeating_attr_${rowID}_source`]);
										const handstate = handsource !== false ? parseInt(value[`${handsource}_state`]) || 0 : false;
										clog(debug, timer, 'handstate =', handstate, 'TEST');
										
										//setPoolCostIfGroupIsFlux(debug, timer, attrIDs, value, rowID, setObj);
										setAttrGroupPoolSpentByActivation(debug, timer, isActive, attrIDs, value, rowID, setObj);
										//setPoolCostIfGroupIsVariation(debug, timer, isActive, attrIDs, value, rowID, setObj);
										disableActiveWeapon(debug, timer, value, rowID, setObj);
										if (handstate) {
											setWeaponAmmo(debug, timer, attrdb, value, handsource, setObj);
		
											//const handsource = getHandSource(debug, timer, extraarmIDs, rowID);
											//setWeaponStates(debug, timer, extraarmIDs, value, rowID, setObj);
											//setActiveWeapon(debug, timer, value, handsource, setObj);
											//setActiveWeaponUI(debug, timer, attrdb, value, setObj);
											//setWeaponAmmo(debug, timer, attrdb, value, handsource, setObj);
											//setCombatRoll(debug, timer, value, attrdb, value[`${handsource}_source`], sourceAttr, setObj);
										}
										setGroupDefectPointsOnActivation(debug, timer, attrIDs, attrdb, value, sectionName, rowID, setObj);
										setDepleteResurvation(debug, timer, attrdb, value, rowID, setObj);
										setTotalLift(debug, timer, attrdb, value, setObj);
									break;
									case `lock`:
										if (resetOnActive(debug, timer, eventInfo, value, match, rowID, setObj)) return;
										const state = eventInfo.newValue === "1" ? 0 : 1;
										writeValues(debug, timer, value, `${source}_options`, state, setObj);
									break;
									case 'defect':
										resetRank(value, rowID, setObj);
										exposeDefectSettingsOnDefectChange(debug, timer, value, rowID, setObj);
										setDefectPointsByRankChange(debug, timer, eventInfo, value, rowID, setObj);
									break;
									case 'rank':
										setDefectPointsByRankChange(debug, timer, eventInfo, value, rowID, setObj);
									break;
									case 'customization':
										exposeAttrSettingsOnCustomizationChange(debug, timer, eventInfo, source, customization, setObj);
										setCustomization(debug, timer, eventInfo, value, rowID, customization, setObj);
										setEffectiveLevelByCustomization(debug, timer, value, rowID, setObj);
										setAttrCharacteristic(debug, timer, value, rowID, setObj);
										setAvailableDamageTypes(debug, timer, value, rowID, setObj);
										setUnaffectedWeapons(debug, timer, eventInfo, value, rowID, customization, setObj);
										setAltmunitionCost(debug, timer, customization, attrIDs, attrdb, value, rowID, sourceAttr, setObj);
										/*
										customization.name === 'altmunition' ? 
											setAttrCost(debug, timer, value, rowID, setObj) :
											false;
										*/
									break;
									case 'unaffected':
										setStatButtonStatsAndRolls(debug, timer, eventInfo, value, rowID, sourceAttr, setObj);
										setUnaffectedAttributes(debug, timer, eventInfo, value, rowID, setObj);
									break;
									case 'enemy':
									case 'immunityrole':
									case 'weaponclass':
										setAttrCharacteristic(debug, timer, value, rowID, setObj);
									break;
									default:
										const isDefect = value[`${source}_attribute`] == 'defect' ?
											true : false;
										const isUniqueAttribute = value[`${source}_attribute`] == 'unique attribute' ?
											true : false;
										if (isDefect) {
											setDefectCharacteristic(debug, timer,attrdb, value, rowID, setObj);
										}
										if (isUniqueAttribute) {
											setAttrCost(debug, timer, value, rowID, setObj);
										}
										setStatButtonStatsAndRolls(debug, timer, eventInfo, value, rowID, sourceAttr, setObj);
								}
							break;
							case `skill`:
								if (getIsSheetworker(eventInfo.sourceType)) return;
								const level = parseInt(value[`${source}_level`]) || 0;
								const type = getStatType(value);
								switch (sourceAttr) {
									case `level`:
										setLevelElevation(eventInfo, source, `levelelevation`, setObj);
										setSkillCostByRankChange(debug, timer, skillIDs, value, rowID, setObj);
										setSkillRoll(debug, timer, value, source, rowID, sourceAttr, level, setObj, type);
									break;
									case 'name':
										setSkill(debug, timer, eventInfo, value, rowID, setObj);
									break;
									case 'specializations':
										setSkillCostBySpecilizationChange(debug, timer, skillIDs, eventInfo, value, sectionName, rowID, setObj);
									break;
									case 'statselection':
									case 'option':
										const state = (parseInt(value[`${source}_${sourceAttr}`]) || 0) > 0 ? 0 : 1;
										writeValues(debug, timer, value, `${source}_${sourceAttr}`, state, setObj);
									break;
									default:
										setSkillStatButtonState(debug, timer, value, match, sourceAttr, setObj);
										setSkillStatDisplay(debug, timer, value, rowID, sourceAttr, setObj, type);
										setSkillRoll(debug, timer, value, source, rowID, sourceAttr, level, setObj, type);
								}
							break;
							case `extraarm`:
								switch (sourceAttr) {
									case `armedstate`:
										const handsource = getHandSource(debug, timer, extraarmIDs, rowID);
										setWeaponStates(debug, timer, extraarmIDs, value, handsource, setObj);
										setActiveWeapon(debug, timer, value, handsource, setObj);
										setActiveWeaponUI(debug, timer, attrdb, value, setObj);
										setWeaponAmmo(debug, timer, attrdb, value, handsource, setObj);
										setCombatRoll(debug, timer, value, attrdb, value[`${source}_source`], sourceAttr, setObj);
									break;
								}
							break;
							case `skilltemplate`:
								switch(sourceAttr){
									case `addskill`:
										createSkill(debug, timer, value, skillmap, rowID, setObj);
									break;
								}
							break;
							/*
							case `sizetemplate`:
								if (eventInfo.newValue == "0" || 
									getIsSheetworker(eventInfo.sourceType)) {
										return;
								}
								setSizeTemplate(value, sizetempateIDs, rowID, setObj);
							break;
							*/
						}
						persistCache(value, attrdb, attrIDs, skillIDs, extraarmIDs, skillmap);
						clog(debug, timer, 'setObj:', setObj, 'Changes To Sheet Values', 'info');
						value = {...value, ...setObj};
						setObj.sheetdb = JSON.stringify(value);
						setAttrs(setObj,{silent:true});
						clog(debug, timer, 'Changes written to sheet', '', 'setAttrs()', 'info');
						return;
					} else if (sourceType==`static`) {
						switch (sectionName) {
							case `weapon`:
								switch (rowID) {
									case `autofire`:
									case `maneuver`:
									case `range`:
										setCombatRoll(debug, timer, value, attrdb, value.active_weapon, sourceAttr, setObj);
									break;
								}
							break;
							case `stat`:
								switch (rowID) {
									case `type`:
										const type = getStatType(value);
										setStatType(type, setObj);
										switchStatRollType(type, setObj);
										setSkillStatType(debug, timer, value, skillIDs, sourceAttr, type, setObj);
									break;
									case `temp`:
										switch (sourceAttr) {
											case `health`:
											case `energy`:
												setDerivedValue(debug, timer, attrdb, value, setObj, sourceAttr);
											break;
										}
										setDamageLevelByTempChange(debug, timer, value, setObj, sourceAttr);
									break;
									case `total`:
										setDamageLevelByDamageTaken(debug, timer, value, setObj, sourceAttr);
									break;
									case `base`:
										if (getIsSheetworker(eventInfo.sourceType)) return;
										const stat = sourceAttr.replace('static_stat_base_', '');
										setAllAspectStats(debug, timer, eventInfo, attrdb, value, setObj, stat);
										setDerivedValue(debug, timer, attrdb, value, setObj, 'health');
										setDerivedValue(debug, timer, attrdb, value, setObj, 'energy');
										setDerivedValue(debug, timer, attrdb, value, setObj, 'sanity');
										setDerivedValue(debug, timer, attrdb, value, setObj, 'social');
										setTotalShock(debug, timer, value, attrdb, setObj);
										setTotalMovement(debug, timer, value, attrdb, setObj);
										updateSkillRolls(debug, timer, value, skillIDs, sourceAttr, setObj);
										setTotalLift(debug, timer, attrdb, value, setObj);
									break;
								}
							break;
							case `skillgroup`:
								if (rowID==`selected`) {
									setAttrVisibilityByGroup(value, eventInfo, skillIDs, setObj, sectionName);
								}
								switch (sourceAttr) {
									case `grouplevel`:
										setPoolCost(debug, timer, eventInfo, value, setObj, source, sourceAttr);
									break;
								}
							break;
							case `attrgroup`:
								if (rowID==`selected`) {
									setAttrVisibilityByGroup(value, eventInfo, attrIDs, setObj, sectionName);
								}
							break;
							case `button`:
								if (rowID == 'targeted') {
									setButtonState(debug, timer, value, source, rowID, sourceAttr, setObj);
									if (sourceAttr === "attack" || sourceAttr === 'defense') {
										const rolltype = selection => 
											selection == 'acv' || selection == 'dcv' ?
											setDynamicRollValue(debug, timer, eventInfo, value, attrdb, rowID, sourceAttr, setObj) :
											false;
										rolltype(value.static_roll_type_selection);
									}
									setCombatRoll(debug, timer, value, attrdb, undefined, sourceAttr, setObj, true);
								}
								if (rowID == 'personal' || rowID == 'movement') {
									setButtonState(debug, timer, value, source, rowID, sourceAttr, setObj);
									setDynamicRollValue(debug, timer, eventInfo, value, attrdb, rowID, sourceAttr, setObj);
								}
								if (rowID == 'ammo') {
									setWeaponReload(debug, timer, attrdb, value, setObj);
								}
								setStatButtonStatsAndRolls(debug, timer, eventInfo, value, rowID, sourceAttr, setObj);
								switch (`${sourceAttr}`) {
									case `armedstate`:
										const handsource = getHandSource(debug, timer, extraarmIDs, rowID);
										setWeaponStates(debug, timer, extraarmIDs, value, rowID, setObj);
										setActiveWeapon(debug, timer, value, handsource, setObj);
										setActiveWeaponUI(debug, timer, attrdb, value, setObj);
										setWeaponAmmo(debug, timer, attrdb, value, rowID, setObj);
										setCombatRoll(debug, timer, value, attrdb, value[`${rowID}_source`], sourceAttr, setObj);
									break;
								}
							break;
							case `roll`:
								setRollUI(debug, timer, value, setObj);
								setDynamicRollValue(debug, timer, eventInfo, value, attrdb, rowID, sourceAttr, setObj);
							break;
							case 'options':
								adjustSkillGenreCosts(debug, timer, value, skillIDs, setObj);
							break;
							case 'rules':
								setDepleteRules(debug, timer, value, attrIDs, setObj);
							break;
							case 'template':
								setSizeTemplate(debug, timer, eventInfo, value, setObj);
								setTotalLift(debug, timer, attrdb, value, setObj);
							break;
						}
						persistCache(value, attrdb, attrIDs, skillIDs, extraarmIDs, skillmap);
						clog(debug, timer, 'setObj:', setObj, 'Changes To Sheet Values', 'info');
						value = {...value, ...setObj};
						setObj.sheetdb = JSON.stringify(value);
						setAttrs(setObj,{silent:true});
						clog(debug, timer, 'Changes written to sheet', '', 'setAttrs()', 'info');
						return;
					} else {
						clog(debug, timer, 'no matching sourceType, exiting', '', 'End of Script', 'info');
						return;
					}
				});
			});
		});
	</script>

</div>
